<!DOCTYPE html>
<html lang="en" data-theme="cyan" data-bg="mint">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ValQMS</title>
  <meta name="description" content="Validation tools and QMS Procedures/Applications.">
  <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
  <link rel="icon" href="valqms-logo.svg" sizes="any">
  <link rel="apple-touch-icon" sizes="180x180" href="favicon.jpg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    .premium-ribbon {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
      background: linear-gradient(135deg, #f59e0b, #fbbf24);
      color: #fff;
      font-weight: 700;
      font-size: 13px;
      padding: 4px 18px 4px 12px;
      border-bottom-right-radius: 12px;
      border-top-left-radius: 8px;
      box-shadow: 0 2px 8px 0 rgba(245,158,11,0.08);
      letter-spacing: 0.5px;
      display: flex;
      align-items: center;
      min-width: 70px;
    }
    .premium-ribbon span {
      display: block;
      line-height: 1.2;
    }
    .premium-badge {
      background: linear-gradient(135deg, #f59e0b, #fbbf24);
      color: #fff;
      font-weight: 700;
      border-radius: 8px;
      padding: 4px 14px;
      font-size: 13px;
      display: inline-block;
      margin-bottom: 8px;
      margin-top: 6px;
      letter-spacing: 0.5px;
      box-shadow: 0 2px 8px 0 rgba(245,158,11,0.08);
    }

    /* Role-based feature visibility */
.admin-only,
.manager-only,
.reviewer-only,
.auditor-only {
  display: none;
}

/* Role indicator pulse animation */
@keyframes rolePulse {
  0%, 100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.8;
    transform: scale(1.1);
  }
}

[data-role-indicator] {
  animation: rolePulse 2s ease-in-out infinite;
}




    *{margin:0;padding:0;box-sizing:border-box}
    
    /* Theme Colors */
    [data-theme="green"]{--accent:#10b981;--accent-bright:#34d399;--accent-dim:rgba(16,185,129,0.15);--accent-glow:rgba(16,185,129,0.4)}
    [data-theme="cyan"]{--accent:#06b6d4;--accent-bright:#22d3ee;--accent-dim:rgba(6,182,212,0.15);--accent-glow:rgba(6,182,212,0.4)}
    [data-theme="purple"]{--accent:#8b5cf6;--accent-bright:#a78bfa;--accent-dim:rgba(139,92,246,0.15);--accent-glow:rgba(139,92,246,0.4)}
    [data-theme="orange"]{--accent:#f97316;--accent-bright:#fb923c;--accent-dim:rgba(249,115,22,0.15);--accent-glow:rgba(249,115,22,0.4)}
    [data-theme="blue"]{--accent:#3b82f6;--accent-bright:#60a5fa;--accent-dim:rgba(59,130,246,0.15);--accent-glow:rgba(59,130,246,0.4)}
    [data-theme="red"]{--accent:#ef4444;--accent-bright:#f87171;--accent-dim:rgba(239,68,68,0.15);--accent-glow:rgba(239,68,68,0.4)}
    [data-theme="pink"]{--accent:#ec4899;--accent-bright:#f472b6;--accent-dim:rgba(236,72,153,0.15);--accent-glow:rgba(236,72,153,0.4)}
    [data-theme="teal"]{--accent:#14b8a6;--accent-bright:#2dd4bf;--accent-dim:rgba(20,184,166,0.15);--accent-glow:rgba(20,184,166,0.4)}
    [data-theme="indigo"]{--accent:#6366f1;--accent-bright:#818cf8;--accent-dim:rgba(99,102,241,0.15);--accent-glow:rgba(99,102,241,0.4)}
    [data-theme="yellow"]{--accent:#eab308;--accent-bright:#facc15;--accent-dim:rgba(234,179,8,0.15);--accent-glow:rgba(234,179,8,0.4)}
    [data-theme="magenta"]{--accent:#d946ef;--accent-bright:#e879f9;--accent-dim:rgba(217,70,239,0.15);--accent-glow:rgba(217,70,239,0.4)}
    [data-theme="emerald"]{--accent:#059669;--accent-bright:#10b981;--accent-dim:rgba(5,150,105,0.15);--accent-glow:rgba(5,150,105,0.4)}
    [data-theme="amber"]{--accent:#d97706;--accent-bright:#f59e0b;--accent-dim:rgba(217,119,6,0.15);--accent-glow:rgba(217,119,6,0.4)}
    [data-theme="lime"]{--accent:#84cc16;--accent-bright:#a3e635;--accent-dim:rgba(132,204,22,0.15);--accent-glow:rgba(132,204,22,0.4)}
    [data-theme="violet"]{--accent:#7c3aed;--accent-bright:#a78bfa;--accent-dim:rgba(124,58,237,0.15);--accent-glow:rgba(124,58,237,0.4)}

    :root{
      /* Light theme - matching GxP Validation dashboard */
      --font-sans: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      --text: #0f172a;              /* Dark navy blue for text */
      --text-dim: #475569;          /* Medium navy for secondary text */
      --text-lighter: #64748b;      /* Lighter navy for subtle text */
      --surface: #fafafa;           /* Slightly warmer white */
      --surface-hover: #f4f4f5;     
      --border: #e4e4e7;            /* Much softer border */
      --border-light: #f4f4f5;      /* Ultra-light border */
      --glass: #ffffff;
      /* Header ribbon color (from header-glass background) */
      --header-ribbon:#0f172a;           /* dark navy header */
      --header-ribbon-bright:#1a2742;    /* slightly lighter for gradient */
      
      /* Shadow system */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.02), 0 0 0 0.75px rgba(0, 0, 0, 0.03);
      --shadow-md: 0 3px 6px -1.5px rgba(0, 0, 0, 0.01), 0 6px 12px -3px rgba(0, 0, 0, 0.02), 0 32px 56px -12px rgba(0, 0, 0, 0.02), 0 0 0 0.75px rgba(0, 0, 0, 0.04);
      --shadow-hover: 0 3px 6px -1.5px rgba(0, 0, 0, 0.01), 0 6px 12px -3px rgba(0, 0, 0, 0.02), 0 32px 56px -12px rgba(0, 0, 0, 0.06), 0 0 0 0.75px rgba(0, 0, 0, 0.04);
    }

    /* ANIMATED BACKGROUNDS */
    [data-bg="mesh"] body{background:#0f172a;position:relative}
    [data-bg="mesh"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 50%, rgba(16,185,129,0.15) 0%, transparent 50%),radial-gradient(circle at 80% 80%, rgba(99,102,241,0.15) 0%, transparent 50%),radial-gradient(circle at 40% 80%, rgba(236,72,153,0.1) 0%, transparent 50%);animation:meshMove 15s ease-in-out infinite alternate;z-index:-1}

    [data-bg="gradient"] body{background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);position:relative}
    [data-bg="gradient"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg, transparent 0%, rgba(0,0,0,0.3) 100%);z-index:-1}

    [data-bg="dots"] body{background:#0a0e27;position:relative}
    [data-bg="dots"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background-image:radial-gradient(circle, rgba(255,255,255,0.05) 1px, transparent 1px);background-size:30px 30px;z-index:-1}

    [data-bg="waves"] body{background:#0f172a;position:relative}
    [data-bg="waves"] body::before{content:'';position:fixed;bottom:0;left:0;width:100%;height:400px;background:linear-gradient(180deg, transparent 0%, rgba(16,185,129,0.1) 100%);animation:waveMove 8s ease-in-out infinite;z-index:-1}

    [data-bg="dark"] body{background:#0a0e1a;position:relative}
    [data-bg="dark"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at center, rgba(59,130,246,0.05) 0%, transparent 70%);z-index:-1}

    [data-bg="blobs"] body {background: #0f172a;position: relative;}
    [data-bg="blobs"] body::before {content: '';position: fixed;top: -100px;left: -100px;width: 140%;height: 140%;background:radial-gradient(circle at 20% 30%, rgba(255, 0, 128, 0.25), transparent 40%),radial-gradient(circle at 70% 70%, rgba(0, 128, 255, 0.2), transparent 40%),radial-gradient(circle at 50% 50%, rgba(0, 255, 128, 0.15), transparent 30%);filter: blur(100px);animation: blobMove 20s infinite ease-in-out alternate;z-index: -1}

    [data-bg="mesh2"] body {background: #0f172a;position: relative;}
    [data-bg="mesh2"] body::before {content: '';position: fixed;top: 0;left: 0;width: 100%;height: 100%;background:radial-gradient(circle at 15% 60%, rgba(255, 0, 128, 0.12), transparent 50%),radial-gradient(circle at 85% 40%, rgba(0, 128, 255, 0.12), transparent 50%),radial-gradient(circle at 50% 90%, rgba(0, 255, 128, 0.1), transparent 50%);animation: mesh2Move 25s ease-in-out infinite alternate;z-index: -1}

    [data-bg="aurora"] body{background:#f0f9ff;position:relative}
    [data-bg="aurora"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 50%, rgba(59,130,246,0.3) 0%, transparent 50%),radial-gradient(circle at 80% 80%, rgba(236,72,153,0.25) 0%, transparent 50%),radial-gradient(circle at 40% 20%, rgba(168,85,247,0.2) 0%, transparent 50%);animation:meshMove 15s ease-in-out infinite alternate;z-index:-1}

    [data-bg="sunset"] body{background:linear-gradient(135deg, #fff5f5 0%, #ffe4e6 50%, #fef3c7 100%);position:relative}
    [data-bg="sunset"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 70% 30%, rgba(251,113,133,0.2) 0%, transparent 60%);z-index:-1}

    [data-bg="ocean"] body{background:linear-gradient(135deg, #ecfeff 0%, #e0f2fe 50%, #dbeafe 100%);position:relative}
    [data-bg="ocean"] body::before{content:'';position:fixed;bottom:0;left:0;width:100%;height:400px;background:linear-gradient(180deg, transparent 0%, rgba(14,165,233,0.15) 100%);animation:waveMove 8s ease-in-out infinite;z-index:-1}

    [data-bg="mint"] body{background:#f0fdf4;position:relative}
    [data-bg="mint"] body::before{display:none}

    [data-bg="pearl"] body{background:linear-gradient(135deg, #fefce8 0%, #fef3c7 50%, #fde68a 100%);position:relative}
    [data-bg="pearl"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 50% 50%, rgba(251,191,36,0.1) 0%, transparent 70%);z-index:-1}

    [data-bg="lavender"] body{background:linear-gradient(135deg, #faf5ff 0%, #f3e8ff 50%, #e9d5ff 100%);position:relative}
    [data-bg="lavender"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 40% 60%, rgba(168,85,247,0.15) 0%, transparent 60%);animation:meshMove 20s ease-in-out infinite alternate;z-index:-1}

    [data-bg="cosmic"] body{background:#000000;position:relative}
    [data-bg="cosmic"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 10% 20%, rgba(139,92,246,0.3) 0%, transparent 40%),radial-gradient(circle at 90% 80%, rgba(236,72,153,0.25) 0%, transparent 40%),radial-gradient(circle at 50% 50%, rgba(59,130,246,0.2) 0%, transparent 50%);animation:blobMove 25s infinite ease-in-out alternate;z-index:-1}

    [data-bg="neon"] body{background:#0a0118;position:relative}
    [data-bg="neon"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 30%, rgba(236,72,153,0.4) 0%, transparent 40%),radial-gradient(circle at 80% 70%, rgba(59,130,246,0.35) 0%, transparent 40%),radial-gradient(circle at 50% 50%, rgba(168,85,247,0.3) 0%, transparent 50%);filter:blur(60px);animation:blobMove 20s infinite ease-in-out alternate;z-index:-1}

    [data-bg="neon"] body{background:#0a0118;position:relative}
    [data-bg="neon"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 30%, rgba(236,72,153,0.4) 0%, transparent 40%),radial-gradient(circle at 80% 70%, rgba(59,130,246,0.35) 0%, transparent 40%),radial-gradient(circle at 50% 50%, rgba(168,85,247,0.3) 0%, transparent 50%);filter:blur(60px);animation:blobMove 20s infinite ease-in-out alternate;z-index:-1}

/* Light backgrounds - dark text - PASTE HERE */
    [data-bg="aurora"],
    [data-bg="sunset"],
    [data-bg="ocean"],
    [data-bg="mint"],
    [data-bg="pearl"],
    [data-bg="lavender"] {
    --text: #0f172a;
    --text-dim: #475569;
    --surface: rgba(0,0,0,0.05);
    --surface-hover: rgba(0,0,0,0.08);
    --border: rgba(0,0,0,0.1);
    --glass: rgba(0,0,0,0.03);
  }

[data-bg="aurora"] h1,
[data-bg="sunset"] h1,
[data-bg="ocean"] h1,
[data-bg="mint"] h1,
[data-bg="pearl"] h1,
[data-bg="lavender"] h1 {
  background: linear-gradient(135deg, #0f172a 0%, #475569 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

[data-bg="aurora"] h2,
[data-bg="sunset"] h2,
[data-bg="ocean"] h2,
[data-bg="mint"] h2,
[data-bg="pearl"] h2,
[data-bg="lavender"] h2 {
  background: linear-gradient(135deg, #0f172a 0%, #475569 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

[data-bg="aurora"] .header-glass,
[data-bg="sunset"] .header-glass,
[data-bg="ocean"] .header-glass,
[data-bg="mint"] .header-glass,
[data-bg="pearl"] .header-glass,
[data-bg="lavender"] .header-glass {
  background: rgba(255,255,255,0.7);
  border: 1px solid rgba(0,0,0,0.1);
}

[data-bg="aurora"] .tool-item,
[data-bg="sunset"] .tool-item,
[data-bg="ocean"] .tool-item,
[data-bg="mint"] .tool-item,
[data-bg="pearl"] .tool-item,
[data-bg="lavender"] .tool-item,
[data-bg="aurora"] .module-card,
[data-bg="sunset"] .module-card,
[data-bg="ocean"] .module-card,
[data-bg="mint"] .module-card,
[data-bg="pearl"] .module-card,
[data-bg="lavender"] .module-card,
[data-bg="aurora"] .app-card,
[data-bg="sunset"] .app-card,
[data-bg="ocean"] .app-card,
[data-bg="mint"] .app-card,
[data-bg="pearl"] .app-card,
[data-bg="lavender"] .app-card,
[data-bg="aurora"] .resource-card,
[data-bg="sunset"] .resource-card,
[data-bg="ocean"] .resource-card,
[data-bg="mint"] .resource-card,
[data-bg="pearl"] .resource-card,
[data-bg="lavender"] .resource-card {
  background: rgba(255,255,255,0.6);
  border: 1px solid rgba(0,0,0,0.1);
}

[data-bg="aurora"] footer,
[data-bg="sunset"] footer,
[data-bg="ocean"] footer,
[data-bg="mint"] footer,
[data-bg="pearl"] footer,
[data-bg="lavender"] footer {
  background: #0f172a !important;
  border-top: 1px solid rgba(255,255,255,0.08) !important;
}

/* Additional text elements for light backgrounds */
[data-bg="aurora"] .section-head p,
[data-bg="sunset"] .section-head p,
[data-bg="ocean"] .section-head p,
[data-bg="mint"] .section-head p,
[data-bg="pearl"] .section-head p,
[data-bg="lavender"] .section-head p {
  color: #475569;
}

[data-bg="aurora"] .lead,
[data-bg="sunset"] .lead,
[data-bg="ocean"] .lead,
[data-bg="mint"] .lead,
[data-bg="pearl"] .lead,
[data-bg="lavender"] .lead {
  color: #475569;
}

[data-bg="aurora"] .pill,
[data-bg="sunset"] .pill,
[data-bg="ocean"] .pill,
[data-bg="mint"] .pill,
[data-bg="pearl"] .pill,
[data-bg="lavender"] .pill {
  color: #475569;
  background: rgba(0,0,0,0.05);
  border: 1px solid rgba(0,0,0,0.1);
}

[data-bg="aurora"] .tool-content p,
[data-bg="sunset"] .tool-content p,
[data-bg="ocean"] .tool-content p,
[data-bg="mint"] .tool-content p,
[data-bg="pearl"] .tool-content p,
[data-bg="lavender"] .tool-content p,
[data-bg="aurora"] .app-card p,
[data-bg="sunset"] .app-card p,
[data-bg="ocean"] .app-card p,
[data-bg="mint"] .app-card p,
[data-bg="pearl"] .app-card p,
[data-bg="lavender"] .app-card p,
[data-bg="aurora"] .module-card p,
[data-bg="sunset"] .module-card p,
[data-bg="ocean"] .module-card p,
[data-bg="mint"] .module-card p,
[data-bg="pearl"] .module-card p,
[data-bg="lavender"] .module-card p {
  color: #64748b;
}

[data-bg="aurora"] .tool-content h3,
[data-bg="sunset"] .tool-content h3,
[data-bg="ocean"] .tool-content h3,
[data-bg="mint"] .tool-content h3,
[data-bg="pearl"] .tool-content h3,
[data-bg="lavender"] .tool-content h3,
[data-bg="aurora"] .app-card h4,
[data-bg="sunset"] .app-card h4,
[data-bg="ocean"] .app-card h4,
[data-bg="mint"] .app-card h4,
[data-bg="pearl"] .app-card h4,
[data-bg="lavender"] .app-card h4,
[data-bg="aurora"] .module-card h4,
[data-bg="sunset"] .module-card h4,
[data-bg="ocean"] .module-card h4,
[data-bg="mint"] .module-card h4,
[data-bg="pearl"] .module-card h4,
[data-bg="lavender"] .module-card h4 {
  color: #0f172a;
}

[data-bg="aurora"] nav a,
[data-bg="sunset"] nav a,
[data-bg="ocean"] nav a,
[data-bg="mint"] nav a,
[data-bg="pearl"] nav a,
[data-bg="lavender"] nav a {
  color: #475569;
}

[data-bg="aurora"] nav a:hover,
[data-bg="sunset"] nav a:hover,
[data-bg="ocean"] nav a:hover,
[data-bg="mint"] nav a:hover,
[data-bg="pearl"] nav a:hover,
[data-bg="lavender"] nav a:hover {
  color: #0f172a;
}

/* Fix h2 headings for light backgrounds */
[data-bg="aurora"] .section-head h2,
[data-bg="sunset"] .section-head h2,
[data-bg="ocean"] .section-head h2,
[data-bg="mint"] .section-head h2,
[data-bg="pearl"] .section-head h2,
[data-bg="lavender"] .section-head h2 {
  background: linear-gradient(135deg, #0f172a 0%, #475569 100%) !important;
  -webkit-background-clip: text !important;
  -webkit-text-fill-color: transparent !important;
  background-clip: text !important;
}

/* Also fix h3 and h4 if they have gradients */
[data-bg="aurora"] h3,
[data-bg="sunset"] h3,
[data-bg="ocean"] h3,
[data-bg="mint"] h3,
[data-bg="pearl"] h3,
[data-bg="lavender"] h3,
[data-bg="aurora"] h4,
[data-bg="sunset"] h4,
[data-bg="ocean"] h4,
[data-bg="mint"] h4,
[data-bg="pearl"] h4,
[data-bg="lavender"] h4 {
  color: #0f172a;
}

    @keyframes mesh2Move {0% {transform: translate(0, 0);}100% {transform: translate(-50px, 40px);}}
    @keyframes blobMove {0%{transform: translate(0, 0);}100% {transform: translate(-50px, 50px);}}
    @keyframes meshMove{0%{transform:scale(1) rotate(0deg)}100%{transform:scale(1.1) rotate(5deg)}}
    @keyframes waveMove{0%,100%{transform:translateY(0)}50%{transform:translateY(-20px)}}

    html{scroll-behavior:smooth}
    body{font-family:'Inter',system-ui,-apple-system,sans-serif;background:#f0fdf4 !important;color:var(--text);line-height:1.6;-webkit-font-smoothing:antialiased;transition:background 0.5s ease;min-height:100vh;overflow-x:hidden}
    body::before{display:none !important}
  .container{width:100%;max-width:none;margin:0;padding:0 24px}

    /* GLASSMORPHISM HEADER */
    header{position:sticky;top:12px;z-index:1000;padding:0 24px;margin-bottom:20px}
  .header-glass{background:#0f172a !important;backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%);border:1px solid rgba(255,255,255,0.08) !important;border-radius:20px;padding:0 32px;box-shadow:0 8px 32px rgba(0,0,0,0.2),inset 0 1px 0 rgba(255,255,255,0.06);color:#fff}
    header .container{display:flex;justify-content:space-between;align-items:center;height:72px;max-width:100%;padding:0}
    
  .logo{display:flex;align-items:center;gap:12px;text-decoration:none;color:#fff;font-weight:800;font-size:22px;letter-spacing:-0.7px;transition:all 0.3s}
    .logo:hover{transform:translateY(-2px)}
  .logo-mark{display:flex;align-items:center;justify-content:center;width:40px;height:40px;background:linear-gradient(135deg,var(--accent),var(--accent-bright));border-radius:12px;box-shadow:0 4px 20px var(--accent-glow);transition:all 0.3s;position:relative}
    .logo-mark::after{content:'';position:absolute;inset:-2px;background:linear-gradient(135deg,var(--accent),var(--accent-bright));border-radius:14px;z-index:-1;opacity:0;filter:blur(10px);transition:opacity 0.3s}
    .logo-mark:hover::after{opacity:0.7}
  .logo-mark .brand-initials{font-weight:900;font-size:18px;letter-spacing:-0.5px;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,0.25)}

  nav{display:flex;gap:8px;align-items:center}
  nav a{color:rgba(255,255,255,0.85);text-decoration:none;font-size:15px;font-weight:500;padding:10px 18px;border-radius:10px;transition:all 0.3s;position:relative}
  nav a:hover{color:#fff;background:rgba(255,255,255,0.08)}
  /* Force light nav text inside dark header regardless of page background */
  header .header-glass nav a { color: rgba(255,255,255,0.9) !important; }
  header .header-glass nav a:hover { color: #fff !important; background: rgba(255,255,255,0.12); }
  header .logo span { color: #fff !important; }
    nav a::after{content:'';position:absolute;bottom:0;left:50%;width:0;height:2px;background:var(--accent);transition:all 0.3s;transform:translateX(-50%)}
    nav a:hover::after{width:80%}

    /* Control Buttons Group */
    .header-controls{display:flex;gap:12px;align-items:center}
    /* Header controls: white buttons like GxP tool */
    header .bg-btn,
    header .theme-btn,
    header .mobile-menu-btn,
    header .btn-login {
      background: #ffffff !important;
      border: 1px solid #e5e7eb !important;
      color: #0f172a !important;
      box-shadow: 0 1px 2px rgba(15,23,42,0.06), 0 1px 1px rgba(15,23,42,0.03) !important;
    }
    header .user-badge {
      background: linear-gradient(135deg, #10b981, #34d399) !important;
      color: #000 !important;
      border: none !important;
      font-weight: 700;
      box-shadow: 0 2px 8px 0 rgba(16,185,129,0.08);
      transition: background 0.2s, color 0.2s;
    }
    header .user-badge:hover {
      background: linear-gradient(135deg, #059669, #10b981) !important;
      color: #fff !important;
      border: none !important;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(16,185,129,0.15) !important;
    }
    header .bg-btn:hover,
    header .theme-btn:hover,
    header .mobile-menu-btn:hover,
    header .btn-login:hover {
      background: #ffffff !important;
      border-color: var(--accent) !important;
      color: #0f172a !important;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(16,185,129,0.15) !important;
    }

    /* Brand button: make white (not green) */
    #brandBtn.bg-btn {
      background: #ffffff !important;
      border: 1px solid #e5e7eb !important;
      color: #0f172a !important;
      font-weight: 700;
      box-shadow: 0 1px 2px rgba(15,23,42,0.06), 0 1px 1px rgba(15,23,42,0.03) !important;
    }
    #brandBtn.bg-btn:hover {
      background: #ffffff !important;
      border-color: var(--accent) !important;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(16,185,129,0.15) !important;
    }
    
    /* Optional outline variant for header controls */
    header .btn-outline-light{
      background:transparent !important;
      border:1.5px solid rgba(255,255,255,0.85) !important;
      color:#ffffff !important;
      box-shadow:none !important;
    }
    header .btn-outline-light:hover{
      background:#ffffff !important;
      color:#0f172a !important;
      border-color:#ffffff !important;
      box-shadow:0 6px 24px rgba(16,185,129,0.2) !important;
      transform:translateY(-2px);
    }
    
    /* Background Selector */
    .bg-selector{position:relative}
    .bg-btn{padding:10px 18px;background:var(--surface);border:1px solid var(--border);border-radius:12px;color:var(--text-dim);font-size:14px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all 0.3s}
  .bg-btn:hover{background:var(--surface-hover);border-color:var(--border);color:var(--text)}
  .bg-dropdown{position:absolute;top:calc(100% + 12px);right:0;background:#ffffff;border:1px solid #e5e7eb;border-radius:16px;padding:12px;display:none;min-width:260px;box-shadow:0 20px 60px rgba(0,0,0,0.15);z-index:2000;color:#0f172a}
    .bg-dropdown.active{display:block}
  .bg-dropdown{position:absolute;top:calc(100% + 12px);right:0;background:#ffffff;border:1px solid #e5e7eb;border-radius:16px;padding:12px;display:none;min-width:260px;max-height:420px;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,0.15);z-index:2000;color:#0f172a}
    .bg-dropdown.active{display:block}
    .bg-dropdown::-webkit-scrollbar{width:6px}
    .bg-dropdown::-webkit-scrollbar-track{background:transparent}
    .bg-dropdown::-webkit-scrollbar-thumb{background:var(--accent);border-radius:10px}
    .bg-option{display:flex;align-items:center;gap:12px;padding:12px;border-radius:10px;cursor:pointer;transition:all 0.3s;font-size:14px;font-weight:500}
    .bg-option:hover{background:var(--surface-hover)}

  /* Brand Colors section inside brand dropdown */
  .brand-colors{padding:8px}
  .brand-colors h4{margin:0 0 8px 0;font-size:13px;font-weight:800;color:var(--text);opacity:0.9}
  .color-row{display:flex;align-items:center;justify-content:space-between;padding:8px 6px;border-radius:10px}
  .color-row + .color-row{margin-top:6px}
  .color-label{font-size:13px;color:var(--text);opacity:0.85}
  .color-input-wrap{display:flex;align-items:center;gap:8px}
  .color-chip{width:34px;height:22px;border-radius:6px;border:1px solid #e5e7eb;box-shadow:inset 0 0 0 1px rgba(0,0,0,0.02)}
  .color-input{appearance:none;-webkit-appearance:none;border:none;background:transparent;width:34px;height:22px;padding:0;cursor:pointer}
  .brand-actions{display:flex;gap:8px;margin-top:10px}
  .brand-actions .btn{padding:10px 14px;border-radius:10px;font-size:13px}
    
  /* Hide theme/background sections when in brand-only mode */
  #brandDropdown.brand-only .theme-heading,
  #brandDropdown.brand-only .theme-options,
  #brandDropdown.brand-only .bg-heading,
  #brandDropdown.brand-only .bg-options,
  #brandDropdown.brand-only .divider-theme,
  #brandDropdown.brand-only .divider-bg { display: none !important; }
    .bg-preview{width:32px;height:32px;border-radius:8px;border:2px solid rgba(255,255,255,0.2)}
    .bg-preview.mesh{background:radial-gradient(circle, #10b981 0%, #6366f1 100%)}
    .bg-preview.gradient{background:linear-gradient(135deg, #667eea 0%, #764ba2 100%)}
    .bg-preview.dots{background:#0a0e27;background-image:radial-gradient(circle, rgba(255,255,255,0.2) 1px, transparent 1px);background-size:15px 15px}
    .bg-preview.waves{background:linear-gradient(180deg, #0f172a 0%, #10b981 100%)}
    .bg-preview.dark{background:#0a0e1a}
    .bg-preview.blobs {background: radial-gradient(circle, #ff0080 0%, transparent 40%),radial-gradient(circle, #0080ff 0%, transparent 40%);background-size: 80% 80%;}
    .bg-preview.mesh2 {background: radial-gradient(circle, rgba(255,0,128,0.3) 0%, transparent 50%),radial-gradient(circle, rgba(0,255,128,0.3) 0%, transparent 50%);}
    .bg-preview.aurora{background:linear-gradient(135deg, #dbeafe 0%, #fce7f3 100%)}
    .bg-preview.sunset{background:linear-gradient(135deg, #fff5f5 0%, #fef3c7 100%)}
    .bg-preview.ocean{background:linear-gradient(135deg, #ecfeff 0%, #dbeafe 100%)}
    .bg-preview.mint{background:linear-gradient(135deg, #f0fdf4 0%, #d1fae5 100%)}
    .bg-preview.pearl{background:linear-gradient(135deg, #fefce8 0%, #fde68a 100%)}
    .bg-preview.lavender{background:linear-gradient(135deg, #faf5ff 0%, #e9d5ff 100%)}
    .bg-preview.cosmic{background:radial-gradient(circle, #8b5cf6 0%, #000 100%)}
    .bg-preview.neon{background:radial-gradient(circle, #ec4899 0%, #0a0118 100%)}

    /* Theme Selector */
    .theme-selector{position:relative}
    .theme-btn{padding:10px 18px;background:var(--surface);border:1px solid var(--border);border-radius:12px;color:var(--text-dim);font-size:14px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all 0.3s}
  .theme-btn:hover{background:var(--surface-hover);border-color:var(--border);color:var(--text)}
    .theme-dropdown{position:absolute;top:calc(100% + 12px);right:0;background:rgba(255,255,255,0.05);backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:16px;padding:12px;display:none;min-width:200px;max-height:400px;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,0.3);z-index:100}
    .theme-dropdown.active{display:block}
    .theme-dropdown::-webkit-scrollbar{width:6px}
    .theme-dropdown::-webkit-scrollbar-track{background:transparent}
    .theme-dropdown::-webkit-scrollbar-thumb{background:var(--accent);border-radius:10px}
    .theme-option{display:flex;align-items:center;gap:12px;padding:12px;border-radius:10px;cursor:pointer;transition:all 0.3s;font-size:14px;font-weight:500}
    .theme-option:hover{background:var(--surface-hover)}
    .theme-color{width:28px;height:28px;border-radius:8px;border:2px solid rgba(255,255,255,0.2);transition:all 0.3s}
    .theme-option:hover .theme-color{transform:scale(1.1)}
    .theme-color.green{background:linear-gradient(135deg,#10b981,#34d399)}
    .theme-color.cyan{background:linear-gradient(135deg,#06b6d4,#22d3ee)}
    .theme-color.purple{background:linear-gradient(135deg,#8b5cf6,#a78bfa)}
    .theme-color.orange{background:linear-gradient(135deg,#f97316,#fb923c)}
    .theme-color.blue{background:linear-gradient(135deg,#3b82f6,#60a5fa)}
    .theme-color.red{background:linear-gradient(135deg,#ef4444,#f87171)}
    .theme-color.pink{background:linear-gradient(135deg,#ec4899,#f472b6)}
    .theme-color.teal{background:linear-gradient(135deg,#14b8a6,#2dd4bf)}
    .theme-color.indigo{background:linear-gradient(135deg,#6366f1,#818cf8)}
    .theme-color.yellow{background:linear-gradient(135deg,#eab308,#facc15)}
    .theme-color.magenta{background:linear-gradient(135deg,#d946ef,#e879f9)}
    .theme-color.emerald{background:linear-gradient(135deg,#059669,#10b981)}
    .theme-color.amber{background:linear-gradient(135deg,#d97706,#f59e0b)}
    .theme-color.lime{background:linear-gradient(135deg,#84cc16,#a3e635)}
    .theme-color.violet{background:linear-gradient(135deg,#7c3aed,#a78bfa)}

    /* Login Button */
  .btn-login{padding:10px 20px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.16);border-radius:12px;color:#fff;font-size:14px;font-weight:600;text-decoration:none;transition:all 0.3s}
  .btn-login:hover{background:#ffffff;border-color:#e5e7eb;transform:translateY(-2px);box-shadow:0 4px 16px rgba(15,23,42,0.18);color:#0f172a}

    /* User Menu - UPDATED TO MATCH OTHER BUTTONS */
    .user-menu{position:relative;display:none}
    .user-badge{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:10px 18px;
      min-width:50px;
      height:40px;
      border-radius:12px;
      background:var(--surface);
      border:1px solid var(--border);
      color:var(--text);
      font-weight:700;
      font-size:14px;
      cursor:pointer;
      transition:all 0.3s;
      letter-spacing:0.5px;
    }
    .user-badge:hover{
      background:var(--surface-hover);
      border-color:var(--accent);
      color:var(--text);
      transform:translateY(-2px);
    }


    /* User Menu - FIXED */
    .user-dropdown{
      position:absolute;
      top:calc(100% + 12px);
      right:0;
      background:rgba(255,255,255,0.05);
      backdrop-filter:blur(20px);
      border:1px solid var(--border);
      border-radius:16px;
      padding:8px;
      display:none;
      min-width:160px;
      z-index:2000;
      box-shadow:0 20px 60px rgba(0,0,0,0.3);
    }

    .user-dropdown.active{
      display:block;
    }

    .user-dropdown button{
      display:block;
      width:100%;
      text-align:left;
      background:transparent;
      border:none;
      border-radius:10px;
      color:var(--text);
      padding:12px 16px;
      font-size:14px;
      font-weight:500;
      cursor:pointer;
      transition:all 0.3s;
      margin-bottom:4px;
    }

    .user-dropdown button:hover{
      background:var(--surface-hover);
    }

    .user-dropdown button:last-child{
      margin-bottom:0;
    }

    .user-dropdown button:last-child:hover{
      background:rgba(239,68,68,0.1);
      color:#f87171;
    }


    /* Mobile Menu Toggle */
    .mobile-menu-btn{display:none;background:var(--surface);border:1px solid var(--border);padding:10px;border-radius:12px;cursor:pointer;color:var(--text)}

    /* Hero Section */
    .hero{padding:140px 0 120px;text-align:center;position:relative}
    .pill{display:inline-flex;align-items:center;gap:10px;padding:8px 20px;background:var(--glass);backdrop-filter:blur(10px);border:1px solid var(--border);border-radius:999px;font-size:14px;color:var(--text-dim);margin-bottom:40px;transition:all 0.3s}
    .pill:hover{background:var(--surface-hover);border-color:var(--accent)}
    .pill-dot{width:8px;height:8px;background:var(--accent);border-radius:50%;animation:pulse 2s infinite;box-shadow:0 0 10px var(--accent-glow)}
    @keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.5;transform:scale(0.9)}}
    
    h1{font-size:clamp(52px,9vw,82px);font-weight:900;letter-spacing:-3px;line-height:1.05;margin-bottom:32px;color:#0f172a}
  .lead{font-size:21px;color:#475569;margin:0 0 48px 0;line-height:1.8;font-weight:400}
    .cta-group{display:flex;gap:20px;justify-content:center;flex-wrap:wrap}
    .cta{display:inline-flex;align-items:center;gap:12px;padding:16px 36px;background:linear-gradient(135deg,var(--accent),var(--accent-bright));color:#000;text-decoration:none;border-radius:14px;font-weight:700;font-size:16px;transition:all 0.3s;box-shadow:0 8px 24px var(--accent-glow);position:relative;overflow:hidden}
    .cta::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,var(--accent-bright),var(--accent));opacity:0;transition:opacity 0.3s}
    .cta:hover::before{opacity:1}
    .cta:hover{transform:translateY(-3px);box-shadow:0 12px 32px var(--accent-glow)}
    .cta span{position:relative;z-index:1}
    .cta-secondary{
      background:#ffffff;
      border:1px solid #e5e7eb;
      color:#0f172a;
      backdrop-filter:none;
      box-shadow:0 1px 2px rgba(15,23,42,0.06), 0 1px 1px rgba(15,23,42,0.03);
    }
    .cta-secondary::before{background:transparent}
    .cta-secondary:hover{
      border-color:var(--accent);
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(16,185,129,0.18);
    }

    /* Sections */
    section{padding:100px 0}
    .section-head{text-align:center;margin-bottom:64px}
    .section-head h2{font-size:clamp(36px,6vw,56px);font-weight:900;letter-spacing:-2px;margin-bottom:16px;color:#0f172a}
  .section-head p{font-size:19px;color:#475569;margin:0;line-height:1.8;font-weight:400}

    /* Tools List - modernized for full width */
  .tools-scroll-wrapper{max-width:none;margin:0;overflow:visible;padding-right:0;border-radius:20px}
    .tools-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(420px,1fr));gap:20px}
  .tool-item{display:flex;align-items:center;gap:20px;background:linear-gradient(180deg,#ffffff 0%,#f8fafc 100%);border:1px solid #e5e7eb;border-radius:18px;padding:22px 26px;text-decoration:none;color:inherit;transition:all 0.35s ease;position:relative;overflow:hidden}
  .tool-item::before{content:'';position:absolute;left:0;top:0;bottom:0;width:5px;background:linear-gradient(180deg,var(--header-ribbon),var(--header-ribbon-bright));transform:scaleY(0);transition:transform 0.35s ease}
  .tool-item:hover{background:linear-gradient(180deg,#ffffff 0%,#f1f5f9 100%);border-color:#dbeafe;transform:translateY(-4px);box-shadow:0 12px 40px rgba(15,23,42,0.18)}
    .tool-item:hover::before{transform:scaleY(1)}
  /* Subtle corner glow accents per card */
  .tools-list .tool-item::after{content:'';position:absolute;right:-40px;top:-40px;width:160px;height:160px;border-radius:50%;filter:blur(40px);opacity:0.0;transition:opacity 0.35s ease, transform 0.35s ease}
  .tools-list .tool-item:nth-child(1)::after{background:radial-gradient(circle, rgba(16,185,129,0.4), transparent 60%)}
  .tools-list .tool-item:nth-child(2)::after{background:radial-gradient(circle, rgba(99,102,241,0.35), transparent 60%)}
  .tools-list .tool-item:nth-child(3)::after{background:radial-gradient(circle, rgba(234,88,12,0.35), transparent 60%)}
  .tools-list .tool-item:nth-child(4)::after{background:radial-gradient(circle, rgba(59,130,246,0.35), transparent 60%)}
  .tools-list .tool-item:nth-child(5)::after{background:radial-gradient(circle, rgba(244,114,182,0.35), transparent 60%)}
  .tools-list .tool-item:nth-child(6)::after{background:radial-gradient(circle, rgba(139,92,246,0.35), transparent 60%)}
  .tools-list .tool-item:hover::after{opacity:0.8;transform:scale(1.05)}
    .tool-icon{width:56px;height:56px;background:linear-gradient(135deg,var(--accent),var(--accent-bright));border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:28px;flex-shrink:0;transition:all 0.35s ease;box-shadow:0 8px 20px var(--accent-glow)}
    .tool-item:hover .tool-icon{transform:scale(1.06) rotate(3deg)}
    .tool-content{flex:1;min-width:0}
  .tool-content h3{font-size:18px;font-weight:700;margin-bottom:6px;color:var(--text);letter-spacing:-0.4px}
  .tool-badges{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0 8px}
  .tool-badge{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;font-size:11px;font-weight:700;letter-spacing:0.2px;border:1px solid transparent;background:#f8fafc;color:#0f172a}
  .tool-badge.ai{background:rgba(16,185,129,0.15);border-color:rgba(16,185,129,0.35);color:#065f46}
  .tool-badge.new{background:rgba(59,130,246,0.12);border-color:rgba(59,130,246,0.35);color:#1e3a8a}
  .tool-badge.popular{background:rgba(234,88,12,0.12);border-color:rgba(234,88,12,0.35);color:#7c2d12}
    .tool-content p{color:var(--text-dim);font-size:14px;line-height:1.6;font-weight:300}
  .tool-arrow{font-size:28px;color:var(--header-ribbon-bright);transition:all 0.35s ease;flex-shrink:0}
    .tool-item:hover .tool-arrow{transform:translateX(10px) scale(1.1)}
    @media (max-width: 980px){.tools-list{grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}}
    @media (max-width: 640px){.tool-item{padding:18px 20px}}

    /* Smart Tools filter pills */
    .tools-filters{display:flex;justify-content:center;gap:8px;margin-bottom:20px;flex-wrap:wrap}
    .pill-btn{padding:8px 14px;border-radius:9999px;background:#ffffff;border:1px solid #e5e7eb;color:#0f172a;font-size:13px;font-weight:700;cursor:pointer;transition:all 0.25s}
    .pill-btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(16,185,129,0.15)}
    .pill-btn.active{background:var(--accent);border-color:var(--accent);color:#000}
    .tool-item.hidden{display:none}

    /* Emoji icons inside badges */
    .tool-badge.ai::before{content:"ðŸ¤–"}
    .tool-badge.new::before{content:"âœ¨"}
    .tool-badge.popular::before{content:"ðŸ”¥"}

    /* APP CARDS - Modern Application Style */
    .app-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 28px;
      margin-bottom: 60px;
    }

    .app-card {
      background: linear-gradient(145deg, #ffffff, #fafafa);
      border: 1px solid #e5e7eb;
      box-shadow: 0 1px 2px rgba(15,23,42,0.06), 0 1px 1px rgba(15,23,42,0.03);
      border-radius: 24px;
      padding: 32px 24px;
      text-align: center;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      text-decoration: none;
      color: inherit;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      overflow: hidden;
    }

    .app-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(180deg, var(--header-ribbon), var(--header-ribbon-bright));
      transform: scaleY(0);
      transform-origin: top;
      transition: transform 0.4s;
    }
    /* In list-view, use a subtle top horizontal bar instead of vertical ribbon */
    .list-view .app-card::before{
      width: 100%;
      height: 3px;
      left: 0;
      top: 0;
      background: linear-gradient(90deg, var(--header-ribbon), var(--header-ribbon-bright));
      transform: scaleX(0);
      transform-origin: left;
    }

    .app-card:hover {
      transform: translateY(-8px) scale(1.01);
      border-color: var(--accent);
      box-shadow: 0 12px 40px rgba(16,185,129,0.2), 0 4px 12px rgba(15,23,42,0.08);
    }

    .app-card:hover::before { transform: scaleY(1); }
    .list-view .app-card:hover::before { transform: scaleX(1); }

    .app-icon {
      width: 80px;
      height: 80px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      transition: all 0.4s;
    }

    .app-card:hover .app-icon {
      transform: scale(1.08) rotate(-3deg);
      box-shadow: 0 12px 32px rgba(0,0,0,0.25);
    }

    .app-icon svg {
      color: #ffffff;
    }

    .app-card h4 {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 12px;
      color: var(--text);
    }

    .app-card p {
      font-size: 14px;
      color: var(--text);
      line-height: 1.6;
      margin-bottom: 16px;
      flex: 1;
    }

    .app-badge {
      display: inline-block;
      padding: 6px 16px;
      background: linear-gradient(135deg, var(--accent), var(--accent-bright));
      color: #000;
      font-size: 11px;
      font-weight: 700;
      border-radius: 20px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: auto;
    }

    .app-badge.coming-soon {
      background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
      color: var(--text-dim);
      border: 1px solid rgba(255,255,255,0.2);
    }

    /* QMS Grid */
    .qms-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:10px}
    .module-card{background:#ffffff;border:1px solid #e5e7eb;box-shadow:0 1px 2px rgba(15,23,42,0.06);border-radius:18px;padding:32px;transition:all 0.4s;position:relative;overflow:hidden}
  .module-card::before{content:'';position:absolute;top:0;left:0;width:100%;height:5px;background:linear-gradient(90deg,var(--header-ribbon),var(--header-ribbon-bright));transform:scaleX(0);transform-origin:left;transition:transform 0.5s ease}
    .module-card:hover{transform:translateY(-6px);border-color:var(--accent);box-shadow:0 12px 32px rgba(16,185,129,0.15)}
    .module-card:hover::before{transform:scaleX(1)}
    .module-card h4{font-size:19px;font-weight:700;margin-bottom:12px;color:var(--text);letter-spacing:-0.3px}
    .module-card p{font-size:14px;color:var(--text-dim);line-height:1.7;font-weight:300}
    .qms-cta-wrapper{text-align:center;margin-top:56px}

  /* Resources Grid (modernized) */
  /* About: STAT-BAND presentation with stronger contrast */
  #about .qms-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:0;
    background:var(--glass);
    backdrop-filter:blur(14px);
    border:1px solid var(--border);
    border-radius:18px;
    padding:12px 12px; /* slimmer band */
    overflow:hidden;
    position:relative;
    box-shadow:0 12px 36px rgba(0,0,0,0.35);
  }
  #about .module-card{
    background:transparent;
    border:0;
    padding:16px 20px;
    box-shadow:none;
    transition:background 0.25s, transform 0.25s;
    position:relative;
    min-height:100%;
  }
  /* Remove top ribbon; add subtle alternating row tints */
  #about .qms-grid::before{content:none}
  #about .qms-grid::after{
    content:'';
    position:absolute;inset:0;pointer-events:none;
    background:repeating-linear-gradient(
      to bottom,
      rgba(255,255,255,0.04),
      rgba(255,255,255,0.04) 56px,
      rgba(0,0,0,0.0) 56px,
      rgba(0,0,0,0.0) 112px
    );
  }
  #about .module-card::before{content:none}
  /* Vertical separators between items */
  #about .module-card + .module-card{border-left:1px solid rgba(255,255,255,0.08)}
  #about .module-card:hover{background:rgba(255,255,255,0.04);transform:translateY(-2px)}
  #about .module-card h4{margin-bottom:4px}
  #about .module-card p{color:var(--text);opacity:0.9}
  @media (max-width: 720px){
    #about .qms-grid{grid-template-columns:1fr;gap:0}
    #about .module-card + .module-card{border-left:0;border-top:1px solid rgba(255,255,255,0.12)}
  }
  /* QMS Applications: List view overrides */
  /* Generic list-view styles (apply to any section with class 'list-view') */
  .view-toggle{display:flex;justify-content:flex-end;gap:8px;margin:8px 0 12px}
  .list-view .app-grid{grid-template-columns:1fr;gap:14px}
  .list-view .qms-grid{grid-template-columns:1fr;gap:14px}
  /* Switch to grid layout for precise alignment */
  .list-view .app-card{display:grid;grid-template-columns:72px 1fr 260px;align-items:center;gap:16px;text-align:left;padding:16px 18px}
  .list-view .app-icon{grid-column:1;grid-row:1 / span 2;width:56px;height:56px;border-radius:14px;margin:0;box-shadow:0 8px 24px rgba(0,0,0,0.25)}
  .list-view .app-card h4{grid-column:2;margin:0 0 4px}
  .list-view .app-card p{grid-column:2;margin:0;color:var(--text)}
  .list-view .app-badge{grid-column:3;justify-self:start;margin:0}
  .list-view .app-card > .price-tag{grid-column:3;justify-self:start;margin:0 0 6px}
  .list-view .app-card > div:last-child{grid-column:3;justify-self:stretch;margin:0;display:flex;flex-direction:column;gap:8px}
  /* Reveal price tag in list view even if generated with .hidden */
  .list-view .app-card .price-tag.hidden{display:inline-block !important}
  /* Premium ribbon styles */
  .premium-ribbon{position:absolute;top:10px;left:10px;background:linear-gradient(135deg,#f59e0b,#fb923c);padding:4px 8px;border-radius:999px;color:#000;font-size:11px;font-weight:700;letter-spacing:.3px;z-index:5}
  .list-view .premium-ribbon{position:static;grid-column:3;justify-self:start;margin:0 0 6px}
  /* Price tag visual */
  .price-tag{background:#ffffff;border:1px solid #e5e7eb;color:#0f172a;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:800;display:inline-block}

  /* QMS-specific ribbon orientation: Tiles = top bar, List = left ribbon */
  /* Default for QMS (tiles view): horizontal top bar */
  #qms .app-card::before{
    width:100%;
    height:3px;
    left:0;top:0;
    background: linear-gradient(90deg, var(--header-ribbon), var(--header-ribbon-bright));
    transform: scaleX(0);
    transform-origin: left;
  }
  #qms .app-card:hover::before{ transform: scaleX(1); }
  /* QMS list view: vertical left ribbon */
  #qms.list-view .app-card::before{
    width:4px;
    height:100%;
    left:0;top:0;
    background: linear-gradient(180deg, var(--header-ribbon), var(--header-ribbon-bright));
    transform: scaleY(0);
    transform-origin: top;
  }
  #qms.list-view .app-card:hover::before{ transform: scaleY(1); }

  /* Procedures: Tiles = top bar, List = left ribbon */
  section[id="QMS Procedures"] .app-card::before{
    width:100%;height:3px;left:0;top:0;
    background: linear-gradient(90deg, var(--header-ribbon), var(--header-ribbon-bright));
    transform: scaleX(0);transform-origin:left;
  }
  section[id="QMS Procedures"] .app-card:hover::before{ transform: scaleX(1); }
  section[id="QMS Procedures"].list-view .app-card::before{
    width:4px;height:100%;left:0;top:0;
    background: linear-gradient(180deg, var(--header-ribbon), var(--header-ribbon-bright));
    transform: scaleY(0);transform-origin:top;
  }
  section[id="QMS Procedures"].list-view .app-card:hover::before{ transform: scaleY(1); }

  /* Courses: Tiles = top bar, List = left ribbon */
  section[id="ValQMS Academy"] .app-card::before{
    width:100%;height:3px;left:0;top:0;
    background: linear-gradient(90deg, var(--header-ribbon), var(--header-ribbon-bright));
    transform: scaleX(0);transform-origin:left;
  }
  section[id="ValQMS Academy"] .app-card:hover::before{ transform: scaleX(1); }
  section[id="ValQMS Academy"].list-view .app-card::before{
    width:4px;height:100%;left:0;top:0;
    background: linear-gradient(180deg, var(--header-ribbon), var(--header-ribbon-bright));
    transform: scaleY(0);transform-origin:top;
  }
  section[id="ValQMS Academy"].list-view .app-card:hover::before{ transform: scaleY(1); }

  /* Validation: Tiles = top bar, List = left ribbon */
  #validation .app-card::before{
    width:100%;height:3px;left:0;top:0;
    background: linear-gradient(90deg, var(--header-ribbon), var(--header-ribbon-bright));
    transform: scaleX(0);transform-origin:left;
  }
  #validation .app-card:hover::before{ transform: scaleX(1); }
  #validation.list-view .app-card::before{
    width:4px;height:100%;left:0;top:0;
    background: linear-gradient(180deg, var(--header-ribbon), var(--header-ribbon-bright));
    transform: scaleY(0);transform-origin:top;
  }
  #validation.list-view .app-card:hover::before{ transform: scaleY(1); }

  .resources-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(360px,1fr));gap:24px}
  .resource-card{background:#ffffff;border:1px solid #e5e7eb;box-shadow:0 1px 2px rgba(15,23,42,0.06);border-radius:18px;padding:28px;transition:all 0.4s;position: relative;overflow: hidden;}
  .resource-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 5px;
  background: linear-gradient(90deg, var(--header-ribbon), var(--header-ribbon-bright));
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.5s ease;
    }
  .resource-card:hover{border-color:var(--accent);box-shadow:0 12px 32px rgba(16,185,129,0.15);transform:translateY(-4px)}
    .resource-card:hover::before {
    transform: scaleX(1);
    }
  .resource-header{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:12px}
  .resource-title{display:flex;align-items:center;gap:14px}
  .resource-icon{width:52px;height:52px;background:linear-gradient(135deg,var(--accent),var(--accent-bright));border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:26px;box-shadow:0 8px 18px var(--accent-glow);flex-shrink:0}
  .resource-card h3{font-size:20px;font-weight:800;margin:0;letter-spacing:-0.3px;color:var(--text)}
  .resource-desc{margin-top:4px;color:var(--text-dim);font-size:13px;font-weight:500}
  .link-count{background:#ffffff;border:1px solid #e5e7eb;color:#0f172a;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:800;min-width:32px;text-align:center}
  .resource-card ul{list-style:none;padding:0;margin-top:12px;font-size:14px;line-height:2.0;font-weight:300;columns:2;column-gap:24px}
  @media (max-width: 920px){.resource-card ul{columns:1}}
  .resource-card li{break-inside:avoid}
  .resource-card a{color:var(--text);text-decoration:none;font-weight:400;position:relative;display:inline-block;transition:all 0.25s}
  .resource-card a::after{content:'\2197'; /* â†— */ position:absolute;right:-16px;top:0;color:var(--accent-bright);opacity:0;transform:translateY(2px);transition:all 0.25s}
  .resource-card a:hover{color:var(--text);padding-left:2px}
  .resource-card a:hover::after{opacity:1;right:-12px}
  /* Keep icon and link on same row */
  #resources .resource-card li{display:flex;align-items:center;gap:8px}
  #resources .resource-card li a{word-break:break-word}
  /* Lightweight flag icons */
  .flag{display:inline-block;width:18px;height:12px;border-radius:2px;box-shadow:inset 0 0 0 1px rgba(0,0,0,0.12);background-size:cover;background-position:center;flex-shrink:0}
  /* Japan flag */
  .flag-jp{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' fill='%23ffffff'/><circle cx='9' cy='6' r='3.5' fill='%23bc002d'/></svg>")}
  /* India flag (no chakra for simplicity) */
  .flag-in{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' fill='%23ffffff'/><rect width='18' height='4' y='0' fill='%23ff9933'/><rect width='18' height='4' y='8' fill='%23128807'/></svg>")}
  /* EU flag (simplified) */
  .flag-eu{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' fill='%23003399'/><g fill='%23ffcc00'><circle cx='9' cy='3' r='0.6'/><circle cx='11.1' cy='3.6' r='0.6'/><circle cx='12.6' cy='5.1' r='0.6'/><circle cx='13.2' cy='7.2' r='0.6'/><circle cx='12.6' cy='9.1' r='0.6'/><circle cx='11.1' cy='10.4' r='0.6'/><circle cx='9' cy='11' r='0.6'/><circle cx='6.9' cy='10.4' r='0.6'/><circle cx='5.4' cy='9.1' r='0.6'/><circle cx='4.8' cy='7.2' r='0.6'/><circle cx='5.4' cy='5.1' r='0.6'/><circle cx='6.9' cy='3.6' r='0.6'/></g></svg>")}
  /* United States flag (simplified) */
  .flag-us{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' fill='%23b22234'/><g fill='%23ffffff'><rect y='1' width='18' height='1'/><rect y='3' width='18' height='1'/><rect y='5' width='18' height='1'/><rect y='7' width='18' height='1'/><rect y='9' width='18' height='1'/><rect y='11' width='18' height='1'/></g><rect width='7.6' height='5.6' fill='%233c3b6e'/></svg>")}
  /* United Kingdom flag (very simplified) */
  .flag-uk{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' fill='%23001285'/><rect x='7' width='4' height='12' fill='%23ffffff'/><rect y='4' width='18' height='4' fill='%23ffffff'/><rect x='7.6' width='2.8' height='12' fill='%23cf142b'/><rect y='4.6' width='18' height='2.8' fill='%23cf142b'/></svg>")}
  /* Australia flag (simplified) */
  .flag-au{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' fill='%23001285'/><circle cx='12.5' cy='6' r='1.6' fill='%23ffffff'/></svg>")}
  /* China flag (simplified) */
  .flag-cn{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' fill='%23de2910'/><circle cx='5' cy='4' r='1.3' fill='%23ffde00'/></svg>")}
  /* Canada flag (simplified) */
  .flag-ca{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' fill='%23ffffff'/><rect width='4' height='12' x='0' fill='%23d52b1e'/><rect width='4' height='12' x='14' fill='%23d52b1e'/><path d='M9 3.5 l1 1.5 h1.2 l-1 1 0.4 1.4 L9 7.6 7.4 7.4 7.8 6 6.8 5 h1.2 L9 3.5z' fill='%23d52b1e'/></svg>")}
  /* Globe icon for WHO */
  .flag-globe{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' fill='%23e5f2ff'/><circle cx='9' cy='6' r='4' fill='none' stroke='%230482c9' stroke-width='1.2'/><path d='M5 6h8M9 2c-1.5 1.5-1.5 6 0 8c1.5-2 1.5-6 0-8z' stroke='%230482c9' stroke-width='1.2' fill='none'/></svg>")}
  /* Simple brand-style icons for ISO and ICH (original, not official logos) */
  .flag-iso{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' rx='2' ry='2' fill='%230055a4'/><text x='9' y='8.5' text-anchor='middle' font-size='7' font-family='Arial, Helvetica, sans-serif' fill='%23ffffff'>ISO</text></svg>")}
  .flag-ich{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='12' viewBox='0 0 18 12'><rect width='18' height='12' rx='2' ry='2' fill='%23088da5'/><text x='9' y='8.5' text-anchor='middle' font-size='7' font-family='Arial, Helvetica, sans-serif' fill='%23ffffff'>ICH</text></svg>")}
  /* Hide filtered links */
  #resources .resource-card li.hidden{display:none !important}

  /* Small-screen refinements for resource cards */
  @media (max-width: 480px){
    .resource-icon{width:42px;height:42px;font-size:22px}
    .resource-card{padding:22px}
    .resource-header{gap:10px}
    .resource-card ul{column-gap:16px;line-height:1.9}
  }

    /* MODERN MINIMAL FOOTER (match dark header) */
    footer{margin-top:120px;border-top:1px solid rgba(255,255,255,0.08);background:#0f172a;color:#ffffff}
    .footer-content{padding:56px 0 32px}
    .footer-grid{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:48px;margin-bottom:48px}
    .footer-brand{display:flex;flex-direction:column;gap:20px}
  .footer-brand .logo{font-size:26px;font-weight:900;color:#ffffff}
  .footer-brand p{color:rgba(255,255,255,0.7);font-size:14px;line-height:1.8;font-weight:300}
    .footer-col h5{font-size:13px;font-weight:700;margin-bottom:16px;text-transform:uppercase;letter-spacing:1px;color:#ffffff}
    .footer-col ul{list-style:none}
    .footer-col li{margin-bottom:12px}
  .footer-col a{color:rgba(255,255,255,0.85);text-decoration:none;font-size:14px;transition:all 0.3s;display:inline-block;font-weight:400;position:relative}
  .footer-col a::after{content:'';position:absolute;bottom:0;left:50%;width:0;height:2px;background:var(--accent);transition:all 0.3s;transform:translateX(-50%)}
  .footer-col a:hover{color:#ffffff;transform:translateX(4px)}
  .footer-col a:hover::after{width:80%}
    .footer-bottom{padding:24px 0;border-top:1px solid rgba(255,255,255,0.12);display:flex;justify-content:space-between;align-items:center;color:rgba(255,255,255,0.7);font-size:13px}
    .footer-socials{display:flex;gap:16px}
    .footer-socials a{width:36px;height:36px;border-radius:10px;background:#ffffff;border:1px solid #e5e7eb;display:flex;align-items:center;justify-content:center;color:#0f172a;text-decoration:none;transition:all 0.3s}
    .footer-socials a:hover{background:#ffffff;color:#0f172a;border-color:var(--accent);transform:translateY(-2px);box-shadow:0 4px 12px rgba(16,185,129,0.15)}

    /* Project Management Icons */
    .pm-icon {
      width: 64px;
      height: 64px;
      margin: 0 auto 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 16px;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
    }

    .pm-icon svg {
      width: 32px;
      height: 32px;
      color: white;
    }

    .module-card:hover .pm-icon {
      transform: translateY(-8px) scale(1.05);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.25);
    }

    /* Individual PM Method Colors */
    .pm-icon.csv-waterfall {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    }

    .pm-icon.agile-sprints {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    }

    .pm-icon.qualification {
      background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
    }

    .pm-icon.v-model {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    }

    .pm-icon.hybrid {
      background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);
    }

    .pm-icon.kanban {
      background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
    }

    .pm-icon.features {
      background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    }

    /* Module Tags */
    .module-tags {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 12px;
      justify-content: center;
    }

    .module-tags .tag {
      padding: 4px 12px;
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.3);
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      color: #10b981;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Badge New */
    .badge-new {
      display: inline-flex;
      align-items: center;
      padding: 4px 12px;
      margin-left: 12px;
      background: linear-gradient(135deg, #10b981, #34d399);
      border-radius: 12px;
      font-size: 12px;
      font-weight: 700;
      color: white;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
    0%, 100% {
    opacity: 1;
    transform: scale(1);
    }
    50% {
    opacity: 0.9;
    transform: scale(1.05);
    }
  }

/* Feature Cards */
.feature-card {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
  border: 1px solid rgba(99, 102, 241, 0.2);
}

/* Quick Actions */
.pm-quick-actions {
  display: flex;
  gap: 16px;
  justify-content: center;
  margin-top: 48px;
  flex-wrap: wrap;
}

.pm-quick-actions a {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 14px 28px;
  border-radius: 12px;
  font-weight: 600;
  text-decoration: none;
  transition: all 0.3s;
}

.pm-quick-actions .btn-primary {
  background: linear-gradient(135deg, #10b981, #34d399);
  color: white;
  box-shadow: 0 4px 16px rgba(16, 185, 129, 0.4);
}

.pm-quick-actions .btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(16, 185, 129, 0.6);
}

.pm-quick-actions .btn-secondary {
  background:#ffffff;
  border:1px solid #e5e7eb;
  color:#0f172a;
  box-shadow:0 1px 2px rgba(15,23,42,0.06), 0 1px 1px rgba(15,23,42,0.03);
}

.pm-quick-actions .btn-secondary:hover {
  background:#ffffff;
  border-color:var(--accent);
  transform:translateY(-2px);
  box-shadow:0 6px 20px rgba(16,185,129,0.18);
}

.pm-quick-actions svg {
  width: 20px;
  height: 20px;
}

/* Responsive */
@media (max-width: 768px) {
  .pm-quick-actions {
    flex-direction: column;
  }
  
  .pm-quick-actions a {
    width: 100%;
    justify-content: center;
  }
  
  .badge-new {
    display: block;
    margin-left: 0;
    margin-top: 8px;
    width: fit-content;
  }
}



/* Profile Panel - MODERN REDESIGN */
#profilePanel{
  display:none;
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.6);
  z-index:2000;
  backdrop-filter:blur(12px);
  animation:fadeIn 0.3s ease;
}

@keyframes fadeIn{
  from{opacity:0}
  to{opacity:1}
}

.profile-content{
  max-width:480px;
  margin:80px auto;
  background:linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
  backdrop-filter:blur(40px);
  border:1px solid rgba(255,255,255,0.2);
  border-radius:28px;
  padding:48px 40px;
  box-shadow:0 20px 80px rgba(0,0,0,0.4);
  position:relative;
  animation:slideUp 0.4s ease;
}

@keyframes slideUp{
  from{transform:translateY(40px);opacity:0}
  to{transform:translateY(0);opacity:1}
}

.close-btn{
  position:absolute;
  top:20px;
  right:20px;
  background:rgba(255,255,255,0.1);
  border:1px solid rgba(255,255,255,0.2);
  color:var(--text);
  font-size:24px;
  cursor:pointer;
  width:40px;
  height:40px;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:12px;
  transition:all 0.3s;
}

.close-btn:hover{
  background:rgba(255,68,68,0.2);
  border-color:#ef4444;
  color:#ef4444;
  transform:rotate(90deg);
}

.profile-header{
  display:flex;
  flex-direction:column;
  align-items:center;
  margin-bottom:32px;
}

.profile-avatar{
  width:80px;
  height:80px;
  background:linear-gradient(135deg,var(--accent),var(--accent-bright));
  border-radius:20px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:36px;
  font-weight:800;
  color:#000;
  margin-bottom:16px;
  box-shadow:0 8px 32px var(--accent-glow);
}

.profile-content h2{
  font-size:32px;
  font-weight:900;
  margin-bottom:12px;
  color:var(--text);
  letter-spacing:-1px;
  text-align:center;
}

#profileMsg{
  min-height:24px;
  color:var(--text-dim);
  margin-bottom:32px;
  font-size:14px;
  padding:8px 16px;
  background:rgba(255,255,255,0.05);
  border-radius:10px;
  text-align:center;
}

.profile-content>div:not(.profile-header):not(.btn-group){
  margin-bottom:24px;
}

.profile-content label{
  display:block;
  font-size:12px;
  color:var(--text-dim);
  margin-bottom:8px;
  font-weight:600;
  text-transform:uppercase;
  letter-spacing:1px;
}

.profile-content input{
  width:100%;
  padding:14px 18px;
  border:1px solid rgba(255,255,255,0.2);
  border-radius:14px;
  background:rgba(255,255,255,0.08);
  color:#ffffff !important;
  font-size:15px;
  transition:all 0.3s;
  font-weight:500;
}

.profile-content input:focus{
  outline:none;
  border-color:var(--accent);
  background:rgba(255,255,255,0.12);
  box-shadow:0 0 0 4px var(--accent-dim), 0 4px 20px var(--accent-glow);
  transform:translateY(-2px);
}

.profile-content input:disabled{
  opacity:0.5;
  cursor:not-allowed;
  background:rgba(255,255,255,0.03);
}

.btn-group{
  display:flex;
  gap:16px;
  margin-top:32px;
}

.btn{
  flex:1;
  padding:14px 28px;
  border:none;
  border-radius:14px;
  font-size:15px;
  font-weight:700;
  cursor:pointer;
  transition:all 0.3s;
  letter-spacing:0.3px;
}

.btn-primary{
  background:linear-gradient(135deg,var(--accent),var(--accent-bright));
  color:#000;
  box-shadow:0 6px 24px var(--accent-glow);
}

.btn-primary:hover{
  transform:translateY(-3px);
  box-shadow:0 10px 32px var(--accent-glow);
}

.btn-primary:active{
  transform:translateY(-1px);
}

.btn-secondary{
  background:rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.2);
  color:var(--text);
}

.btn-secondary:hover{
  background:rgba(255,255,255,0.15);
  transform:translateY(-2px);
}

/* === Profile Panel: match white-card + brand accents === */
#profilePanel .profile-content{
  background:#ffffff !important;
  border:1px solid #e5e7eb !important;
  box-shadow:0 24px 64px rgba(15,23,42,0.18) !important;
  backdrop-filter:none !important;
}

#profilePanel .close-btn{
  background:#ffffff !important;
  border:1px solid #e5e7eb !important;
  color:#0f172a !important;
}
#profilePanel .close-btn:hover{
  background:#ffffff !important;
  border-color:var(--accent) !important;
  color:var(--accent) !important;
}

#profilePanel .profile-content h2{ color:#0f172a !important; }

#profilePanel #profileMsg{
  background:#f8fafc !important;
  border:1px solid #e5e7eb !important;
  color:#475569 !important;
}

#profilePanel label{ color:#475569 !important; }

#profilePanel input{
  background:#ffffff !important;
  border:1px solid #e5e7eb !important;
  color:#0f172a !important;
}
#profilePanel input:focus{
  border-color:var(--accent) !important;
  background:#ffffff !important;
  box-shadow:0 0 0 3px var(--accent-dim), 0 4px 20px rgba(16,185,129,0.12) !important;
}

#profilePanel .btn-secondary{
  background:#ffffff !important;
  border:1px solid #e5e7eb !important;
  color:#0f172a !important;
  box-shadow:0 1px 2px rgba(15,23,42,0.06), 0 1px 1px rgba(15,23,42,0.03) !important;
}
#profilePanel .btn-secondary:hover{
  border-color:var(--accent) !important;
  transform:translateY(-2px);
  box-shadow:0 6px 20px rgba(16,185,129,0.18) !important;
}

#profilePanel .btn-primary{
  background:linear-gradient(135deg, var(--accent), var(--accent-bright)) !important;
  color:#000 !important;
  box-shadow:0 6px 24px var(--accent-glow) !important;
}
#profilePanel .btn-primary:hover{
  transform:translateY(-2px);
  box-shadow:0 10px 32px var(--accent-glow) !important;
}

@media(max-width:968px){
  header{top:8px;padding:0 16px}
  .header-glass{padding:0 20px;border-radius:16px}
  .mobile-menu-btn{display:block}
  nav{display:none}
  .hero{padding:80px 0 60px}
  h1{font-size:42px}
  .footer-grid{grid-template-columns:1fr;gap:32px}
  .profile-content{padding:32px 24px;margin:40px 16px}
}

    @media(max-width:968px){
      header{top:8px;padding:0 16px}
      .header-glass{padding:0 20px;border-radius:16px}
      .mobile-menu-btn{display:block}
      nav{display:none}
      .hero{padding:80px 0 60px}
      h1{font-size:42px}
      .footer-grid{grid-template-columns:1fr;gap:32px}
    }

/* Course Payment Styles */
.my-courses h3 {
  font-size: 1.5rem;
  margin-bottom: 1rem;
  color: var(--text);
}

.purchased-badge {
  display: inline-block;
  margin: 0.5rem 0.5rem 0 0;
  padding: 0.625rem 1rem;
  background: linear-gradient(135deg, var(--accent), var(--accent-bright));
  color: #000;
  border-radius: 10px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s;
}

.purchased-badge:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px var(--accent-glow);
}

/* Payment Success Modal */
.payment-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(8px);
  z-index: 3000;
  align-items: center;
  justify-content: center;
}

.payment-modal.active {
  display: flex;
}

.modal-box {
  background: var(--glass);
  backdrop-filter: blur(40px);
  border: 1px solid var(--border);
  border-radius: 24px;
  padding: 3rem;
  max-width: 500px;
  text-align: center;
  animation: modalSlide 0.3s ease;
}

@keyframes modalSlide {
  from {
    transform: translateY(-30px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.success-icon {
  width: 72px;
  height: 72px;
  background: linear-gradient(135deg, var(--accent), var(--accent-bright));
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 1.5rem;
  font-size: 2.5rem;
  color: #000;
  font-weight: 800;
}

.modal-box h2 {
  margin-bottom: 1rem;
  font-size: 1.875rem;
}

.modal-box p {
  color: var(--text-dim);
  margin-bottom: 2rem;
  font-size: 1rem;
}

.price-tag {
  font-size: 2rem;
  font-weight: 800;
  background: linear-gradient(135deg, var(--accent), var(--accent-bright));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin: 1rem 0;
}

.price-tag.hidden { display: none; }

  </style>

  <link rel="stylesheet" href="assets/theme.css">
</head>

<body>
  <!-- GLASSMORPHISM HEADER -->
  <header>
    <div class="header-glass">
      <div class="container">
        <a href="index.html" class="logo">
          <div class="logo-mark"><span class="brand-initials">VQ</span></div>
          <span>ValQMS</span>
        </a>
        
    <nav id="mainNav">
      <a href="#validation">GxP Validation & Project Managmement</a>
      <a href="#tools">Smart Tools</a>
      <a href="#qms">QMS Applications</a>
      <a href="#QMS Procedures">QMS Procedures</a>
      <a href="#ValQMS Academy">ValQMS Academy</a>
      <a href="#resources">Resources</a>
      <a href="admin-users.html" class="admin-only" style="display: none;">
        Manage Users
      </a>
      <a href="demo-requests.html" id="demoRequestsNav" class="admin-only" style="display:none;">
        Demo Requests
      </a>
      <a href="#about">About</a>
    </nav>

        <div class="header-controls">
          <!-- Brand Selector (combined Theme + Background) -->
          <div class="brand-selector">
            <button class="bg-btn" id="brandBtn"><span>ðŸŽ¨</span><span>Brand</span></button>
            <div class="bg-dropdown brand-only" id="brandDropdown">
              <div class="theme-heading" style="font-size:12px; font-weight:700; opacity:0.9; padding:8px 8px 4px;">Theme</div>
              <div class="theme-options" style="padding: 4px 0 8px;">
                <div class="theme-option" data-theme="green"><div class="theme-color green"></div><span>Green</span></div>
                <div class="theme-option" data-theme="cyan"><div class="theme-color cyan"></div><span>Cyan</span></div>
                <div class="theme-option" data-theme="purple"><div class="theme-color purple"></div><span>Purple</span></div>
                <div class="theme-option" data-theme="orange"><div class="theme-color orange"></div><span>Orange</span></div>
                <div class="theme-option" data-theme="blue"><div class="theme-color blue"></div><span>Blue</span></div>
                <div class="theme-option" data-theme="red"><div class="theme-color red"></div><span>Red</span></div>
                <div class="theme-option" data-theme="pink"><div class="theme-color pink"></div><span>Pink</span></div>
                <div class="theme-option" data-theme="teal"><div class="theme-color teal"></div><span>Teal</span></div>
                <div class="theme-option" data-theme="indigo"><div class="theme-color indigo"></div><span>Indigo</span></div>
                <div class="theme-option" data-theme="yellow"><div class="theme-color yellow"></div><span>Yellow</span></div>
                <div class="theme-option" data-theme="magenta"><div class="theme-color magenta"></div><span>Magenta</span></div>
                <div class="theme-option" data-theme="emerald"><div class="theme-color emerald"></div><span>Emerald</span></div>
                <div class="theme-option" data-theme="amber"><div class="theme-color amber"></div><span>Amber</span></div>
                <div class="theme-option" data-theme="lime"><div class="theme-color lime"></div><span>Lime</span></div>
                <div class="theme-option" data-theme="violet"><div class="theme-color violet"></div><span>Violet</span></div>
              </div>
              <div class="divider-theme" style="height:1px; background: var(--border); margin: 6px 0 8px;"></div>
              <div class="bg-heading" style="font-size:12px; font-weight:700; opacity:0.9; padding:8px 8px 4px;">Background</div>
              <div class="bg-options">
                <div class="bg-option" data-bg="mesh"><div class="bg-preview mesh"></div><span>Mesh Gradient</span></div>
                <div class="bg-option" data-bg="gradient"><div class="bg-preview gradient"></div><span>Purple Gradient</span></div>
                <div class="bg-option" data-bg="dots"><div class="bg-preview dots"></div><span>Dot Pattern</span></div>
                <div class="bg-option" data-bg="waves"><div class="bg-preview waves"></div><span>Wave Motion</span></div>
                <div class="bg-option" data-bg="dark"><div class="bg-preview dark"></div><span>Dark Mode</span></div>
                <div class="bg-option" data-bg="blobs"><div class="bg-preview blobs"></div><span>Blob Motion</span></div>
                <div class="bg-option" data-bg="mesh2"><div class="bg-preview mesh2"></div><span>Mesh 2</span></div>
                <div class="bg-option" data-bg="aurora"><div class="bg-preview aurora"></div><span>Aurora Light</span></div>
                <div class="bg-option" data-bg="sunset"><div class="bg-preview sunset"></div><span>Sunset Glow</span></div>
                <div class="bg-option" data-bg="ocean"><div class="bg-preview ocean"></div><span>Ocean Breeze</span></div>
                <div class="bg-option" data-bg="mint"><div class="bg-preview mint"></div><span>Mint Fresh</span></div>
                <div class="bg-option" data-bg="pearl"><div class="bg-preview pearl"></div><span>Pearl Gold</span></div>
                <div class="bg-option" data-bg="lavender"><div class="bg-preview lavender"></div><span>Lavender Dream</span></div>
                <div class="bg-option" data-bg="cosmic"><div class="bg-preview cosmic"></div><span>Cosmic Dark</span></div>
                <div class="bg-option" data-bg="neon"><div class="bg-preview neon"></div><span>Neon Nights</span></div>
              </div>

              <div class="divider-bg" style="height:1px; background: var(--border); margin: 8px 0 10px;"></div>
              <div class="brand-colors">
                <h4>Brand Colors</h4>
                <div class="color-row">
                  <div class="color-label">Primary (accent)</div>
                  <div class="color-input-wrap">
                    <div class="color-chip" id="accentChip"></div>
                    <input type="color" id="accentColorInput" class="color-input" aria-label="Primary accent color" />
                  </div>
                </div>
                <div class="color-row">
                  <div class="color-label">Accent bright</div>
                  <div class="color-input-wrap">
                    <div class="color-chip" id="accentBrightChip"></div>
                    <input type="color" id="accentBrightInput" class="color-input" aria-label="Accent bright color" />
                  </div>
                </div>
                <div class="brand-actions">
                  <button id="brandApplyBtn" class="btn btn-primary" type="button">Apply</button>
                  <button id="brandResetBtn" class="btn btn-secondary" type="button">Reset</button>
                </div>
              </div>
            </div>
          </div>

          <a class="btn-login" href="login.html" id="loginLink">Login</a>

    <!-- User Menu -->
    <div id="userMenu" class="user-menu">
      <div id="userBadge" class="user-badge">U</div>
      <div id="userDropdown" class="user-dropdown">
        <button id="profileBtn">ðŸ‘¤ My Profile</button>
        <button id="logoutBtn">ðŸšª Logout</button>
      </div>
    </div>

          <!-- Mobile Menu Button -->
          <button class="mobile-menu-btn" id="mobileMenuBtn">â˜°</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- Hero -->
    <section class="hero">
      <div class="container">
        <div class="pill"><span class="pill-dot"></span><span>Empowering Life Sciences organizations with browser native Advanced tools</span></div>
        <h1>Simplify Validation.<br>Strengthen Quality.<br>Accelerate Compliance.</h1>
        <p class="lead">ValQMS empowers Life Sciences organizations with various tools which aid in validation, automation, and regulatory compliance.</p>
        <div class="cta-group">
          <a href="javascript:void(0)" onclick="openDemoModal()" class="cta"><span>ðŸ“… Book a Demo</span></a>
          <a href="#validation" class="cta cta-secondary"><span>Explore Platform</span></a>
        </div>
      </div>
    </section>

<!-- GxP Validation & Project Management -->

<section id="validation">
  <div class="container">
    <div class="section-head">
      <h2>GxP Validation & Project Management</h2>
      <p>Manage validation and compliance projects with Agile, Waterfall, and Hybrid methodologies</p>
    </div>

        
        <div class="qms-grid" style="gap: 24px; margin-top: 0;">

   
<a href="GxP Validation & Project Management Tool.html" class="app-card">
  <div class="app-icon" style="background: linear-gradient(135deg, #10b981, #34d399);">
    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M9 12l2 2 4-4"/>
      <path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
      <path d="M12 2v4m0 12v4m8-10h-4m-12 0H2"/>
    </svg>
  </div>
  <h4>End-to-End Validation</h4>
  <p>Complete lifecycle validation and project management application for GxP computerized systems meeting regulatory requirements</p>
  <div class="app-badge">Application</div>
</a>

     
     <!-- <div class="module-card" onclick="window.location.href='RTMtool.html'" style="cursor: pointer;">
        <h4>ðŸ“Š Traceability Matrix</h4>
        <p>Auto-link requirements to specifications, test scripts, and execution results with full audit trail</p>
      </div> -->
      
    </div>
    </div>
  </div>
</section>


    <!-- Smart Tools -->
    <section id="tools">
      <div class="container">
        <div class="section-head">
          <h2>Smart Tools</h2>
          <p>Smart, compliant, and production-ready tools to enhance productivity and streamline validation processes.</p>
        </div>
        <div class="tools-filters" aria-label="Smart Tools filter">
          <button class="pill-btn active" data-filter="all">All</button>
          <button class="pill-btn" data-filter="ai">AI</button>
          <button class="pill-btn" data-filter="new">New</button>
          <button class="pill-btn" data-filter="popular">Popular</button>
        </div>
        <div class="tools-scroll-wrapper">
          <div class="tools-list" id="smartToolsList">
            <style>
              #smartToolsList { display: flex; flex-wrap: wrap; gap: 24px; justify-content: flex-start; }
              #smartToolsList .tool-item { flex: 0 0 340px; max-width: 340px; min-width: 320px; }
            </style>
            <a href="project-budget-calculator.html" class="tool-item" data-tags="new"><div class="tool-icon">ðŸ’¸</div><div class="tool-content"><h3>Project Budget Calculator</h3><div class="tool-badges"><span class="tool-badge new">New</span></div><p>Advanced, auditable project cost and effort estimator for pharma validation & qualification projects. Scenario, contingency, and export-ready.</p><div class="app-badge">Tool</div></div><div class="tool-arrow">â†’</div></a>
            <a href="smart-tools/project-plan-creation-tool.html" class="tool-item" data-tags="new"><div class="tool-icon">ðŸ—‚ï¸</div><div class="tool-content"><h3>Project Plan Creation Tool</h3><div class="tool-badges"><span class="tool-badge new">New</span></div><p>Auto-generate project phases, tasks, Gantt (Excel), and RACI matrix for SAP, LIMS, UiPath, and more. Exports a ready-to-use Excel workbook.</p><div class="app-badge">Tool</div></div><div class="tool-arrow">â†’</div></a>
            <a href="ComparisionTool.html" class="tool-item" data-tags="popular"><div class="tool-icon">ðŸ“Š</div><div class="tool-content"><h3>Excel Comparison Tool</h3><div class="tool-badges"><span class="tool-badge popular">Popular</span></div><p>Advanced fuzzy matching with composite keys and colorized Excel exports. Perfect for validation evidence generation.</p><div class="app-badge">Tool</div></div><div class="tool-arrow">â†’</div></a>
            <a href="MasterDataTool.html" class="tool-item" data-tags="new"><div class="tool-icon">ðŸ§¬</div><div class="tool-content"><h3>LIMS Master Data Tool</h3><div class="tool-badges"><span class="tool-badge new">New</span></div><p>Automatic master data structuring with smart multi-line detection and intelligent field mapping for LIMS templates.</p><div class="app-badge">Tool</div></div><div class="tool-arrow">â†’</div></a>
            <a href="SOPComparisionTool.html" class="tool-item" data-tags="ai"><div class="tool-icon">ðŸ“</div><div class="tool-content"><h3>SOP Version Comparator</h3><div class="tool-badges"><span class="tool-badge ai">AI</span></div><p>AI-powered side-by-side comparison with change detection, training impact analysis, and compliance reports.</p><div class="app-badge">Tool</div></div><div class="tool-arrow">â†’</div></a>
            <a href="AdvancedUserAcessMatrixTool.html" class="tool-item" data-tags="ai"><div class="tool-icon">ðŸ”</div><div class="tool-content"><h3>User Access Matrix Builder</h3><div class="tool-badges"><span class="tool-badge ai">AI</span></div><p>Visual RBAC matrix with AI-powered segregation of duties conflict detection and GxP audit reports.</p><div class="app-badge">Tool</div></div><div class="tool-arrow">â†’</div></a>
            <a href="ScreenshotToTestEvidenceConverterTool.html" class="tool-item" data-tags="new"><div class="tool-icon">ðŸ“¸</div><div class="tool-content"><h3>Screenshot Evidence Converter</h3><div class="tool-badges"><span class="tool-badge new">New</span></div><p>Batch annotate test screenshots with metadata, timestamps, and auto-generate PDF evidence appendices.</p><div class="app-badge">Tool</div></div><div class="tool-arrow">â†’</div></a>
            <a href="AdvancedRiskAssessmentTool.html" class="tool-item" data-tags="popular"><div class="tool-icon">ðŸŽ¯</div><div class="tool-content"><h3>Advanced Risk Assessment Tool</h3><div class="tool-badges"><span class="tool-badge popular">Popular</span></div><p>GAMP 5 and ICH Q9 compliant risk scoring with automated validation strategy recommendations.</p><div class="app-badge">Tool</div></div><div class="tool-arrow">â†’</div></a>
          </div>
        </div>
        <div style="text-align:center; margin-top: 1.5rem;">
          <button id="showAllSmartToolsBtn" class="pill-btn showall-green" style="display:none;">Show All</button>
        </div>
      </div>
    </section>

    <script>
      document.addEventListener('DOMContentLoaded', function(){
        // Smart Tools Show All/Hide logic
        const pills = document.querySelectorAll('#tools .tools-filters .pill-btn');
        const list = document.getElementById('smartToolsList');
        const cards = Array.from(list.querySelectorAll('.tool-item'));
        const showAllBtn = document.getElementById('showAllSmartToolsBtn');
        let showAll = false;
        function getTilesPerRow() {
          // Estimate how many fit in one row (based on flex or grid)
          const listStyles = window.getComputedStyle(list);
          const gap = parseInt(listStyles.columnGap || listStyles.gap || 24);
          const cardWidth = cards[0]?.offsetWidth || 320;
          const listWidth = list.offsetWidth;
          return Math.max(1, Math.floor((listWidth + gap) / (cardWidth + gap)));
        }
        function renderSmartTools(filter) {
          let filtered = filter === 'all' ? cards : cards.filter(card => {
            const tags = (card.getAttribute('data-tags') || '').toLowerCase();
            return tags.split(/\s+/).includes(filter);
          });
          // Hide all first
          cards.forEach(card => card.style.display = 'none');
          let tilesPerRow = getTilesPerRow();
          // Only show one row in Hide mode, all in Show All
          let toShow = showAll ? filtered : filtered.slice(0, tilesPerRow);
          filtered.forEach((card, idx) => {
            if (showAll || idx < tilesPerRow) {
              card.style.display = '';
            } else {
              card.style.display = 'none';
            }
          });
          // In Hide mode, scroll to start to avoid partial second row
          if (!showAll) {
            list.scrollLeft = 0;
          }
          // Always show Show All/Hide button if more than one tool exists
          if (filtered.length > 1) {
            showAllBtn.style.display = '';
            showAllBtn.textContent = showAll ? 'Hide' : 'Show All';
          } else {
            showAllBtn.style.display = 'none';
          }
        }
        // Initial render
        renderSmartTools('all');
        // Filter pills
        pills.forEach(btn => {
          btn.addEventListener('click', () => {
            pills.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            showAll = false;
            renderSmartTools(btn.getAttribute('data-filter'));
          });
        });
        // Show All/Hide button
        showAllBtn.onclick = function() {
          showAll = !showAll;
          const active = document.querySelector('#tools .tools-filters .pill-btn.active');
          renderSmartTools(active ? active.getAttribute('data-filter') : 'all');
        };
        // Responsive: re-render on resize
        window.addEventListener('resize', () => {
          const active = document.querySelector('#tools .tools-filters .pill-btn.active');
          renderSmartTools(active ? active.getAttribute('data-filter') : 'all');
        });
      });
    </script>

<!-- QMS Applications -->
<section id="qms">
  <div class="container">
    <div class="section-head">
      <h2>Quality Management System Applications</h2>
      <p>Interactive pharmaceutical QMS applications aligned with FDA 21 CFR Part 820, EU GMP, ICH Q10, and ISO 13485</p>
    </div>
    

    <div class="app-grid">
      <a href="change-management.html" class="app-card">
        <div class="app-icon" style="background: linear-gradient(135deg, #3b82f6, #60a5fa);">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            <path d="M9 12l2 2 4-4"/>
          </svg>
        </div>
        <h4>Change Control</h4>
        <p>Manage pharmaceutical change requests with full GMP compliance</p>
        <div class="app-badge">Application</div>
      </a>

      <a href="capa-tool.html" class="app-card">
        <div class="app-icon" style="background: linear-gradient(135deg, #ec4899, #f472b6);">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 2v3m0 14v3M2 12h3m14 0h3"/>
          </svg>
        </div>
        <h4>CAPA</h4>
        <p>Plan, execute, and track corrective and preventive actions systematically</p>
        <div class="app-badge">Application</div>
      </a>

      <a href="riskassessment-tool.html" class="app-card">
        <div class="app-icon" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa);">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 3v18h18"/>
            <path d="M7 16l4-4 4 4 6-6"/>
          </svg>
        </div>
        <h4>Risk Assessment</h4>
        <p>Identify, assess, and mitigate risks using ICH Q9 compliant frameworks</p>
        <div class="app-badge">Application</div>
      </a>

      <a href="audit-inspection-tool.html" class="app-card">
        <div class="app-icon" style="background: linear-gradient(135deg, #14b8a6, #2dd4bf);">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
          </svg>
        </div>
        <h4>Audit & Inspection</h4>
        <p>Digital audit trails and inspection readiness with full documentation</p>
        <div class="app-badge">Application</div>
      </a>

      <a href="training-tool.html" class="app-card">
        <div class="app-icon" style="background: linear-gradient(135deg, #10b981, #34d399);">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 14l9-5-9-5-9 5 9 5z"/>
            <path d="M12 14l6.16-3.422A12 12 0 0121 14.667V18a2 2 0 01-2 2H5a2 2 0 01-2-2v-3.333a12 12 0 012.84-7.089L12 14z"/>
          </svg>
        </div>
        <h4>Training</h4>
        <p>Ensure training effectiveness tied to system and process changes</p>
        <div class="app-badge">Application</div>
      </a>

      <a href="non-conformance-tool.html" class="app-card">
        <div class="app-icon" style="background: linear-gradient(135deg, #ef4444, #f87171);">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
            <line x1="12" y1="9" x2="12" y2="13"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
        </div>
        <h4>Non-Conformance</h4>
        <p>Track and manage quality deviations and non-conforming products</p>
        <div class="app-badge">Application</div>
      </a>

      <a href="defect-management-tool.html" class="app-card">
        <div class="app-icon" style="background: linear-gradient(135deg, #ef4444, #f87171);">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 7v5"/>
            <circle cx="12" cy="17" r="1"/>
          </svg>
        </div>
        <h4>Defect Management</h4>
        <p>Track defect lifecycle from discovery through investigation, correction, and verification</p>
        <div class="app-badge">Application</div>
      </a>
      
    </div>
  </div>
</section>

<!-- QMS Procedures -->
<section id="QMS Procedures">
  <div class="container">
    <div class="section-head">
      <h2>Quality Management System Procedures</h2>
      <p>Complete pharmaceutical QMS procedures aligned with FDA 21 CFR Part 820, EU GMP, ICH Q10, and ISO 13485</p>
    </div>
    
    
    <div class="app-grid" id="qmsProceduresGrid">
      <!-- QMS Procedures will be rendered dynamically by JavaScript -->
    </div>
    <div style="text-align:center; margin-top: 1.5rem;">
      <button id="showAllQMSBtn" class="pill-btn showall-green" style="display:none;">Show All</button>
      <style>
        .showall-green {
          background: linear-gradient(135deg, #10b981, #34d399) !important;
          color: #000 !important;
          font-weight: 600;
          border: none;
          border-radius: 999px;
          padding: 10px 28px;
          font-size: 15px;
          box-shadow: 0 2px 8px 0 rgba(16,185,129,0.08);
          transition: background 0.2s, color 0.2s;
        }
        .showall-green:hover {
          background: linear-gradient(135deg, #059669, #10b981) !important;
          color: #fff !important;
        }
      </style>
    </div>
  </div>
</section>


<!-- Validation Courses with Payment -->
<section id="ValQMS Academy">
  <div class="container">
    <div class="section-head">
      <h2>ValQMS Academy</h2>
      <p>Purchase individual courses or subscribe for unlimited access to all training content</p>
    </div>

    <!-- Academy Category Filters -->
    <div class="academy-filters" id="academyFilters" style="margin-bottom: 2rem; display: flex; gap: 10px; flex-wrap: wrap;"></div>

    <div class="app-grid" id="coursesGrid">
      <!-- Courses will be rendered dynamically by JavaScript -->
    </div>
    <div style="text-align:center; margin-top: 1.5rem;">
  <button id="showAllCoursesBtn" class="pill-btn showall-green" style="display:none;">Show All</button>
    <style>
      .showall-green {
        background: linear-gradient(135deg, #10b981, #34d399) !important;
        color: #000 !important;
        font-weight: 600;
        border: none;
        border-radius: 999px;
        padding: 10px 28px;
        font-size: 15px;
        box-shadow: 0 2px 8px 0 rgba(16,185,129,0.08);
        transition: background 0.2s, color 0.2s;
      }
      .showall-green:hover {
        background: linear-gradient(135deg, #059669, #10b981) !important;
        color: #fff !important;
      }
    </style>
    </div>

    <!-- My Purchased Courses -->
    <div class="my-courses" style="margin-top: 3rem; padding: 2rem; background: var(--glass); border: 1px dashed var(--border); border-radius: 18px;">
      <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">My Purchased Courses</h3>
      <div id="myCoursesList" class="empty-state" style="color: var(--text-dim); font-style:normal;">
        Login to view your purchased courses.
      </div>
    </div>
  </div>
</section>




    <!-- Resources -->
    <section id="resources">
      <div class="container">
        <div class="section-head">
          <h2>Regulatory Resources</h2>
          <p>Stay compliant with latest guidelines and regulatory updates</p>
        </div>
        <!-- Resources Filters -->
        <div class="tools-filters resources-filters" aria-label="Resources filter">
          <button class="pill-btn active" data-filter="all">All</button>
          <button class="pill-btn" data-filter="fda">FDA</button>
          <button class="pill-btn" data-filter="ema">EMA</button>
          <button class="pill-btn" data-filter="who">WHO</button>
          <button class="pill-btn" data-filter="ich">ICH</button>
          <button class="pill-btn" data-filter="iso">ISO</button>
          <button class="pill-btn" data-filter="pics">PIC/S</button>
          <button class="pill-btn" data-filter="mhra">MHRA</button>
          <button class="pill-btn" data-filter="tga">TGA</button>
          <button class="pill-btn" data-filter="pmda">PMDA</button>
          <button class="pill-btn" data-filter="cdsco">CDSCO</button>
          <button class="pill-btn" data-filter="nmpa">NMPA</button>
        </div>
        <div class="resources-grid">
          <div class="resource-card">
            <div class="resource-header">
              <div class="resource-title">
                <div class="resource-icon">ðŸ“š</div>
                <div>
                  <h3>Key Guidelines</h3>
                  <p class="resource-desc">Core frameworks for quality, validation, and data integrity</p>
                </div>
              </div>
              <span class="link-count" aria-label="Links">0</span>
            </div>
            <ul>
              <li data-tags="fda guideline"><span class="flag flag-us"></span> <a href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents/part-11-electronic-records-electronic-signatures-scope-and-application" target="_blank">FDA 21 CFR Part 11 - Electronic Records</a></li>
              <li data-tags="fda guideline"><span class="flag flag-us"></span> <a href="https://www.fda.gov/medical-devices/quality-system-qs-regulationdevice-good-manufacturing-practices" target="_blank">FDA 21 CFR Part 820 - Quality System Regulation</a></li>
              <li data-tags="ema gmp guideline"><span class="flag flag-eu"></span> <a href="https://www.ema.europa.eu/en/human-regulatory/research-development/scientific-guidelines/multidisciplinary/multidisciplinary-quality" target="_blank">EU GMP Guidelines - Annex 11</a></li>
              <li data-tags="ich guideline"><span class="flag flag-ich"></span> <a href="https://database.ich.org/sites/default/files/Q10%20Guideline.pdf" target="_blank">ICH Q10 - Pharmaceutical Quality System</a></li>
              <li data-tags="ich guideline"><span class="flag flag-ich"></span> <a href="https://database.ich.org/sites/default/files/Q9_Guideline.pdf" target="_blank">ICH Q9 - Quality Risk Management</a></li>
              <li data-tags="iso guideline"><span class="flag flag-iso"></span> <a href="https://www.iso.org/standard/59752.html" target="_blank">ISO 13485 - Medical Devices QMS</a></li>
              <li data-tags="iso guideline"><span class="flag flag-iso"></span> <a href="https://www.iso.org/standard/62085.html" target="_blank">ISO 9001 - Quality Management Systems</a></li>
              <li data-tags="fda csv guideline"><span class="flag flag-us"></span> <a href="https://www.fda.gov/media/116573/download" target="_blank">FDA Computer System Validation Guidance</a></li>
              <li data-tags="ema data-integrity guideline"><span class="flag flag-eu"></span> <a href="https://www.ema.europa.eu/en/data-integrity" target="_blank">EMA Data Integrity Guidelines</a></li>
              <li data-tags="fda biologics guideline"><span class="flag flag-us"></span> <a href="https://www.fda.gov/vaccines-blood-biologics/guidance-compliance-regulatory-information-biologics/biologics-guidances" target="_blank">FDA Biologics Guidances</a></li>
              <li data-tags="raps community">ðŸ‘¥ <a href="https://www.raps.org" target="_blank">RAPS - Regulatory Affairs Professionals Society</a></li>
            </ul>
          </div>
          <div class="resource-card">
            <div class="resource-header">
              <div class="resource-title">
                <div class="resource-icon">ðŸ“°</div>
                <div>
                  <h3>Regulatory Updates</h3>
                  <p class="resource-desc">Latest guidance, news, and agency publications</p>
                </div>
              </div>
              <span class="link-count" aria-label="Links">0</span>
            </div>
            <ul>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov" target="_blank">FDA Guidance Documents</a></li>
              <li data-tags="ema"><span class="flag flag-eu"></span> <a href="https://www.ema.europa.eu" target="_blank">EMA News & Events</a></li>
              <li data-tags="who"><span class="flag flag-globe"></span> <a href="https://www.who.int" target="_blank">WHO Quality Assurance</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/news-events/fda-newsroom" target="_blank">FDA Newsroom - Latest Updates</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents" target="_blank">FDA Guidance Documents</a></li>
              <li data-tags="ema"><span class="flag flag-eu"></span> <a href="https://www.ema.europa.eu/en/news-events" target="_blank">EMA News & Events</a></li>
              <li data-tags="ema"><span class="flag flag-eu"></span> <a href="https://www.ema.europa.eu/en/human-regulatory/research-development/scientific-guidelines" target="_blank">EMA Scientific Guidelines</a></li>
              <li data-tags="ich"><span class="flag flag-ich"></span> <a href="https://www.ich.org/page/news" target="_blank">ICH News & Updates</a></li>
              <li data-tags="who"><span class="flag flag-globe"></span> <a href="https://www.who.int/news-room" target="_blank">WHO News Room</a></li>
              <li data-tags="pics">ðŸ¤ <a href="https://www.picscheme.org/en/news" target="_blank">PIC/S News & Updates</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/drugs/drug-approvals-and-databases/drug-safety-communications" target="_blank">FDA Drug Safety Communications</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/medical-devices/device-advice-comprehensive-regulatory-assistance/medical-device-recalls" target="_blank">FDA Medical Device Recalls</a></li>
              <li data-tags="ema"><span class="flag flag-eu"></span> <a href="https://www.ema.europa.eu/en/human-regulatory/post-authorisation/pharmacovigilance" target="_blank">EMA Pharmacovigilance Updates</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/inspections-compliance-enforcement-and-criminal-investigations/warning-letters" target="_blank">FDA Warning Letters</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/inspections-compliance-enforcement-and-criminal-investigations/compliance-actions-and-activities" target="_blank">FDA Compliance Actions</a></li>
              <li data-tags="ema"><span class="flag flag-eu"></span> <a href="https://www.ema.europa.eu/en/news-events/regulatory-updates" target="_blank">EMA Regulatory Updates</a></li>
              <li data-tags="health-canada"><span class="flag flag-ca"></span> <a href="https://www.canada.ca/en/health-canada/services/drugs-health-products/drug-products/applications-submissions/guidance-documents.html" target="_blank">Health Canada Guidance</a></li>
              <li data-tags="mhra"><span class="flag flag-uk"></span> <a href="https://www.mhra.gov.uk/news-and-events/" target="_blank">MHRA News & Publications</a></li>
              <li data-tags="tga"><span class="flag flag-au"></span> <a href="https://www.tga.gov.au/news-and-events" target="_blank">TGA (Australia) News</a></li>
              <li data-tags="pmda"><span class="flag flag-jp"></span> <a href="https://www.pmda.go.jp/english/index.html" target="_blank">PMDA (Japan) Updates</a></li>
              <li data-tags="cdsco"><span class="flag flag-in"></span> <a href="https://cdsco.gov.in/opencms/opencms/en/Home/" target="_blank">CDSCO (India) - Central Drugs Standard Control</a></li>
              <li data-tags="nmpa"><span class="flag flag-cn"></span> <a href="https://www.nmpa.gov.cn/en/" target="_blank">NMPA (China) News</a></li>
            </ul>
          </div>
          <div class="resource-card">
            <div class="resource-header">
              <div class="resource-title">
                <div class="resource-icon">ðŸ”Ž</div>
                <div>
                  <h3>Regulatory Observations</h3>
                  <p class="resource-desc">Inspection guides, letters, and remediation insights</p>
                </div>
              </div>
              <span class="link-count" aria-label="Links">0</span>
            </div>
            <ul>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/inspections-compliance-enforcement-and-criminal-investigations/inspection-references/inspection-guides" target="_blank">FDA Inspection Guides</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/inspections-compliance-enforcement-and-criminal-investigations/inspection-references/inspection-reports" target="_blank">FDA Establishment Inspection Reports (EIRs)</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/inspections-compliance-enforcement-and-criminal-investigations/warning-letters" target="_blank">FDA Warning Letters Database</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/inspections-compliance-enforcement-and-criminal-investigations/compliance-actions-and-activities/warning-letters" target="_blank">FDA Recent Warning Letters</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/inspections-compliance-enforcement-and-criminal-investigations/compliance-actions-and-activities/untitled-letters" target="_blank">FDA Untitled Letters</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.accessdata.fda.gov/scripts/cder/clia/index.cfm" target="_blank">FDA Clinical Laboratory Improvement Amendments (CLIA)</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://datadashboard.fda.gov/ora/firmssearch.htm" target="_blank">FDA Inspection Classifications Database</a></li>
              <li data-tags="ema"><span class="flag flag-eu"></span> <a href="https://www.ema.europa.eu/en/human-regulatory/research-development/compliance/good-manufacturing-practice/inspection-database" target="_blank">EMA GMP Inspection Database</a></li>
              <li data-tags="ema"><span class="flag flag-eu"></span> <a href="https://www.ema.europa.eu/en/human-regulatory/post-authorisation/compliance/non-compliance" target="_blank">EMA Non-Compliance Reports</a></li>
              <li data-tags="pics">ðŸ¤ <a href="https://www.picscheme.org/en/inspection-reliance" target="_blank">PIC/S Inspection Reliance Database</a></li>
              <li data-tags="mhra"><span class="flag flag-uk"></span> <a href="https://www.mhra.gov.uk/inspection-and-enforcement/" target="_blank">MHRA Inspection Reports</a></li>
              <li data-tags="health-canada"><span class="flag flag-ca"></span> <a href="https://www.canada.ca/en/health-canada/services/drugs-health-products/compliance-enforcement/inspections.html" target="_blank">Health Canada Inspection Reports</a></li>
              <li data-tags="tga"><span class="flag flag-au"></span> <a href="https://www.tga.gov.au/compliance-action" target="_blank">TGA Compliance Actions</a></li>
              <li data-tags="who"><span class="flag flag-globe"></span> <a href="https://www.who.int/teams/regulation-prequalification/inspection" target="_blank">WHO Inspection Reports</a></li>
              <li data-tags="gmp">ðŸ§° <a href="https://www.gmp-compliance.org/gmp-news/fda-warning-letters" target="_blank">GMP Compliance - FDA Warning Letters Analysis</a></li>
              <li data-tags="fda"><span class="flag flag-us"></span> <a href="https://www.fda.gov/inspections-compliance-enforcement-and-criminal-investigations/inspection-references/responding-form-fda-483" target="_blank">FDA - Responding to Form 483</a></li>
              <li data-tags="raps">ðŸ‘¥ <a href="https://www.raps.org/news-and-articles/news-articles/how-to-respond-to-fda-warning-letter" target="_blank">RAPS - How to Respond to Warning Letters</a></li>
              <li data-tags="gmp">ðŸ§° <a href="https://www.gmp-compliance.org/gmp-news/warning-letter-response" target="_blank">GMP Compliance - Warning Letter Response Guide</a></li>
              <li data-tags="ispe">ðŸ§ª <a href="https://www.ispe.org/pharmaceutical-engineering/ispeak/inspection-readiness-and-response" target="_blank">ISPE - Inspection Readiness & Response</a></li>
              <li data-tags="pda">ðŸ§ª <a href="https://www.pda.org/resources/regulatory-resources/inspection-remediation" target="_blank">PDA - Inspection & Remediation Resources</a></li>
              <li data-tags="fda change-control">ðŸ¦… <a href="https://www.fda.gov/drugs/pharmaceutical-quality-resources/facts-about-current-good-manufacturing-practices-cgmps" target="_blank">FDA CGMP Change Control Findings</a></li>
              <li data-tags="gmp change-control">ðŸ§° <a href="https://www.gmp-compliance.org/gmp-news/change-control" target="_blank">GMP Compliance - Change Control Violations</a></li>
              <li data-tags="news change-control">ðŸ—žï¸ <a href="https://www.pharmaceutical-technology.com/features/change-control-common-inspection-findings/" target="_blank">Pharma Tech - Change Control Inspection Findings</a></li>
              <li data-tags="news change-control">ðŸ—žï¸ <a href="https://www.in-pharmatechnologist.com/Article/Common-change-control-deficiencies-in-pharma" target="_blank">In-Pharma - Change Control Deficiencies</a></li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <script>
      // Resources filters + dynamic counts
      document.addEventListener('DOMContentLoaded', function(){
        const resSection = document.getElementById('resources');
        const filterBtns = resSection?.querySelectorAll('.resources-filters .pill-btn') || [];
        const allItems = resSection?.querySelectorAll('.resource-card li') || [];

        function updateCounts() {
          document.querySelectorAll('#resources .resource-card').forEach(card => {
            const countEl = card.querySelector('.link-count');
            const visible = card.querySelectorAll('ul li:not(.hidden)').length;
            if (countEl) {
              countEl.textContent = String(visible);
              countEl.setAttribute('aria-label', visible + ' links');
            }
          });
        }

        function applyResFilter(filter) {
          allItems.forEach(li => {
            li.classList.remove('hidden');
            if (filter !== 'all') {
              const tags = (li.dataset.tags || '').toLowerCase().split(/\s+/);
              if (!tags.includes(filter)) li.classList.add('hidden');
            }
          });
          updateCounts();
        }

        // Init counts for All
        applyResFilter('all');

        filterBtns.forEach(btn => {
          btn.addEventListener('click', () => {
            filterBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            applyResFilter(btn.dataset.filter);
          });
        });
      });
    </script>

    <!-- About -->
    <section id="about">
      <div class="container">
        <div class="section-head">
          <h2>Why ValQMS?</h2>
          <p>Built by validation experts for validation experts</p>
        </div>
        <div class="qms-grid">
          <div class="module-card"><h4>âš¡ All-in-One QMS Platform</h4><p>Change control, CAPA, deviations, training, risk management, and audit tools - all integrated in one platform</p></div>
          <div class="module-card"><h4>ðŸ”’ End-to-End Validation</h4><p>Complete project and validation lifecycle management from GxP assessment to go-live with GAMP 5 compliance</p></div>
          <div class="module-card"><h4>â˜ï¸ Zero Installation</h4><p>Zero installation required. Access anywhere, anytime. Your validation data is secure and backed up automatically</p></div>
          <div class="module-card"><h4>ðŸŽ¯ Automated Workflows</h4><p>Smart GxP assessment, automatic version tracking, and risk-based validation. Reduce manual effort by 70%</p></div>
          <div class="module-card"><h4>ðŸ›¡ï¸ Regulatory Compliant</h4><p>Built-in compliance with FDA, EU GMP Annex 11, and GAMP 5 guidelines with complete audit trails</p></div>
          <div class="module-card"><h4>ðŸ‘¥ Team Collaboration</h4><p>Cloud-based platform enabling real-time collaboration across validation, QA, and IT teams. Track progress, assign tasks, and manage deliverables seamlessly.</p></div>
          <div class="module-card"><h4>ðŸ“Š Real-Time Analytics</h4><p>Live dashboards and reports. Monitor project status, resource allocation, and validation metrics in real-time</p></div>
          <div class="module-card"><h4>ðŸš€ Inspection-Ready</h4><p>Complete audit trails, traceability matrix, and instant reporting. Be audit-ready at all times</p></div>       
        </div>
      </div>
    </section>
  </main>

  <!-- MODERN FOOTER -->
  <footer>
    <div class="footer-content">
      <div class="container">
        <div class="footer-grid">
          <div class="footer-brand">
            <a href="index.html" class="logo" style="color:#0f172a !important;">
              <div class="logo-mark"><span class="brand-initials">VQ</span></div>
              <span>ValQMS</span>
            </a>
            <p>Empowering Life Sciences organizations with browser-native advanced tools for validation, automation, and regulatory compliance.</p><p>For any help or support please drop an email at <u>support@valqms.com</u></p>
          </div>
      <div class="footer-col">
        <h5>Product</h5>
        <ul>
          <li><a href="#tools">Smart Tools</a></li>
          <li><a href="#qms">QMS Applications</a></li>
          <li><a href="#qms-procedures">QMS Procedures</a></li>
          <li><a href="#validation">GxP Validation & Project Management</a></li>
          <li><a href="#ValQMS Academy">ValQMS Academy</a></li>
          <li><a href="#resources">Resources</a></li>
        </ul>
      </div>
          <div class="footer-col">
            <h5>Company</h5>
            <ul>
              <li><a href="#about">About</a></li>
              <li><a href="mailto:support@valqms.com">Contact</a></li>
              <li><a href="Privacy.html">Privacy</a></li>
              <li><a href="Terms.html">Terms</a></li>
            </ul>
          </div>
          <div class="footer-col">
            <h5>Regulatory</h5>
            <ul>
              <li><a href="https://www.fda.gov" target="_blank">FDA</a></li>
              <li><a href="https://www.ema.europa.eu" target="_blank">EMA</a></li>
              <li><a href="https://www.who.int" target="_blank">WHO</a></li>
              <li><a href="https://www.ich.org" target="_blank">ICH</a></li>
            </ul>
          </div>
        </div>
        <div class="footer-bottom">
          <p>Â© 2025 ValQMS. Built with â¤ï¸ by validation experts for validation experts</p>
          <div class="footer-socials">
           <!-- <a href="#" title="Twitter">ð•</a> -->
            <a href="#" title="LinkedIn">in</a>
           <!-- <a href="#" title="GitHub">{ }</a> -->
          </div>
        </div>
      </div>
    </div>
  </footer>

<!-- Profile Panel -->
<div id="profilePanel">
  <div class="profile-content">
    <button class="close-btn" id="closeProfileBtn">Ã—</button>
    
    <div class="profile-header">
      <div class="profile-avatar" id="profileAvatar">NK</div>
      <h2>My Profile</h2>
    </div>
    
    <div id="profileMsg"></div>
    
    <div>
      <label>Full Name</label>
      <input id="pf_full_name" type="text" placeholder="Your full name">
    </div>
    
    <div>
      <label>Email</label>
      <input id="pf_email" type="email" placeholder="you@company.com" disabled>
    </div>
    
    <div>
      <label>Mobile Number</label>
      <input id="pf_phone" type="tel" placeholder="+91-XXXXXXXXXX">
    </div>
    
    <div class="btn-group">
      <button id="saveProfileBtn" class="btn btn-primary">Save Changes</button>
      <button class="btn btn-secondary" onclick="document.getElementById('profilePanel').style.display='none'">Cancel</button>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script type="module">
  const SUPABASE_URL = 'https://nufpaayytxtjihqrvtfi.supabase.co';
  const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im51ZnBhYXl5dHh0amlocXJ2dGZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzMzA5NjIsImV4cCI6MjA3NTkwNjk2Mn0.766ENc3lMQSVJIsyxK6xlPE5DNlB3Np3eeXxvcoRGGY';

  const { createClient } = supabase;
  const sb = createClient(SUPABASE_URL, SUPABASE_KEY);

     window.sb = sb;

    // Check authentication immediately
  (async function checkAuth() {
    const { data: { session }, error } = await sb.auth.getSession();
    
    if (!session) {
      // No session - redirect to login
      console.log('No active session. Redirecting to login...');
      window.location.href = 'login.html';
      return;
    }
    
    // User is authenticated - show content
    console.log('User authenticated:', session.user.email);
    
    // Update UI with user info
    if (session && session.user) {
      const userMenu = document.getElementById('userMenu');
      const loginLink = document.getElementById('loginLink');
      const userBadge = document.getElementById('userBadge');
      
      if (loginLink) loginLink.style.display = 'none';
      if (userMenu) userMenu.style.display = 'inline-block';
      
      if (userBadge) {
        const displayName = session.user.user_metadata?.full_name || session.user.email.split('@')[0];
        userBadge.textContent = getInitials(displayName);
      }

       await displayUserRole()  // â† ADD THIS!
      // Load role via AccessControl and reveal admin-only items if admin
      try {
        await AccessControl.init({ supabase: sb })
  const roleName = (AccessControl.role || '').toString().toUpperCase()
  const isAdmin = roleName === 'SYSTEM ADMIN' || roleName === 'ADMIN' || AccessControl.permissions?.all === true
        if (isAdmin) {
          document.querySelectorAll('.admin-only').forEach(el => { el.style.display='inline-block' })
          const demoNav = document.getElementById('demoRequestsNav')
          if (demoNav) demoNav.style.display='inline-block'
          initDemoWidget()
        }
      } catch(e){ console.warn('Admin link init failed', e) }
      
      // Save to localStorage
      localStorage.setItem('valqmsUser', JSON.stringify({
        email: session.user.email,
        name: session.user.user_metadata?.full_name || session.user.email.split('@')[0],
        picture: session.user.user_metadata?.avatar_url,
        loggedIn: true,
        provider: session.user.app_metadata?.provider || 'email',
        timestamp: Date.now()
      }));
    }
  })();

  // Admin demo widget logic (recent demo requests summary)
  async function initDemoWidget(){
    let widget = document.getElementById('adminDemoWidget')
    if (!widget){
      widget = document.createElement('section')
      widget.id = 'adminDemoWidget'
      widget.style.cssText = 'padding:40px 0'
      widget.innerHTML = `<div class=\"container\" style=\"max-width:1100px;\">\n        <div style=\"display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:16px;\">\n          <h3 style=\"margin:0;font-size:24px;font-weight:800;color:#0f172a;letter-spacing:-0.5px;\">Recent Demo Requests</h3>\n          <a href=\"demo-requests.html\" style=\"text-decoration:none;font-size:13px;font-weight:700;padding:8px 14px;background:#ffffff;border:1px solid #e5e7eb;border-radius:8px;color:#0f172a;\">View All â†’</a>\n        </div>\n        <div id=\"demoWidgetBody\" style=\"display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:14px;\"></div>\n      </div>`
      const hero = document.querySelector('.hero')
      if (hero && hero.parentElement){ hero.parentElement.insertBefore(widget, hero.nextSibling) }
    }
    loadRecentDemoRequests()
  }

  async function loadRecentDemoRequests(){
    const body = document.getElementById('demoWidgetBody')
    if (!body) return
    body.innerHTML = '<div style="grid-column:1/-1;font-size:13px;color:#64748b;">Loadingâ€¦</div>'
    const { data, error } = await sb.from('demo_requests').select('*').order('created_at', { ascending:false }).limit(5)
    if (error){ body.innerHTML = `<div style='grid-column:1/-1;color:#dc2626;font-size:13px;'>Error: ${error.message}</div>`; return }
    if (!data.length){ body.innerHTML = '<div style="grid-column:1/-1;font-size:13px;color:#64748b;">No demo requests yet.</div>'; return }
    body.innerHTML = data.map(r => demoCard(r)).join('')
  }

  function demoCard(r){
    const statusColor = {
      pending: 'background:rgba(234,179,8,0.15);color:#92400e;',
      contacted: 'background:rgba(59,130,246,0.15);color:#1e3a8a;',
      scheduled: 'background:rgba(16,185,129,0.15);color:#065f46;',
      closed: 'background:#f1f5f9;color:#0f172a;'
    }[r.status||'pending']
    return `<div style=\"border:1px solid #e5e7eb;border-radius:12px;padding:14px;background:#ffffff;display:flex;flex-direction:column;gap:8px;box-shadow:0 1px 2px rgba(15,23,42,0.06);\">\n      <div style=\"display:flex;justify-content:space-between;align-items:center;gap:8px;\">\n        <div style=\"font-weight:700;font-size:14px;color:#0f172a;\">${escapeHtml(r.name)}</div>\n        <div style=\"font-size:10px;padding:4px 8px;border-radius:999px;font-weight:700;${statusColor}\">${(r.status||'pending').toUpperCase()}</div>\n      </div>\n      <div style=\"font-size:12px;color:#475569;word-break:break-word;\">${escapeHtml(r.company||'')}</div>\n      <a href=\"mailto:${escapeHtml(r.email)}\" style=\"font-size:12px;color:#0f172a;text-decoration:none;font-weight:600;\">${escapeHtml(r.email)}</a>\n      <div style=\"font-size:11px;color:#64748b;\">${escapeHtml(r.message||'No message')}</div>\n      <div style=\"font-size:10px;color:#64748b;\">${new Date(r.created_at).toLocaleString()}</div>\n    </div>`
  }

  function escapeHtml(v){ return (v||'').toString().replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])) }

  // Initialize theme FIRST
  const savedTheme = localStorage.getItem('valqmsTheme') || 'green';
  const savedBg = localStorage.getItem('valqmsBg') || 'mesh';
  document.documentElement.setAttribute('data-theme', savedTheme);
  document.documentElement.setAttribute('data-bg', savedBg);

  // Apply saved custom brand colors if any
  const savedAccent = localStorage.getItem('valqmsAccent');
  const savedAccentBright = localStorage.getItem('valqmsAccentBright');
  if (savedAccent) document.documentElement.style.setProperty('--accent', savedAccent);
  if (savedAccentBright) document.documentElement.style.setProperty('--accent-bright', savedAccentBright);

  // Background selector
  // Brand selector (combined Theme + Background)
  const brandBtn = document.getElementById('brandBtn');
  const brandDropdown = document.getElementById('brandDropdown');
  const accentInput = document.getElementById('accentColorInput');
  const accentBrightInput = document.getElementById('accentBrightInput');
  const accentChip = document.getElementById('accentChip');
  const accentBrightChip = document.getElementById('accentBrightChip');
  const brandApplyBtn = document.getElementById('brandApplyBtn');
  const brandResetBtn = document.getElementById('brandResetBtn');

  function getCssVar(name){
    return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
  }

  function initBrandColorInputs(){
    if (!accentInput || !accentBrightInput) return;
    const currentAccent = savedAccent || getCssVar('--accent') || '#06b6d4';
    const currentAccentBright = savedAccentBright || getCssVar('--accent-bright') || '#22d3ee';
    // Ensure hex format for inputs
    accentInput.value = currentAccent.startsWith('#') ? currentAccent : '#06b6d4';
    accentBrightInput.value = currentAccentBright.startsWith('#') ? currentAccentBright : '#22d3ee';
    if (accentChip) accentChip.style.background = accentInput.value;
    if (accentBrightChip) accentBrightChip.style.background = accentBrightInput.value;
  }

  // Live update chips when picking colors
  accentInput?.addEventListener('input', () => {
    if (accentChip) accentChip.style.background = accentInput.value;
  });
  accentBrightInput?.addEventListener('input', () => {
    if (accentBrightChip) accentBrightChip.style.background = accentBrightInput.value;
  });
  if (brandBtn && brandDropdown) {
    brandBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      brandDropdown.classList.toggle('active');
      if (brandDropdown.classList.contains('active')) {
        initBrandColorInputs();
        // Scroll the color controls into view so Primary/Accent bright are visible immediately
        const colorsSection = brandDropdown.querySelector('.brand-colors');
        if (colorsSection) {
          colorsSection.scrollIntoView({ block: 'start' });
        }
      }
      // Close user menu if open to avoid overlap
      if (userDropdown) userDropdown.classList.remove('active');
    });
    // Theme selection inside brand dropdown
    brandDropdown.querySelectorAll('.theme-option').forEach(opt => {
      opt.addEventListener('click', () => {
        const theme = opt.dataset.theme;
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('valqmsTheme', theme);
        brandDropdown.classList.remove('active');
      });
    });
    // Background selection inside brand dropdown
    brandDropdown.querySelectorAll('.bg-option').forEach(opt => {
      opt.addEventListener('click', () => {
        const bg = opt.dataset.bg;
        document.documentElement.setAttribute('data-bg', bg);
        localStorage.setItem('valqmsBg', bg);
        brandDropdown.classList.remove('active');
      });
    });
    // Prevent close when clicking inside dropdown
    brandDropdown.addEventListener('click', (e) => e.stopPropagation());

    // Apply and Reset
    brandApplyBtn?.addEventListener('click', () => {
      if (accentInput) {
        document.documentElement.style.setProperty('--accent', accentInput.value);
        localStorage.setItem('valqmsAccent', accentInput.value);
      }
      if (accentBrightInput) {
        document.documentElement.style.setProperty('--accent-bright', accentBrightInput.value);
        localStorage.setItem('valqmsAccentBright', accentBrightInput.value);
      }
      brandDropdown.classList.remove('active');
    });

    brandResetBtn?.addEventListener('click', () => {
      localStorage.removeItem('valqmsAccent');
      localStorage.removeItem('valqmsAccentBright');
      document.documentElement.style.removeProperty('--accent');
      document.documentElement.style.removeProperty('--accent-bright');
      initBrandColorInputs();
    });
  }

  // Close brand dropdown on outside click
  document.addEventListener('click', () => {
    if (brandDropdown) brandDropdown.classList.remove('active');
    if (userDropdown) userDropdown.classList.remove('active');
  });

  // User menu setup
  const loginLink = document.getElementById('loginLink');
  const userMenu = document.getElementById('userMenu');
  const userBadge = document.getElementById('userBadge');
  const userDropdown = document.getElementById('userDropdown');
  const profileBtn = document.getElementById('profileBtn');
  const logoutBtn = document.getElementById('logoutBtn');
  const profilePanel = document.getElementById('profilePanel');


  // Add this RIGHT AFTER the checkAuth function (around line 950-1000)

// ============================================
// ROLE-BASED ACCESS CONTROL FUNCTIONS
// ============================================

// Helper: Parse JWT token to get custom claims
function parseJwt(token) {
  try {
    const base64Url = token.split('.')[1]
    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/')
    const jsonPayload = decodeURIComponent(
      atob(base64).split('').map(c => {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)
      }).join('')
    )
    return JSON.parse(jsonPayload)
  } catch (error) {
    console.error('Error parsing JWT:', error)
    return null
  }
}

// Get current user role and permissions from JWT
async function getUserRole() {
  try {
    const { data: { session }, error } = await sb.auth.getSession()
    
    if (error || !session) {
      return null
    }
    
    // Decode JWT to get custom claims
    const jwt = parseJwt(session.access_token)
    
    if (!jwt) {
      return null
    }
    
    return {
      userId: session.user.id,
      email: session.user.email,
      role: jwt.user_role || 'No role assigned',
      roleId: jwt.role_id,
      permissions: jwt.permissions || {},
      fullUser: session.user
    }
  } catch (error) {
    console.error('Error getting user role:', error)
    return null
  }
}

// Check if user has specific permission
function hasPermission(permissions, resource, action) {
  // Check for admin (all: true)
  if (permissions?.all === true) {
    return true
  }
  
  // Check resource-specific permissions
  if (permissions && permissions[resource]) {
    if (Array.isArray(permissions[resource])) {
      return permissions[resource].includes(action)
    }
  }
  
  return false
}

// Check if user is admin
function isAdmin(permissions) {
  return permissions?.all === true
}

// Display user role in the UI
async function displayUserRole() {
  const userInfo = await getUserRole()
  
  if (!userInfo) {
    console.log('No user info available')
    return
  }
  
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•')
  console.log('USER AUTHENTICATION INFO')
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•')
  console.log('Email:', userInfo.email)
  console.log('Role:', userInfo.role)
  console.log('Permissions:', userInfo.permissions)
  console.log('Is Admin:', isAdmin(userInfo.permissions))
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•')
  
  // Update user badge to show role
  const userBadge = document.getElementById('userBadge')
  if (userBadge && userInfo.role) {
    // Show first letter + role name on hover
    userBadge.title = `${userInfo.email} - ${userInfo.role}`
    
    // Optional: Add role indicator
    const roleIndicator = document.createElement('div')
    roleIndicator.style.cssText = `
      position: absolute;
      bottom: -2px;
      right: -2px;
      width: 14px;
      height: 14px;
      background: ${getRoleColor(userInfo.role)};
      border-radius: 50%;
      border: 2px solid #0f172a;
      box-shadow: 0 0 10px ${getRoleColor(userInfo.role)};
    `
    roleIndicator.title = userInfo.role
    
    userBadge.style.position = 'relative'
    
    // Remove existing indicator if any
    const existing = userBadge.querySelector('[data-role-indicator]')
    if (existing) existing.remove()
    
    roleIndicator.dataset.roleIndicator = 'true'
    userBadge.appendChild(roleIndicator)
  }
  
  // Show/hide features based on permissions
  setupPermissionBasedUI(userInfo)
  
  return userInfo
}

// Get color based on role
function getRoleColor(role) {
  const colors = {
    'System Admin': '#ef4444',
    'QA Manager': '#3b82f6',
    'QA Reviewer': '#f59e0b',
    'Department User': '#10b981',
    'Auditor': '#8b5cf6',
    'CAPA Owner': '#ec4899'
  }
  return colors[role] || '#00ff88'
}

// Setup UI based on permissions
function setupPermissionBasedUI(userInfo) {
  const { permissions, role } = userInfo
  
  console.log('Setting up UI for role:', role)
  
  // Admin-only features
  if (isAdmin(permissions)) {
    console.log('âœ“ Admin access granted')
    // Enable all admin features
    document.querySelectorAll('.admin-only').forEach(el => {
      el.style.display = 'block'
    })
  }
  
  // Manager features (reports approval)
  if (hasPermission(permissions, 'deviations', 'approve')) {
    console.log('âœ“ Manager access granted')
    document.querySelectorAll('.manager-only').forEach(el => {
      el.style.display = 'block'
    })
  }
  
  // Reviewer features
  if (hasPermission(permissions, 'deviations', 'update')) {
    console.log('âœ“ Reviewer access granted')
    document.querySelectorAll('.reviewer-only').forEach(el => {
      el.style.display = 'block'
    })
  }
  
  // Auditor features (read-only)
  if (hasPermission(permissions, 'audit', 'read')) {
    console.log('âœ“ Auditor access granted')
    document.querySelectorAll('.auditor-only').forEach(el => {
      el.style.display = 'block'
    })
  }
}


  function getInitials(name) {
    if (!name) return 'U';
    const parts = name.trim().split(' ');
    if (parts.length >= 2) {
      return parts[0][0] + parts[parts.length - 1][0];
    }
    return name[0].toUpperCase();
  }

  async function updateUserUI() {
    try {
      const { data: { session } } = await sb.auth.getSession();
      
      if (session && session.user) {
        // User is logged in - show user menu
        if (loginLink) loginLink.style.display = 'none';
        if (userMenu) userMenu.style.display = 'inline-block';
        
        if (userBadge) {
          const displayName = session.user.user_metadata?.full_name || session.user.email.split('@')[0];
          userBadge.textContent = getInitials(displayName);
        }
        
        // Save to localStorage
        localStorage.setItem('valqmsUser', JSON.stringify({
          email: session.user.email,
          name: session.user.user_metadata?.full_name || session.user.email.split('@')[0],
          picture: session.user.user_metadata?.avatar_url,
          loggedIn: true,
          provider: session.user.app_metadata?.provider || 'email',
          timestamp: Date.now()
        }));
      } else {
        // No session - show login button
        if (userMenu) userMenu.style.display = 'none';
        if (loginLink) loginLink.style.display = 'inline-block';
        localStorage.removeItem('valqmsUser');
      }
    } catch (error) {
      console.error('Error checking auth:', error);
      if (userMenu) userMenu.style.display = 'none';
      if (loginLink) loginLink.style.display = 'inline-block';
    }
  }

// ============================================
// PERMISSION-BASED NAVIGATION CONTROL
// ============================================

// Load user's feature permissions from database
async function loadUserPermissions() {
    try {
        const { data: { session } } = await sb.auth.getSession()
        
        if (!session) {
            console.log('No session - permissions not loaded')
            return {}
        }

        console.log('ðŸ” Loading permissions for:', session.user.email)

        // Get user's role ID
        const { data: userRole, error: roleError } = await sb
            .from('user_roles')
            .select('role_id')
            .eq('user_id', session.user.id)
            .eq('is_active', true)
            .maybeSingle()

        if (roleError || !userRole) {
            console.log('No role found for user')
            return {}
        }

        console.log('User role ID:', userRole.role_id)

        // Get permissions for this role
        const { data: permissions, error: permError } = await sb
            .from('role_permissions')
            .select(`
                can_view,
                features!inner (
                    feature_key,
                    feature_name
                )
            `)
            .eq('role_id', userRole.role_id)
            .eq('can_view', true)

        if (permError) {
            console.error('Error loading permissions:', permError)
            return {}
        }

        console.log('âœ… Permissions loaded:', permissions)

        // Convert to lookup map
        const permMap = {}
        permissions.forEach(perm => {
            if (perm.features) {
                permMap[perm.features.feature_key] = true
                console.log(`  âœ“ ${perm.features.feature_name}`)
            }
        })

        return permMap

    } catch (error) {
        console.error('Exception loading permissions:', error)
        return {}
    }
}

// Apply permissions - hide navigation items user shouldn't see
async function applyNavigationPermissions() {
    console.log('ðŸ”’ Applying navigation permissions...')
    
    const permissions = await loadUserPermissions()
    
    if (Object.keys(permissions).length === 0) {
        console.log('âš ï¸ No permissions loaded - showing all by default')
        return
    }

    console.log('ðŸ“‹ Permission map:', permissions)

    // Get all navigation links
    const nav = document.querySelector('#mainNav')
    if (!nav) {
        console.log('âš ï¸ Navigation not found')
        return
    }

    const navLinks = nav.querySelectorAll('a')
    
    console.log(`Found ${navLinks.length} navigation links`)

    // Check each link and hide if no permission
    navLinks.forEach(link => {
        const linkText = link.textContent.trim()
        const href = link.getAttribute('href')
        
        // Map link text to feature keys
        let featureKey = null
        let shouldShow = true
        
        if (linkText.includes('Smart Tools') || href === '#tools') {
            featureKey = 'smart_tools'
            shouldShow = permissions.smart_tools
        }
        else if (linkText.includes('QMS Applications') || href === '#qms') {
            featureKey = 'qms_applications'
            shouldShow = permissions.qms_applications
        }
        else if (linkText.includes('QMS Procedures') || href === '#QMS Procedures') {
            featureKey = 'qms_procedures'
            shouldShow = permissions.qms_procedures
        }
        else if (linkText.includes('GxP') || linkText.includes('Validation') || href === '#validation') {
            featureKey = 'gxp_validation'
            shouldShow = permissions.gxp_validation
        }
        else if (linkText.includes('Academy') || href === '#ValQMS Academy') {
            featureKey = 'valqms_academy'
            shouldShow = permissions.valqms_academy
        }
        else if (linkText.includes('Resources') || href === '#resources') {
            featureKey = 'resources'
            shouldShow = permissions.resources
        }
        else if (linkText.includes('About') || href === '#about') {
            featureKey = 'about'
            shouldShow = permissions.about
        }
        else if (linkText.includes('Manage Users') || href === 'admin-users.html') {
            featureKey = 'manage_users'
            shouldShow = permissions.manage_users
        }
        
        if (featureKey) {
            if (!shouldShow) {
                link.style.display = 'none'
                console.log(`âŒ Hiding: ${linkText} (no permission for ${featureKey})`)
            } else {
                // Force show with inline-block to override hidden classes
                link.style.display = 'inline-block'
                link.style.visibility = 'visible'
                console.log(`âœ… Showing: ${linkText}`)
            }
        }
    })

    // IMPORTANT: Handle admin-only class elements separately
    if (permissions.manage_users) {
        // Show all admin-only elements
        document.querySelectorAll('.admin-only').forEach(el => {
            el.style.display = 'inline-block'
            el.style.visibility = 'visible'
            console.log('âœ… Showing admin-only element:', el.textContent?.trim())
        })
    } else {
        // Hide all admin-only elements
        document.querySelectorAll('.admin-only').forEach(el => {
            el.style.display = 'none'
            console.log('âŒ Hiding admin-only element:', el.textContent?.trim())
        })
    }

    // Hide section content if no permission
    if (!permissions.smart_tools) {
        const toolsSection = document.querySelector('#tools')
        if (toolsSection) toolsSection.style.display = 'none'
    }
    if (!permissions.qms_applications) {
        const qmsSection = document.querySelector('#qms')
        if (qmsSection) qmsSection.style.display = 'none'
    }
    if (!permissions.qms_procedures) {
        const proceduresSection = document.querySelector('#QMS\\ Procedures')
        if (proceduresSection) proceduresSection.style.display = 'none'
    }
    if (!permissions.gxp_validation) {
        const validationSection = document.querySelector('#validation')
        if (validationSection) validationSection.style.display = 'none'
    }
    if (!permissions.valqms_academy) {
        const academySection = document.querySelector('#ValQMS\\ Academy')
        if (academySection) academySection.style.display = 'none'
    }
    if (!permissions.resources) {
        const resourcesSection = document.querySelector('#resources')
        if (resourcesSection) resourcesSection.style.display = 'none'
    }
    if (!permissions.about) {
        const aboutSection = document.querySelector('#about')
        if (aboutSection) aboutSection.style.display = 'none'
    }

    console.log('âœ… Permissions applied successfully')
}


// Call permissions after user UI is updated
window.addEventListener('load', async () => {
    await updateUserUI()
    await applyNavigationPermissions()
})

  // Initialize user UI
  updateUserUI();

  // Toggle user dropdown
  if (userBadge && userDropdown) {
    userBadge.addEventListener('click', (e) => {
      e.stopPropagation();
      userDropdown.classList.toggle('active');
      if (brandDropdown) brandDropdown.classList.remove('active');
    });

    userDropdown.addEventListener('click', e => e.stopPropagation());
  }

  // Open profile panel
  if (profileBtn) {
    profileBtn.addEventListener('click', async (e) => {
      e.preventDefault();
      e.stopPropagation();
      if (userDropdown) userDropdown.classList.remove('active');
      if (profilePanel) profilePanel.style.display = 'block';
      await loadProfile();
    });
  }

  // Logout functionality
  if (logoutBtn) {
    logoutBtn.addEventListener('click', async (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      try {
        await sb.auth.signOut();
        localStorage.removeItem('valqmsUser');
        
        if (userDropdown) userDropdown.classList.remove('active');
        if (userMenu) userMenu.style.display = 'none';
        if (loginLink) loginLink.style.display = 'inline-block';
        if (userBadge) userBadge.textContent = 'U';
        
        alert('You have been logged out successfully');
        setTimeout(() => window.location.href = 'login.html', 500);
      } catch (error) {
        console.error('Logout error:', error);
        alert('Logout failed. Please try again.');
      }
    });
  }

  // Profile panel functions
  const profileMsg = document.getElementById('profileMsg');
  const closeProfileBtn = document.getElementById('closeProfileBtn');
  const saveProfileBtn = document.getElementById('saveProfileBtn');

  async function loadProfile() {
    if (!profileMsg) return;
    profileMsg.textContent = 'Loading...';
    profileMsg.style.color = 'var(--text-dim)';
    
    try {
      const { data: { session } } = await sb.auth.getSession();
      if (!session) throw new Error('Not authenticated');
      
      const user = session.user;
      
      let { data: profile, error: fetchError } = await sb
        .from('user_profiles')
        .select('full_name, email, phone')
        .eq('id', user.id)
        .single();

      if (fetchError && fetchError.code !== 'PGRST116') {
        throw fetchError;
      }

      let profileData = profile;

      if (!profileData) {
        const insertData = {
          id: user.id,
          email: user.email,
          full_name: user.user_metadata?.full_name || user.email.split('@')[0] || '',
          phone: ''
        };

        const { data: created, error: insertError } = await sb
          .from('user_profiles')
          .insert(insertData)
          .select('full_name, email, phone')
          .single();

        if (insertError) throw insertError;
        profileData = created;
      }

      const fullNameInput = document.getElementById('pf_full_name');
      const emailInput = document.getElementById('pf_email');
      const phoneInput = document.getElementById('pf_phone');

      if (fullNameInput) fullNameInput.value = profileData.full_name || '';
      if (emailInput) emailInput.value = profileData.email || user.email;
      if (phoneInput) phoneInput.value = profileData.phone || '';

      // Update avatar
      const profileAvatar = document.getElementById('profileAvatar');
      if (profileAvatar && profileData.full_name) {
        profileAvatar.textContent = getInitials(profileData.full_name);
      }

      profileMsg.textContent = '';
    } catch (error) {
      console.error('Load profile error:', error);
      profileMsg.style.color = '#f87171';
      profileMsg.textContent = 'Error loading profile: ' + error.message;
    }
  }

  async function saveProfile() {
    if (!profileMsg) return;
    profileMsg.textContent = 'Saving...';
    profileMsg.style.color = 'var(--text-dim)';
    
    try {
      const { data: { session } } = await sb.auth.getSession();
      if (!session) throw new Error('Not authenticated');
      
      const user = session.user;
      const fullName = document.getElementById('pf_full_name')?.value.trim() || '';
      const phone = document.getElementById('pf_phone')?.value.trim() || '';
      const email = document.getElementById('pf_email')?.value.trim() || user.email;

      const updates = {
        id: user.id,
        full_name: fullName || null,
        phone: phone || null,
        email,
        updated_at: new Date().toISOString()
      };

      const { error } = await sb
        .from('user_profiles')
        .upsert(updates, { onConflict: 'id' });

      if (error) throw error;

      // Update localStorage
      const userData = JSON.parse(localStorage.getItem('valqmsUser') || '{}');
      userData.name = fullName;
      userData.phone = phone;
      localStorage.setItem('valqmsUser', JSON.stringify(userData));

      // Update UI
      if (userBadge) {
        userBadge.textContent = getInitials(fullName);
      }

      profileMsg.style.color = 'var(--accent)';
      profileMsg.textContent = 'âœ“ Profile updated successfully!';
      
      setTimeout(() => {
        if (profilePanel) profilePanel.style.display = 'none';
        profileMsg.textContent = '';
      }, 1500);
    } catch (error) {
      console.error('Save profile error:', error);
      profileMsg.style.color = '#f87171';
      profileMsg.textContent = 'Save failed: ' + error.message;
    }
  }

  if (saveProfileBtn) {
    saveProfileBtn.addEventListener('click', saveProfile);
  }

  if (closeProfileBtn) {
    closeProfileBtn.addEventListener('click', () => {
      if (profilePanel) profilePanel.style.display = 'none';
    });
  }

  // Close profile panel on backdrop click
  if (profilePanel) {
    profilePanel.addEventListener('click', (e) => {
      if (e.target === profilePanel) {
        profilePanel.style.display = 'none';
      }
    });
  }

  // Auth state listener
  sb.auth.onAuthStateChange((event, session) => {
    console.log('Auth state changed:', event);
    
    if (event === 'SIGNED_IN' && session) {
      localStorage.setItem('valqmsUser', JSON.stringify({
        email: session.user.email,
        name: session.user.user_metadata?.full_name || session.user.email.split('@')[0],
        picture: session.user.user_metadata?.avatar_url,
        loggedIn: true,
        provider: session.user.app_metadata?.provider || 'email',
        timestamp: Date.now()
      }));
      updateUserUI();
    } else if (event === 'SIGNED_OUT') {
      localStorage.removeItem('valqmsUser');
      if (userMenu) userMenu.style.display = 'none';
      if (loginLink) loginLink.style.display = 'inline-block';
      if (userBadge) userBadge.textContent = 'U';
    }
  });



// ========================================
// RAZORPAY PAYMENT INTEGRATION WITH SUPABASE
// ========================================
const RAZORPAY_KEY_ID = 'rzp_test_RWogQofYpuwRHW'; // TODO: Replace with your Razorpay Key ID

// Course icons (matching your app-card style)
const courseIcons = {
  'cleaning-validation-fundamentals': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="12" width="16" height="8" rx="2"/><path d="M8 12V8a4 4 0 018 0v4"/><path d="M12 16v-4"/></svg>`, // Cleaning
  'csv-masterclass': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="16" rx="2"/><path d="M3 10h18"/><path d="M8 14h2v2H8z"/><path d="M14 14h2v2h-2z"/></svg>`, // Spreadsheet
  'equipment-qualification-essentials': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="4" width="16" height="16" rx="2"/><path d="M9 9h6v6H9z"/><path d="M4 20l16-16"/></svg>`, // Equipment
  'process-validation-cpv': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/><path d="M16 16l2 2"/></svg>`, // Process
  'validation-lifecycle-cloud': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 18v-2a4 4 0 014-4h4a4 4 0 014 4v2"/><circle cx="12" cy="8" r="4"/><path d="M16 4l2-2"/></svg>`, // Cloud
  'risk-based-validation': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 2 22 22 22 12 2"/><circle cx="12" cy="17" r="1"/><path d="M12 8l4 8"/></svg>`, // Risk
  'qms-pharma': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M7 7h10v10H7z"/><path d="M12 3v18"/></svg>`, // QMS
  'change-control-deviation': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20"/><path d="M5 12h14"/><circle cx="12" cy="12" r="3"/></svg>`, // Change
  'capa-rca': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 8v4l3 3"/><path d="M9 15l3-3"/></svg>`, // CAPA
  'data-integrity-alcoa': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="4" width="16" height="16" rx="2"/><path d="M8 8h8v8H8z"/><path d="M4 4l16 16"/></svg>`, // Data
  'annex-11-21cfr11': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/><path d="M8 12l-4 2"/></svg>`, // Regulatory
  'audit-inspection-readiness': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="4" width="16" height="16" rx="2"/><path d="M8 8h8v8H8z"/><circle cx="16" cy="8" r="2"/></svg>`, // Audit
  'electronic-signatures-audit-trails': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 8v8M8 8v8"/><rect x="4" y="4" width="16" height="16" rx="2"/><path d="M12 12l4 4"/></svg>`, // eSign
  'ai-csa': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/><path d="M16 16l2-2"/></svg>`, // AI
  'automated-test-csv': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M7 7h10v10H7z"/><path d="M12 12l6 6"/></svg>`, // Automation
  'digital-transformation-validation': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20"/><path d="M5 12h14"/><circle cx="12" cy="12" r="3"/></svg>`, // Digital
  'valqms-unlimited-subscription': `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/><path d="M8 12l-4 2"/><path d="M12 12l0 6"/></svg>` // Subscription
};

const courseGradients = {
  'csv-masterclass': 'linear-gradient(135deg, #3b82f6, #60a5fa)',
  'equipment-qualification-essentials': 'linear-gradient(135deg, #8b5cf6, #a78bfa)',
  'process-validation-cpv': 'linear-gradient(135deg, #10b981, #34d399)',
  'validation-lifecycle-cloud': 'linear-gradient(135deg, #06b6d4, #22d3ee)',
  'risk-based-validation': 'linear-gradient(135deg, #f59e0b, #f97316)',
  'qms-pharma': 'linear-gradient(135deg, #6366f1, #818cf8)',
  'change-control-deviation': 'linear-gradient(135deg, #14b8a6, #2dd4bf)',
  'capa-rca': 'linear-gradient(135deg, #ec4899, #f472b6)',
  'data-integrity-alcoa': 'linear-gradient(135deg, #eab308, #facc15)',
  'annex-11-21cfr11': 'linear-gradient(135deg, #8b5cf6, #a78bfa)',
  'audit-inspection-readiness': 'linear-gradient(135deg, #ef4444, #f87171)',
  'electronic-signatures-audit-trails': 'linear-gradient(135deg, #10b981, #34d399)',
  'ai-csa': 'linear-gradient(135deg, #f59e0b, #f97316)',
  'automated-test-csv': 'linear-gradient(135deg, #3b82f6, #60a5fa)',
  'digital-transformation-validation': 'linear-gradient(135deg, #06b6d4, #22d3ee)',
  'valqms-unlimited-subscription': 'linear-gradient(135deg, #06b6d4, #22d3ee)'
};

// QMS Procedure Icons - FIXED TO MATCH YOUR SUPABASE SLUGS
const qmsIcons = {
  'change-control': `<div style="font-size: 40px; line-height: 1;">ðŸ“‹</div>`,
  'document-management': `<div style="font-size: 40px; line-height: 1;">ðŸ“„</div>`,  // Fixed
  'complaint-management': `<div style="font-size: 40px; line-height: 1;">ðŸ“ž</div>`,  // Fixed
  'non-conformance-management': `<div style="font-size: 40px; line-height: 1;">âŒ</div>`,  // Fixed
  'audit-inspection': `<div style="font-size: 40px; line-height: 1;">ðŸ”</div>`,  // Fixed
  'risk-management': `<div style="font-size: 40px; line-height: 1;">âš ï¸</div>`,  // Fixed
  'productlifecycle-management': `<div style="font-size: 40px; line-height: 1;">ðŸ”„</div>`,  // Fixed
  'deviation-management': `<div style="font-size: 40px; line-height: 1;">ðŸ“Š</div>`,  // Fixed
  'capa-management': `<div style="font-size: 40px; line-height: 1;">ðŸŽ¯</div>`,  // Fixed
  'supplier-management': `<div style="font-size: 40px; line-height: 1;">ðŸ­</div>`,  // Fixed
  'training-management': `<div style="font-size: 40px; line-height: 1;">ðŸŽ“</div>`,  // Added
  'validation-management': `<div style="font-size: 40px; line-height: 1;">âœ…</div>`,  // Added
  'defect-management': `<div style="font-size: 40px; line-height: 1;">ðŸ›</div>`  // Added
};

const qmsGradients = {
  'change-control': 'linear-gradient(135deg, #10b981, #34d399)',
  'document-management': 'linear-gradient(135deg, #8b5cf6, #a78bfa)',
  'complaint-management': 'linear-gradient(135deg, #f59e0b, #fb923c)',
  'non-conformance-management': 'linear-gradient(135deg, #dc2626, #ef4444)',
  'audit-inspection': 'linear-gradient(135deg, #ec4899, #f472b6)',
  'risk-management': 'linear-gradient(135deg, #f97316, #fb923c)',
  'productlifecycle-management': 'linear-gradient(135deg, #0ea5e9, #38bdf8)',
  'deviation-management': 'linear-gradient(135deg, #ef4444, #f87171)',
  'capa-management': 'linear-gradient(135deg, #3b82f6, #60a5fa)',
  'supplier-management': 'linear-gradient(135deg, #06b6d4, #22d3ee)',
  'training-management': 'linear-gradient(135deg, #10b981, #34d399)',
  'validation-management': 'linear-gradient(135deg, #6366f1, #818cf8)',
  'defect-management': 'linear-gradient(135deg, #ef4444, #f87171)'
};



// Render courses from Supabase
async function renderCourses() {
  const grid = document.getElementById('coursesGrid');
  const filters = document.getElementById('academyFilters');
  if (!grid || !filters) return;

  try {
    // Fetch products from Supabase (include category)
    const { data: products, error } = await sb
      .from('products')
      .select('*')
      .eq('active', true)
      .neq('type', 'procedure')
      .order('type', { ascending: false });

    if (error) throw error;

    // Define fixed category mapping and labels
    const CATEGORY_MAP = {
      'Validation & Qualification': {
        slugs: [
          'csv-masterclass',
          'equipment-qualification-essentials',
          'process-validation-cpv',
          'validation-lifecycle-cloud',
          'risk-based-validation'
        ],
        label: 'Validation & Qualification',
        desc: 'Master the complete validation lifecycle from URS to PQ.'
      },
      'Quality & Compliance Management': {
        slugs: [
          'qms-pharma',
          'change-control-deviation',
          'capa-rca',
          'data-integrity-alcoa'
        ],
        label: 'Quality & Compliance Management',
        desc: 'Build a culture of quality, traceability, and regulatory compliance.'
      },
      'Regulatory & Inspection Readiness': {
        slugs: [
          'annex-11-21cfr11',
          'audit-inspection-readiness',
          'electronic-signatures-audit-trails'
        ],
        label: 'Regulatory & Inspection Readiness',
        desc: 'Stay audit-ready with a deep understanding of FDA, EMA, and MHRA expectations.'
      },
      'Digital Transformation & Automation': {
        slugs: [
          'ai-csa',
          'automated-test-csv',
          'digital-transformation-validation'
        ],
        label: 'Digital Transformation & Automation',
        desc: 'Embrace the future of validation with AI, RPA, and digital QMS solutions.'
      },
      'Membership & Learning Access': {
        slugs: [
          'valqms-unlimited-subscription'
        ],
        label: 'Membership & Learning Access',
        desc: 'Unlock all courses, future updates, and exclusive live sessions.'
      }
    };

    // Map product slugs to categories
    function getCategoryForSlug(slug) {
      for (const [cat, obj] of Object.entries(CATEGORY_MAP)) {
        if (obj.slugs.includes(slug)) return cat;
      }
      return 'Other';
    }

    // Render filter buttons (fixed order)
    const FILTERS = [
  { key: 'all', label: 'All' },
  { key: 'Validation & Qualification', label: 'Validation & Qualification' },
  { key: 'Quality & Compliance Management', label: 'Quality & Compliance' },
  { key: 'Regulatory & Inspection Readiness', label: 'Regulatory & Inspection' },
  { key: 'Digital Transformation & Automation', label: 'Digital Transformation' },
  { key: 'Membership & Learning Access', label: 'Subscription' }
    ];
    filters.innerHTML = '';
    FILTERS.forEach(f => {
      filters.innerHTML += `<button class="pill-btn${f.key === 'all' ? ' active' : ''}" data-filter="${f.key}">${f.label}</button>`;
    });

    // Filtering logic

    // Show only one row by default, reveal all on button click
    let showAll = false;
    let lastFiltered = [];
    const showAllBtn = document.getElementById('showAllCoursesBtn');

    function getTilesPerRow() {
      // Try to get the computed number of columns from the grid
      const gridStyles = window.getComputedStyle(grid);
      const colCount = gridStyles.gridTemplateColumns.split(' ').length;
      return colCount;
    }

    function renderFilteredCourses(selectedCat) {
      grid.innerHTML = '';
      let filtered = selectedCat === 'all'
        ? products
        : products.filter(p => getCategoryForSlug(p.slug) === selectedCat);
      lastFiltered = filtered;
      let tilesPerRow = getTilesPerRow();
      let toShow = showAll ? filtered : filtered.slice(0, tilesPerRow);
      toShow.forEach(product => {
        const priceInRupees = product.price_in_paise / 100;
        const iconKey = product.slug;
        const isSubscription = product.type === 'subscription';
        const priceDisplay = isSubscription ? `â‚¹${priceInRupees}/month` : `â‚¹${priceInRupees}`;
        const fallbackIcon = `<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 8v4l3 3"/></svg>`;
        const fallbackGradient = 'linear-gradient(135deg, #8b5cf6, #a78bfa)';
        grid.innerHTML += `
          <div class="app-card" data-slug="${product.slug}" style="position: relative;">
            <div class="premium-ribbon"><span>Premium</span></div>
            <div class="app-icon" style="background: ${courseGradients[iconKey] || fallbackGradient};">
              ${courseIcons[iconKey] || fallbackIcon}
            </div>
            <h4>${product.title}</h4>
            <p>${product.description || ''}</p>
            <div class="price-tag hidden">${priceDisplay}</div>
            <div class="app-badge">Course</div>
            <div style="margin-top: 14px; display: flex; gap: 8px;">
              <button onclick="previewCourse('${product.slug}');" style="flex: 1; min-width: 85px; padding: 10px 14px; border: none; border-radius: 8px; background: linear-gradient(135deg, var(--accent), var(--accent-bright)); color: #000; font-size: 14px; cursor: pointer; transition: all 0.3s;">
                <span>Preview</span>
              </button>
              <button onclick="${isSubscription ? 'subscribe' : 'buyCourse'}('${product.slug}');" style="flex: 1; min-width: 85px; padding: 10px 14px; border: none; border-radius: 8px; background: linear-gradient(135deg, var(--accent), var(--accent-bright)); color: #000; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.3s;" data-slug="${product.slug}" data-intent="purchase">
                <span>${isSubscription ? 'Subscribe' : 'Buy'}</span>
              </button>
            </div>
          </div>
        `;

      });

      // Show/hide Show All/Hide button
      if (filtered.length > tilesPerRow) {
        showAllBtn.style.display = '';
        showAllBtn.textContent = showAll ? 'Hide' : 'Show All';
      } else {
        showAllBtn.style.display = 'none';
      }
    }

    // Initial render
    renderFilteredCourses('all');

    // Add event listeners to filter buttons
    filters.querySelectorAll('button').forEach(btn => {
      btn.addEventListener('click', () => {
        filters.querySelectorAll('button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        showAll = false;
        renderFilteredCourses(btn.dataset.filter);
      });
    });

    // Show All/Hide button logic
    showAllBtn.onclick = function() {
      showAll = !showAll;
      renderFilteredCourses(filters.querySelector('button.active').dataset.filter);
    };

  } catch (error) {
    console.error('Error loading courses:', error);
    grid.innerHTML = '<p style="color: var(--text-dim); text-align: center;">Error loading courses. Please refresh.</p>';
  }
}

// Render QMS Procedures with Purchase Status Check - ENHANCED DEBUG
async function renderQMSProcedures() {
  const grid = document.getElementById('qmsProceduresGrid');
  const showAllBtn = document.getElementById('showAllQMSBtn');
  if (!grid) return;
  let showAll = false;
  let lastProducts = [];
  function getTilesPerRow() {
    const gridStyles = window.getComputedStyle(grid);
    const colCount = gridStyles.gridTemplateColumns.split(' ').length;
    return colCount;
  }
  function renderProcedures(products, purchasedSlugs) {
    grid.innerHTML = '';
    let tilesPerRow = getTilesPerRow();
    let toShow;
    if (showAll) {
      toShow = [...products, {isDefect: true}];
    } else {
      // Only one row: fill with products, last tile is always Defect Management
      toShow = products.slice(0, tilesPerRow - 1);
      toShow.push({isDefect: true});
    }
    toShow.forEach(product => {
      if (product.isDefect) {
        grid.innerHTML += `
          <div class="app-card is-premium" style="position: relative; overflow: hidden;" data-slug="defect-management-sop">
            <div class="premium-ribbon"><span>Premium</span></div>
            <div class="app-icon" style="background: linear-gradient(135deg, #ef4444, #f87171);">
              <div style="font-size: 40px; line-height: 1;">ðŸ›</div>
            </div>
            <h4>Defect Management</h4>
            <p>Manage the complete defect lifecycle from discovery through investigation, correction, and verification with GMP compliance</p>
            <div class="price-tag hidden">â‚¹299</div>
            <div class="app-badge" style="background: linear-gradient(135deg, #ef4444, #f87171)">SOP</div>
            <div style="margin-top: 14px;">
              <button onclick="buyProcedureDefect('defect-management-sop', 29900, 'Defect Management SOP');" style="width: 100%; padding: 10px 14px; border: none; border-radius: 8px; background: linear-gradient(135deg, var(--accent), var(--accent-bright)); color: #000; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.3s;" data-slug="defect-management-sop" data-intent="purchase">
                <span>Buy Now</span>
              </button>
            </div>
          </div>
        `;
      } else {
        const priceInRupees = product.price_in_paise / 100;
        const isFree = product.price_in_paise === 0;
        const isPurchased = purchasedSlugs.includes(product.slug);
        const iconKey = product.slug.replace('-sop', '');
        const fileName = product.slug === 'change-control-sop' ? 'change-control-sop.html' : `${product.slug}.html`;
        grid.innerHTML += `
          <div class="app-card ${(!isFree && !isPurchased) ? 'is-premium' : ''}" style="position: relative; overflow: hidden;" data-slug="${product.slug}">
            ${!isFree && !isPurchased ? `<div class="premium-ribbon"><span>Premium</span></div>` : ''}
            <div class="app-icon" style="background: ${qmsGradients[iconKey] || 'linear-gradient(135deg, #8b5cf6, #a78bfa)'};">
              ${qmsIcons[iconKey] || qmsIcons['document-management']}
            </div>
            <h4>${product.title}</h4>
            <p>${product.description || ''}</p>
            <div class="price-tag ${isFree || isPurchased ? '' : 'hidden'}">${isFree ? 'FREE' : (isPurchased ? 'PURCHASED' : 'â‚¹' + priceInRupees)}</div>
            <div class="app-badge" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa)">SOP</div>
            <div style="margin-top: 14px;">
              ${isFree || isPurchased ? 
                  `<button onclick="accessSOP('${fileName}')" style="width: 100%; padding: 10px 14px; border: none; border-radius: 8px; background: linear-gradient(135deg, #10b981, #34d399); color: #000; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.3s;">
                    <span>Access Now</span>
                  </button>` :
                  `<button onclick="buyProcedure('${product.slug}');" style="width: 100%; padding: 10px 14px; border: none; border-radius: 8px; background: linear-gradient(135deg, var(--accent), var(--accent-bright)); color: #000; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.3s;" data-slug="${product.slug}" data-intent="purchase">
                    <span>Buy Now</span>
                  </button>`
                }
// Access SOP with login check
async function accessSOP(fileName) {
  // Use the same Supabase client as the rest of the page
  try {
    const { data: { session } } = await sb.auth.getSession();
    if (session && session.user) {
      window.location.href = fileName;
    } else {
      // Show login modal or access modal if not logged in
      if (typeof openModal === 'function' && typeof loginModal !== 'undefined') {
        openModal(loginModal);
      } else if (typeof accessModal !== 'undefined') {
        accessModal.style.display = 'flex';
      } else {
        alert('Please log in to access this SOP.');
      }
    }
  } catch (e) {
    alert('Please log in to access this SOP.');
  }
}
            </div>
          </div>
        `;
      }
    });
    // Show/hide Show All/Hide button (include Defect Management card)
    if ((products.length + 1) > tilesPerRow) {
      showAllBtn.style.display = '';
      showAllBtn.textContent = showAll ? 'Hide' : 'Show All';
    } else {
      showAllBtn.style.display = 'none';
    }
  }
  try {
    // Get user session
    const { data: { session } } = await sb.auth.getSession();
    console.log('ðŸ” Current user ID:', session?.user?.id);
    console.log('ðŸ” Current user email:', session?.user?.email);
    
    // Fetch procedures
    const { data: products, error } = await sb
      .from('products')
      .select('*')
      .eq('type', 'procedure')
      .eq('active', true)
      .order('price_in_paise', { ascending: true });
    
    if (error) throw error;
    
    // Get user's purchases if logged in
    let purchasedSlugs = [];
    if (session) {
      // DETAILED DEBUG QUERY
      const { data: allPurchases, error: allPurchasesError } = await sb
        .from('purchases')
        .select('*')
        .eq('user_id', session.user.id);
      
      console.log('ðŸ” ALL user purchases (any status):', allPurchases);
      
      const { data: purchases, error: purchaseError } = await sb
        .from('purchases')
        .select('product_slug, status, created_at')
        .eq('user_id', session.user.id)
        .eq('status', 'paid');
      
      console.log('ðŸ” PAID purchases:', purchases);
      console.log('ðŸ” Purchase error:', purchaseError);
      
      if (!purchaseError && purchases) {
        purchasedSlugs = purchases.map(p => p.product_slug);
        console.log('âœ… Purchased procedures:', purchasedSlugs);
      } else {
        console.log('âš ï¸ No purchases found or error:', purchaseError);
      }
    }
    
    renderProcedures(products, purchasedSlugs);
    lastProducts = products;
    // Show All/Hide button logic
    showAllBtn.onclick = function() {
      showAll = !showAll;
      renderProcedures(lastProducts, purchasedSlugs);
    };
  } catch (error) {
    console.error('Error loading QMS procedures:', error);
  }
}



async function loadMyPurchases() {
  const myCoursesList = document.getElementById('myCoursesList');
  
  if (!myCoursesList) {
    console.log('myCoursesList element not found');
    return;
  }

  try {
    // Check if user is logged in
    const { data: { session }, error: sessionError } = await sb.auth.getSession();
    
    if (sessionError) {
      console.error('Session error:', sessionError);
      throw sessionError;
    }
    
    if (!session) {
      console.log('No session - user not logged in');
      myCoursesList.classList.add('empty-state');
      myCoursesList.innerHTML = 'Please login to see your courses.';
      return;
    }

    console.log('User logged in:', session.user.email);

    // Get purchases
    const { data: purchases, error: purchasesError } = await sb
      .from('purchases')
      .select('product_slug, created_at')
      .eq('user_id', session.user.id)
      .eq('status', 'paid')
      .order('created_at', { ascending: false });

    if (purchasesError) {
      console.error('Database error:', purchasesError);
      throw purchasesError;
    }

    console.log('All purchases:', purchases);

    if (!purchases || purchases.length === 0) {
      myCoursesList.classList.add('empty-state');
      myCoursesList.innerHTML = 'No purchased courses yet. Start learning today!';
      return;
    }

    // Filter out SOPs (products ending with -sop)
    const coursePurchases = purchases.filter(p => !p.product_slug.endsWith('-sop'));
    
    console.log('Filtered course purchases:', coursePurchases);

    if (coursePurchases.length === 0) {
      myCoursesList.classList.add('empty-state');
      myCoursesList.innerHTML = 'No purchased courses yet. Start learning today!';
      return;
    }

    // Render purchased courses
    myCoursesList.classList.remove('empty-state');
    myCoursesList.innerHTML = '';

    coursePurchases.forEach(purchase => {
      const product = courses.find(c => c.id === purchase.product_slug) 
                   || (purchase.product_slug === subscription.id ? subscription : null);
      
      if (product) {
        const badge = document.createElement('span');
        badge.className = 'purchased-course';
        badge.textContent = product.title;
        badge.style.cursor = 'pointer';
        badge.onclick = () => {
          window.location.href = `course-${purchase.product_slug}.html`;
        };
        myCoursesList.appendChild(badge);
      } else {
        console.warn('Product not found for slug:', purchase.product_slug);
      }
    });

  } catch (error) {
    console.error('Error in loadMyPurchases:', error);
    myCoursesList.classList.add('empty-state');
    myCoursesList.innerHTML = 'No purchased courses yet. Start learning today!';
  }
}



// Check if user already purchased a product
async function checkPurchase(productSlug) {
  const { data: { session } } = await sb.auth.getSession();
  if (!session) return false;
  
  const { data, error } = await sb
    .from('purchases')
    .select('id')
    .eq('user_id', session.user.id)
    .eq('product_slug', productSlug)
    .eq('status', 'paid')
    .single();
  
  return !!data;
}



// Open Razorpay Checkout
function openRazorpayCheckout({ amount, name, description, productSlug, purchaseId }) {
  return new Promise((resolve, reject) => {
    const options = {
      key: RAZORPAY_KEY_ID,
      amount: amount, // in paise
      currency: 'INR',
      name: 'ValQMS Academy',
      description: description,
      theme: {
        color: getComputedStyle(document.documentElement).getPropertyValue('--accent').trim() || '#10b981'
      },
      handler: function (response) {
        resolve(response);
      },
      modal: {
        ondismiss: function() {
          reject(new Error('Payment cancelled'));
        }
      },
      prefill: {
        name: sb.auth.getUser().then(u => u.data?.user?.user_metadata?.fullname || ''),
        email: sb.auth.getUser().then(u => u.data?.user?.email || '')
      },
      notes: {
        product_slug: productSlug,
        purchase_id: purchaseId
      }
    };
    
    const rzp = new Razorpay(options);
    rzp.open();
  });
}

// Update purchase record after payment
async function updatePurchaseRecord(purchaseId, paymentData) {
  const { error } = await sb
    .from('purchases')
    .update({
      status: 'paid',
      payment_id: paymentData.razorpay_payment_id,
      order_id: paymentData.razorpay_order_id || null,
      signature: paymentData.razorpay_signature || null,
      updated_at: new Date().toISOString()
    })
    .eq('id', purchaseId);
  
  if (error) throw error;
}

// Grant access after payment
function grantAccess(productTitle) {
  const modal = document.getElementById('paymentModal');
  const message = document.getElementById('paymentMessage');
  
  if (message) {
    message.textContent = `Payment successful! You now have access to "${productTitle}".`;
  }
  
  if (modal) {
    modal.classList.add('active');
  }
  
  // Reload purchases
  loadMyPurchases();
}

// Buy course
window.buyCourse = async function(productSlug) {
  // First click reveals price, second proceeds
  const card = document.querySelector(`.app-card[data-slug="${productSlug}"]`);
  const priceEl = card?.querySelector('.price-tag');
  const btn = card?.querySelector('button[data-intent="purchase"]');
  if (priceEl && priceEl.classList.contains('hidden')) {
    priceEl.classList.remove('hidden');
    if (btn) btn.querySelector('span').textContent = 'Proceed to Pay';
    return;
  }

  const { data: { session } } = await sb.auth.getSession();
  if (!session) {
    alert('Please login to purchase courses');
    window.location.href = 'login.html';
    return;
  }
  
  try {
    // Check if already purchased
    const alreadyPurchased = await checkPurchase(productSlug);
    if (alreadyPurchased) {
      alert('You already own this course!');
      return;
    }
    
    // Get product details
    const { data: product, error: prodError } = await sb
      .from('products')
      .select('*')
      .eq('slug', productSlug)
      .single();
    
    if (prodError) throw prodError;
    
    // Create purchase record
    const purchase = await createOrderRecord(productSlug, product.price_in_paise);
    
    // Open Razorpay
    const payment = await openRazorpayCheckout({
      amount: product.price_in_paise,
      name: product.title,
      description: 'One-time course purchase',
      productSlug: product.slug,
      purchaseId: purchase.id
    });
    
    // Update purchase record
    await updatePurchaseRecord(purchase.id, payment);
    
    // Grant access
    grantAccess(product.title);
    
  } catch (error) {
    console.error('Payment error:', error);
    if (error.message !== 'Payment cancelled') {
      alert('Payment failed. Please try again.');
    }
  }
};

// Subscribe
window.subscribe = async function(productSlug) {
  // First click reveals price, second proceeds
  const card = document.querySelector(`.app-card[data-slug="${productSlug}"]`);
  const priceEl = card?.querySelector('.price-tag');
  const btn = card?.querySelector('button[data-intent="purchase"]');
  if (priceEl && priceEl.classList.contains('hidden')) {
    priceEl.classList.remove('hidden');
    if (btn) btn.querySelector('span').textContent = 'Proceed to Pay';
    return;
  }

  const { data: { session } } = await sb.auth.getSession();
  if (!session) {
    alert('Please login to subscribe');
    window.location.href = 'login.html';
    return;
  }
  
  try {
    // Check if already subscribed
    const alreadyPurchased = await checkPurchase(productSlug);
    if (alreadyPurchased) {
      alert('You already have an active subscription!');
      return;
    }
    
    const { data: product, error: prodError } = await sb
      .from('products')
      .select('*')
      .eq('slug', productSlug)
      .single();
    
    if (prodError) throw prodError;
    
    const purchase = await createOrderRecord(productSlug, product.price_in_paise);
    
    const payment = await openRazorpayCheckout({
      amount: product.price_in_paise,
      name: product.title,
      description: 'Monthly subscription',
      productSlug: product.slug,
      purchaseId: purchase.id
    });
    
    await updatePurchaseRecord(purchase.id, payment);
    grantAccess(product.title);
    
  } catch (error) {
    console.error('Subscription error:', error);
    if (error.message !== 'Payment cancelled') {
      alert('Subscription failed. Please try again.');
    }
  }
};

// ==========================================
// PAYMENT HELPER FUNCTIONS
// ==========================================

// Create order entry in Supabase
async function createOrderRecord(productSlug, amount) {
  const { data: { session } } = await sb.auth.getSession();
  if (!session) throw new Error('Not authenticated');
  
  console.log('ðŸ“¦ Creating order record:', productSlug, amount);
  
  const { data, error } = await sb
    .from('purchases')
    .insert({
      user_id: session.user.id,
      product_slug: productSlug,
      status: 'created',
      amount_paid: amount
    })
    .select()
    .single();
  
  if (error) {
    console.error('âŒ Create order error:', error);
    throw error;
  }
  
  console.log('âœ… Order created:', data.id);
  return data;
}




// Buy QMS Procedure - COMPLETE WITH DEBUGGING
window.buyProcedure = async function(procedureSlug) {
  // First click reveals price, second proceeds
  const card = document.querySelector(`.app-card[data-slug="${procedureSlug}"]`);
  const priceEl = card?.querySelector('.price-tag');
  const btn = card?.querySelector('button[data-intent="purchase"]');
  if (priceEl && priceEl.classList.contains('hidden')) {
    priceEl.classList.remove('hidden');
    if (btn) btn.querySelector('span').textContent = 'Proceed to Pay';
    return;
  }

  const { data: { session } } = await sb.auth.getSession();
  if (!session) {
    alert('Please login to purchase procedures');
    window.location.href = 'login.html';
    return;
  }
  
  try {
    console.log('ðŸ›’ Starting purchase for:', procedureSlug);
    
    // Check if already purchased
    const alreadyPurchased = await checkPurchase(procedureSlug);
    if (alreadyPurchased) {
      alert('You already own this procedure!');
      window.location.href = `${procedureSlug}.html`;
      return;
    }
    
    // Get product details
    const { data: product, error: prodError } = await sb
      .from('products')
      .select('*')
      .eq('slug', procedureSlug)
      .single();
    
    if (prodError) throw prodError;
    console.log('âœ… Product found:', product.title, product.price_in_paise);
    
    // Create purchase record
    const purchase = await createOrderRecord(procedureSlug, product.price_in_paise);
    console.log('âœ… Purchase record created:', purchase.id);
    
    // Open Razorpay checkout
    console.log('ðŸ’³ Opening Razorpay...');
    const payment = await openRazorpayCheckout({
      amount: product.price_in_paise,
      name: product.title,
      description: 'QMS Procedure Purchase',
      productSlug: product.slug,
      purchaseId: purchase.id
    });
    
    console.log('âœ… Payment completed:', payment.razorpay_payment_id);
    
    // Update purchase status to paid
    console.log('ðŸ“ Updating purchase to paid...');
    await updatePurchaseRecord(purchase.id, payment);
    console.log('âœ… Purchase status updated to paid');
    
    // Verify update worked
    const { data: verifyPurchase } = await sb
      .from('purchases')
      .select('status, payment_id')
      .eq('id', purchase.id)
      .single();
    
    console.log('ðŸ” Verification - Status:', verifyPurchase?.status);
    
    if (verifyPurchase?.status !== 'paid') {
      console.error('âš ï¸ WARNING: Status not updated correctly!');
      throw new Error('Payment completed but status not updated');
    }
    
    // Show success
    alert(`âœ… Purchase successful! You now have access to ${product.title}`);
    
    // Reload UI
    await renderQMSProcedures();
    await loadMyPurchases();
    
    // Redirect
    window.location.href = `${procedureSlug}.html`;
    
  } catch (error) {
    console.error('âŒ Purchase error:', error);
    console.error('Error stack:', error.stack);
    
    if (error.message !== 'Payment cancelled') {
      alert(`âŒ Purchase failed: ${error.message}\n\nPlease contact support if payment was deducted.`);
    }
  }
};

// Buy Defect Management SOP (without Supabase product entry)
window.buyProcedureDefect = async function(procedureSlug, priceInPaise, productTitle) {
  // First click reveals price, second proceeds
  const card = document.querySelector(`.app-card[data-slug="${procedureSlug}"]`);
  const priceEl = card?.querySelector('.price-tag');
  const btn = card?.querySelector('button[data-intent="purchase"]');
  if (priceEl && priceEl.classList.contains('hidden')) {
    priceEl.classList.remove('hidden');
    if (btn) btn.querySelector('span').textContent = 'Proceed to Pay';
    return;
  }

  const { data: { session } } = await sb.auth.getSession();
  if (!session) {
    alert('Please login to purchase procedures');
    window.location.href = 'login.html';
    return;
  }
  
  try {
    console.log('ðŸ›’ Starting purchase for:', procedureSlug);
    
    // Check if already purchased
    const alreadyPurchased = await checkPurchase(procedureSlug);
    if (alreadyPurchased) {
      alert('You already own this procedure!');
      window.location.href = `${procedureSlug}.html`;
      return;
    }
    
    // Create purchase record with hardcoded details
    const purchase = await createOrderRecord(procedureSlug, priceInPaise);
    console.log('âœ… Purchase record created:', purchase.id);
    
    // Open Razorpay checkout
    console.log('ðŸ’³ Opening Razorpay...');
    const payment = await openRazorpayCheckout({
      amount: priceInPaise,
      name: productTitle,
      description: 'QMS Procedure Purchase',
      productSlug: procedureSlug,
      purchaseId: purchase.id
    });
    
    console.log('âœ… Payment completed:', payment.razorpay_payment_id);
    
    // Update purchase status to paid
    console.log('ðŸ“ Updating purchase to paid...');
    await updatePurchaseRecord(purchase.id, payment);
    console.log('âœ… Purchase status updated to paid');
    
    // Verify update worked
    const { data: verifyPurchase } = await sb
      .from('purchases')
      .select('status, payment_id')
      .eq('id', purchase.id)
      .single();
    
    console.log('ðŸ” Verification - Status:', verifyPurchase?.status);
    
    if (verifyPurchase?.status !== 'paid') {
      console.error('âš ï¸ WARNING: Status not updated correctly!');
      throw new Error('Payment completed but status not updated');
    }
    
    // Show success
    alert(`âœ… Purchase successful! You now have access to ${productTitle}`);
    
    // Reload UI
    await renderQMSProcedures();
    await loadMyPurchases();
    
    // Redirect
    window.location.href = `${procedureSlug}.html`;
    
  } catch (error) {
    console.error('âŒ Purchase error:', error);
    console.error('Error stack:', error.stack);
    
    if (error.message !== 'Payment cancelled') {
      alert(`âŒ Purchase failed: ${error.message}\n\nPlease contact support if payment was deducted.`);
    }
  }
};

// Preview course
window.previewCourse = function(productSlug) {
  window.location.href = `preview-${productSlug}.html`;
};

// Close payment modal
window.closePaymentModal = function() {
  const modal = document.getElementById('paymentModal');
  if (modal) {
    modal.classList.remove('active');
  }
};

// Initialize courses on page load
renderCourses();
renderQMSProcedures();

// Load purchases if user is logged in
sb.auth.getSession().then(({ data: { session } }) => {
  if (session) {
    loadMyPurchases();
  }
});


</script>

<!-- Payment Success Modal -->
<div id="paymentModal" class="payment-modal">
  <div class="modal-box">
    <div class="success-icon">âœ“</div>
    <h2>Payment Successful!</h2>
    <p id="paymentMessage">Your payment was successful. You now have access to this course.</p>
    <button class="cta" onclick="closePaymentModal()">
      <span>Continue Learning</span>
    </button>
  </div>
</div>

<!-- Book a Demo Modal -->
<div id="bookDemoModal" class="payment-modal">
  <div class="modal-box" style="max-width: 500px; background: #ffffff; color: #0f172a;">
    <button class="modal-close" onclick="closeDemoModal()" style="position: absolute; top: 20px; right: 20px; background: none; border: none; font-size: 28px; cursor: pointer; color: #64748b; line-height: 1;">&times;</button>
    <h2 style="color: #0f172a; margin-bottom: 8px;">ðŸ“… Book a Demo</h2>
    <p style="color: #64748b; margin-bottom: 24px; font-size: 15px;">Schedule a personalized demo with our team</p>
    
    <form id="demoForm" onsubmit="submitDemoRequest(event)" style="text-align: left;">
      <div style="margin-bottom: 16px;">
        <label style="display: block; margin-bottom: 6px; color: #0f172a; font-weight: 600; font-size: 14px;">Full Name *</label>
        <input type="text" id="demoName" required style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 15px; font-family: inherit; background: #ffffff; color: #0f172a;" placeholder="John Doe">
      </div>
      
      <div style="margin-bottom: 16px;">
        <label style="display: block; margin-bottom: 6px; color: #0f172a; font-weight: 600; font-size: 14px;">Work Email *</label>
        <input type="email" id="demoEmail" required style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 15px; font-family: inherit; background: #ffffff; color: #0f172a;" placeholder="you@company.com">
      </div>
      
      <div style="margin-bottom: 16px;">
        <label style="display: block; margin-bottom: 6px; color: #0f172a; font-weight: 600; font-size: 14px;">Company Name *</label>
        <input type="text" id="demoCompany" required style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 15px; font-family: inherit; background: #ffffff; color: #0f172a;" placeholder="Your Company">
      </div>
      
      <div style="margin-bottom: 16px;">
        <label style="display: block; margin-bottom: 6px; color: #0f172a; font-weight: 600; font-size: 14px;">Phone Number</label>
        <input type="tel" id="demoPhone" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 15px; font-family: inherit; background: #ffffff; color: #0f172a;" placeholder="+1 (555) 000-0000">
      </div>
      
      <div style="margin-bottom: 16px;">
        <label style="display: block; margin-bottom: 6px; color: #0f172a; font-weight: 600; font-size: 14px;">Job Title</label>
        <input type="text" id="demoTitle" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 15px; font-family: inherit; background: #ffffff; color: #0f172a;" placeholder="Quality Manager">
      </div>
      
      <div style="margin-bottom: 24px;">
        <label style="display: block; margin-bottom: 6px; color: #0f172a; font-weight: 600; font-size: 14px;">Message</label>
        <textarea id="demoMessage" rows="3" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 15px; font-family: inherit; resize: vertical; background: #ffffff; color: #0f172a;" placeholder="Tell us about your validation needs..."></textarea>
      </div>
      
      <button type="submit" class="cta" style="width: 100%; justify-content: center;">
        <span>Submit Request</span>
      </button>
    </form>
  </div>
</div>

<script>
// Open demo modal
window.openDemoModal = function() {
  document.getElementById('bookDemoModal').classList.add('active');
};

// Close demo modal
window.closeDemoModal = function() {
  document.getElementById('bookDemoModal').classList.remove('active');
};

// Submit demo request
window.submitDemoRequest = async function(event) {
  event.preventDefault();
  
  const formData = {
    name: document.getElementById('demoName').value,
    email: document.getElementById('demoEmail').value,
    company: document.getElementById('demoCompany').value,
    phone: document.getElementById('demoPhone').value || null,
    title: document.getElementById('demoTitle').value || null,
    message: document.getElementById('demoMessage').value || null,
    created_at: new Date().toISOString()
  };
  
  try {
    // Check if user is authenticated
    const { data: { session } } = await sb.auth.getSession();
    
    // Save to Supabase
    const { data, error } = await sb
      .from('demo_requests')
      .insert([formData])
      .select();
    
    if (error) {
      console.error('Supabase error:', error);
      throw error;
    }
    
    console.log('Demo request saved:', data);
    
    // Show success
    alert('âœ… Thank you! Your demo request has been submitted. Our team will contact you within 24 hours.');
    
    // Close modal and reset form
    closeDemoModal();
    document.getElementById('demoForm').reset();
    
  } catch (error) {
    console.error('Error submitting demo request:', error);
    
    // Detailed error message
    let errorMsg = 'âŒ There was an error submitting your request.\n\n';
    if (error.message.includes('relation') || error.message.includes('does not exist')) {
      errorMsg += 'Database table not found. Please contact the administrator.\n\n';
    }
    errorMsg += `Error: ${error.message}\n\nPlease email us directly at support@valqms.com`;
    
    alert(errorMsg);
  }
};
</script>


</body>
</html>
