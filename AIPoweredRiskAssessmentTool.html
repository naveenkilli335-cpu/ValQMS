<!DOCTYPE html>
<html lang="en" data-theme="green">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>AI Risk Assessment Tool ‚Äî ValQMS</title>
  <link rel="icon" href="favicon.jpg?v=5">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    [data-theme="green"]{--accent:#10b981;--accent-bright:#34d399;--accent-dim:rgba(16,185,129,0.1)}
    :root{--bg:#0a0e1a;--surface:#1a1f2e;--border:rgba(255,255,255,0.08);--text:#f8fafc;--text-dim:#94a3b8}
    body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);padding:24px}
    .topbar{max-width:1400px;margin:0 auto 24px;display:flex;justify-content:space-between;align-items:center;padding:16px 24px;background:var(--surface);border:1px solid var(--border);border-radius:16px}
    .logo-container{display:flex;align-items:center;gap:12px;text-decoration:none;color:var(--text)}
    .logo-mark{width:40px;height:40px;background:linear-gradient(135deg,var(--accent),var(--accent-bright));border-radius:10px;display:flex;align-items:center;justify-content:center}
    .logo-mark img{width:100%;height:100%;object-fit:contain;padding:5px}
    .brand-text h1{font-size:20px;font-weight:800;margin:0}
    .brand-text .subtitle{font-size:13px;color:var(--text-dim)}
    .btn-home{padding:8px 16px;background:var(--surface);border:1px solid var(--border);border-radius:10px;color:var(--text-dim);text-decoration:none;font-size:14px;font-weight:600}
    .container{max-width:1400px;margin:0 auto}
    .card{background:var(--surface);padding:24px;border-radius:16px;border:1px solid var(--border);margin-bottom:16px}
    .card h3{font-size:16px;font-weight:700;margin:0 0 12px 0}
    .field{margin-bottom:12px}
    label{display:block;font-size:13px;color:var(--text-dim);margin-bottom:6px;font-weight:600}
    input,textarea,select{width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:var(--surface);color:var(--text);font-size:14px}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 20px;background:var(--accent);color:#fff;border:none;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer}
    .btn:hover{background:var(--accent-bright)}
    .risk-badge{display:inline-block;padding:8px 20px;border-radius:999px;font-size:14px;font-weight:700;margin:8px 0}
    .risk-low{background:rgba(52,211,153,0.2);color:#34d399}
    .risk-medium{background:rgba(250,204,21,0.2);color:#facc15}
    .risk-high{background:rgba(239,68,68,0.2);color:#f87171}
    .result-section{background:rgba(0,0,0,0.3);padding:20px;border-radius:12px;margin-top:16px}
    .result-section h4{margin-bottom:12px;color:var(--accent)}
  </style>
</head>
<body>
  <div class="topbar">
    <div class="brand">
      <a href="index.html" class="logo-container">
        <div class="logo-mark"><img src="favicon.jpg" alt="ValQMS"></div>
        <div class="brand-text">
          <h1>ValQMS Tools</h1>
          <div class="subtitle">AI Risk Assessment (GAMP 5 / ICH Q9)</div>
        </div>
      </a>
    </div>
    <a href="index.html" class="btn-home">‚Üê Home</a>
  </div>

  <div class="container">
    <div class="card">
      <h3>üéØ System Information</h3>
      <div class="field">
        <label>System Name</label>
        <input id="systemName" placeholder="LabWare LIMS">
      </div>
      <div class="field">
        <label>System Category (GAMP 5)</label>
        <select id="gampCategory">
          <option value="3">Category 3: Non-configured product</option>
          <option value="4">Category 4: Configured product</option>
          <option value="5" selected>Category 5: Custom application</option>
        </select>
      </div>
      <div class="field">
        <label>Business Impact if System Fails</label>
        <select id="businessImpact">
          <option>Low - Minor inconvenience</option>
          <option selected>Medium - Significant disruption</option>
          <option>High - Critical business impact</option>
        </select>
      </div>
      <div class="field">
        <label>Does System Handle GxP Data?</label>
        <select id="gxpData">
          <option>No</option>
          <option selected>Yes</option>
        </select>
      </div>
      <div class="field">
        <label>Does System Have Electronic Signatures?</label>
        <select id="eSig">
          <option>No</option>
          <option selected>Yes</option>
        </select>
      </div>
      <div class="field">
        <label>System Complexity</label>
        <select id="complexity">
          <option>Simple - Basic CRUD operations</option>
          <option selected>Moderate - Business logic + integrations</option>
          <option>Complex - Advanced algorithms + multiple integrations</option>
        </select>
      </div>
      <button id="assessRisk" class="btn">
        <span>ü§ñ</span><span>Perform AI Risk Assessment</span>
      </button>
    </div>

    <div class="card" id="resultsCard" style="display:none">
      <h3>üìä Risk Assessment Results</h3>
      <div class="result-section">
        <h4>Overall Risk Level</h4>
        <div id="riskLevel"></div>
      </div>
      <div class="result-section">
        <h4>Recommended Validation Strategy</h4>
        <div id="validationStrategy"></div>
      </div>
      <div class="result-section">
        <h4>Required Test Activities</h4>
        <div id="testActivities"></div>
      </div>
      <div class="result-section">
        <h4>Regulatory Considerations</h4>
        <div id="regulatoryConsiderations"></div>
      </div>
      <button id="exportReport" class="btn" style="margin-top:16px">
        <span>üì•</span><span>Export Risk Assessment Report</span>
      </button>
    </div>
  </div>

  <script>
    function initTheme(){document.documentElement.setAttribute('data-theme',localStorage.getItem('valqmsTheme')||'green')}initTheme();
    let assessmentResult={};
    
    document.getElementById('assessRisk').addEventListener('click',()=>{
      const gamp=parseInt(document.getElementById('gampCategory').value);
      const impact=document.getElementById('businessImpact').value;
      const gxp=document.getElementById('gxpData').value;
      const eSig=document.getElementById('eSig').value;
      const complexity=document.getElementById('complexity').value;
      
      let riskScore=0;
      if(gamp===5)riskScore+=30;else if(gamp===4)riskScore+=20;else riskScore+=10;
      if(impact.includes('High'))riskScore+=30;else if(impact.includes('Medium'))riskScore+=20;else riskScore+=10;
      if(gxp==='Yes')riskScore+=20;
      if(eSig==='Yes')riskScore+=15;
      if(complexity.includes('Complex'))riskScore+=25;else if(complexity.includes('Moderate'))riskScore+=15;else riskScore+=5;
      
      let riskLevel='Low',riskClass='risk-low';
      if(riskScore>=70){riskLevel='High';riskClass='risk-high'}
      else if(riskScore>=40){riskLevel='Medium';riskClass='risk-medium'}
      
      const strategies={
        Low:'Reduced validation: Focus on critical functions only. Vendor testing may be leveraged.',
        Medium:'Standard validation: IQ, OQ, PQ with comprehensive test coverage. Traceability matrix required.',
        High:'Enhanced validation: Full lifecycle validation with extensive testing, independent review, and detailed documentation.'
      };
      
      const activities={
        Low:['Requirements review','Installation verification','Critical function testing','User acceptance'],
        Medium:['Full IQ/OQ/PQ protocols','Requirements traceability','Risk-based testing','Audit trail verification','21 CFR Part 11 compliance'],
        High:['Comprehensive IQ/OQ/PQ','Code review (if custom)','Security testing','Performance testing','Disaster recovery testing','Full regression suite','Independent QA review']
      };
      
      assessmentResult={riskScore,riskLevel,riskClass,strategy:strategies[riskLevel],activities:activities[riskLevel]};
      
      document.getElementById('riskLevel').innerHTML=`<div class="risk-badge ${riskClass}">Risk Level: ${riskLevel} (Score: ${riskScore}/120)</div>`;
      document.getElementById('validationStrategy').innerHTML=`<p style="line-height:1.8">${strategies[riskLevel]}</p>`;
      document.getElementById('testActivities').innerHTML='<ul style="margin-left:20px;line-height:2">'+activities[riskLevel].map(a=>'<li>'+a+'</li>').join('')+'</ul>';
      document.getElementById('regulatoryConsiderations').innerHTML=gxp==='Yes'&&eSig==='Yes'?
        '<p style="line-height:1.8">This system requires compliance with <strong>FDA 21 CFR Part 11</strong> and <strong>EU Annex 11</strong>. Electronic signatures must be validated. Audit trails must be comprehensive and review regularly.</p>':
        '<p style="line-height:1.8">Standard GxP validation requirements apply. Follow GAMP 5 guidelines and ICH Q9 risk management principles.</p>';
      
      document.getElementById('resultsCard').style.display='block';
    });
    
    document.getElementById('exportReport').addEventListener('click',()=>{
      const system=document.getElementById('systemName').value||'System';
      const report=`RISK ASSESSMENT REPORT\nSystem: ${system}\nDate: ${new Date().toLocaleString()}\nCompliance: GAMP 5, ICH Q9\n\n`+
        `RISK LEVEL: ${assessmentResult.riskLevel} (Score: ${assessmentResult.riskScore}/120)\n\n`+
        `VALIDATION STRATEGY:\n${assessmentResult.strategy}\n\n`+
        `REQUIRED TEST ACTIVITIES:\n${assessmentResult.activities.map((a,i)=>`${i+1}. ${a}`).join('\n')}\n\n`+
        `RECOMMENDATIONS:\n- Follow risk-based validation approach\n- Document all test activities\n- Ensure traceability to requirements\n- Obtain QA approval before production use`;
      
      const blob=new Blob([report],{type:'text/plain'});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a');
      a.href=url;
      a.download='Risk_Assessment_'+system.replace(/\s/g,'_')+'_'+new Date().toISOString().split('T')[0]+'.txt';
      a.click();
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
