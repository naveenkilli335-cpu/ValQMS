<!DOCTYPE html>
<html lang="en" data-theme="green" data-bg="mesh">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Validation Status Dashboard — ValQMS</title>
  <link rel="icon" href="favicon.jpg?v=5">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    
    /* Theme Colors */
    [data-theme="green"]{--accent:#10b981;--accent-bright:#34d399;--accent-dim:rgba(16,185,129,0.15);--accent-glow:rgba(16,185,129,0.4)}
    [data-theme="cyan"]{--accent:#06b6d4;--accent-bright:#22d3ee;--accent-dim:rgba(6,182,212,0.15);--accent-glow:rgba(6,182,212,0.4)}
    [data-theme="purple"]{--accent:#8b5cf6;--accent-bright:#a78bfa;--accent-dim:rgba(139,92,246,0.15);--accent-glow:rgba(139,92,246,0.4)}
    [data-theme="orange"]{--accent:#f97316;--accent-bright:#fb923c;--accent-dim:rgba(249,115,22,0.15);--accent-glow:rgba(249,115,22,0.4)}
    [data-theme="blue"]{--accent:#3b82f6;--accent-bright:#60a5fa;--accent-dim:rgba(59,130,246,0.15);--accent-glow:rgba(59,130,246,0.4)}
    [data-theme="red"]{--accent:#ef4444;--accent-bright:#f87171;--accent-dim:rgba(239,68,68,0.15);--accent-glow:rgba(239,68,68,0.4)}
    [data-theme="pink"]{--accent:#ec4899;--accent-bright:#f472b6;--accent-dim:rgba(236,72,153,0.15);--accent-glow:rgba(236,72,153,0.4)}
    [data-theme="teal"]{--accent:#14b8a6;--accent-bright:#2dd4bf;--accent-dim:rgba(20,184,166,0.15);--accent-glow:rgba(20,184,166,0.4)}
    [data-theme="indigo"]{--accent:#6366f1;--accent-bright:#818cf8;--accent-dim:rgba(99,102,241,0.15);--accent-glow:rgba(99,102,241,0.4)}
    [data-theme="yellow"]{--accent:#eab308;--accent-bright:#facc15;--accent-dim:rgba(234,179,8,0.15);--accent-glow:rgba(234,179,8,0.4)}
    [data-theme="magenta"]{--accent:#d946ef;--accent-bright:#e879f9;--accent-dim:rgba(217,70,239,0.15);--accent-glow:rgba(217,70,239,0.4)}
    [data-theme="emerald"]{--accent:#059669;--accent-bright:#10b981;--accent-dim:rgba(5,150,105,0.15);--accent-glow:rgba(5,150,105,0.4)}
    [data-theme="amber"]{--accent:#d97706;--accent-bright:#f59e0b;--accent-dim:rgba(217,119,6,0.15);--accent-glow:rgba(217,119,6,0.4)}
    [data-theme="lime"]{--accent:#84cc16;--accent-bright:#a3e635;--accent-dim:rgba(132,204,22,0.15);--accent-glow:rgba(132,204,22,0.4)}
    [data-theme="violet"]{--accent:#7c3aed;--accent-bright:#a78bfa;--accent-dim:rgba(124,58,237,0.15);--accent-glow:rgba(124,58,237,0.4)}

    :root{
      --text:#ffffff;
      --text-dim:#94a3b8;
      --surface:rgba(255,255,255,0.05);
      --surface-hover:rgba(255,255,255,0.08);
      --border:rgba(255,255,255,0.1);
      --glass:rgba(255,255,255,0.03);
    }

    /* ANIMATED BACKGROUNDS */
    [data-bg="mesh"] body{background:#0f172a;position:relative}
    [data-bg="mesh"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 50%, rgba(16,185,129,0.15) 0%, transparent 50%),radial-gradient(circle at 80% 80%, rgba(99,102,241,0.15) 0%, transparent 50%),radial-gradient(circle at 40% 80%, rgba(236,72,153,0.1) 0%, transparent 50%);animation:meshMove 15s ease-in-out infinite alternate;z-index:-1}

    [data-bg="gradient"] body{background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);position:relative}
    [data-bg="gradient"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg, transparent 0%, rgba(0,0,0,0.3) 100%);z-index:-1}

    [data-bg="dots"] body{background:#0a0e27;position:relative}
    [data-bg="dots"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background-image:radial-gradient(circle, rgba(255,255,255,0.05) 1px, transparent 1px);background-size:30px 30px;z-index:-1}

    [data-bg="waves"] body{background:#0f172a;position:relative}
    [data-bg="waves"] body::before{content:'';position:fixed;bottom:0;left:0;width:100%;height:400px;background:linear-gradient(180deg, transparent 0%, rgba(16,185,129,0.1) 100%);animation:waveMove 8s ease-in-out infinite;z-index:-1}

    [data-bg="dark"] body{background:#0a0e1a;position:relative}
    [data-bg="dark"] body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at center, rgba(59,130,246,0.05) 0%, transparent 70%);z-index:-1}

    @keyframes meshMove{0%{transform:scale(1) rotate(0deg)}100%{transform:scale(1.1) rotate(5deg)}}
    @keyframes waveMove{0%,100%{transform:translateY(0)}50%{transform:translateY(-20px)}}
    
    html{scroll-behavior:smooth}
    body{
      font-family:'Inter',system-ui,-apple-system,sans-serif;
      color:var(--text);
      line-height:1.6;
      -webkit-font-smoothing:antialiased;
      transition:background 0.5s ease;
      min-height:100vh;
      overflow-x:hidden;
    }

    /* GLASSMORPHISM HEADER */
    header{
      position:sticky;
      top:12px;
      z-index:1000;
      padding:0 24px;
      margin-bottom:40px;
    }
    .header-glass{
      background:rgba(255,255,255,0.03);
      backdrop-filter:blur(20px) saturate(180%);
      -webkit-backdrop-filter:blur(20px) saturate(180%);
      border:1px solid rgba(255,255,255,0.1);
      border-radius:20px;
      padding:16px 32px;
      box-shadow:0 8px 32px rgba(0,0,0,0.1),inset 0 1px 0 rgba(255,255,255,0.1);
    }
    header .header-container{
      display:flex;
      justify-content:space-between;
      align-items:center;
      max-width:1800px;
      margin:0 auto;
    }
    
    .logo{
      display:flex;
      align-items:center;
      gap:12px;
      text-decoration:none;
      color:var(--text);
      font-weight:800;
      font-size:22px;
      letter-spacing:-0.7px;
      transition:all 0.3s;
    }
    .logo:hover{transform:translateY(-2px)}
    .logo-mark{
      display:flex;
      align-items:center;
      justify-content:center;
      width:48px;
      height:48px;
      background:linear-gradient(135deg,var(--accent),var(--accent-bright));
      border-radius:12px;
      box-shadow:0 4px 20px var(--accent-glow);
      transition:all 0.3s;
      position:relative;
    }
    .logo-mark::after{
      content:'';
      position:absolute;
      inset:-2px;
      background:linear-gradient(135deg,var(--accent),var(--accent-bright));
      border-radius:14px;
      z-index:-1;
      opacity:0;
      filter:blur(10px);
      transition:opacity 0.3s;
    }
    .logo-mark:hover::after{opacity:0.7}
    .logo-mark img{
      width:100%;
      height:100%;
      object-fit:contain;
      padding:6px;
    }
    .brand-text{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .brand-text h1{
      font-size:20px;
      font-weight:800;
      letter-spacing:-0.5px;
      margin:0;
      line-height:1.2;
      color:var(--text);
    }
    .brand-text .subtitle{
      font-size:13px;
      color:var(--text-dim);
      font-weight:500;
      line-height:1.2;
    }

    .header-controls{
      display:flex;
      gap:12px;
      align-items:center;
    }
    
    .bg-selector{position:relative}
    .bg-btn{
      padding:10px 18px;
      background:var(--surface);
      border:1px solid var(--border);
      border-radius:12px;
      color:var(--text-dim);
      font-size:14px;
      font-weight:600;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:8px;
      transition:all 0.3s;
    }
    .bg-btn:hover{
      background:var(--surface-hover);
      border-color:var(--accent);
      color:var(--text);
    }
    .bg-dropdown{
      position:absolute;
      top:calc(100% + 12px);
      right:0;
      background:rgba(255,255,255,0.05);
      backdrop-filter:blur(20px);
      border:1px solid var(--border);
      border-radius:16px;
      padding:12px;
      display:none;
      min-width:200px;
      box-shadow:0 20px 60px rgba(0,0,0,0.3);
      z-index:100;
    }
    .bg-dropdown.active{display:block}
    .bg-option{
      display:flex;
      align-items:center;
      gap:12px;
      padding:12px;
      border-radius:10px;
      cursor:pointer;
      transition:all 0.3s;
      font-size:14px;
      font-weight:500;
    }
    .bg-option:hover{background:var(--surface-hover)}
    .bg-preview{
      width:32px;
      height:32px;
      border-radius:8px;
      border:2px solid rgba(255,255,255,0.2);
    }
    .bg-preview.mesh{background:radial-gradient(circle, #10b981 0%, #6366f1 100%)}
    .bg-preview.gradient{background:linear-gradient(135deg, #667eea 0%, #764ba2 100%)}
    .bg-preview.dots{background:#0a0e27;background-image:radial-gradient(circle, rgba(255,255,255,0.2) 1px, transparent 1px);background-size:15px 15px}
    .bg-preview.waves{background:linear-gradient(180deg, #0f172a 0%, #10b981 100%)}
    .bg-preview.dark{background:#0a0e1a}

    .theme-selector{position:relative}
    .theme-btn{
      padding:10px 18px;
      background:var(--surface);
      border:1px solid var(--border);
      border-radius:12px;
      color:var(--text-dim);
      font-size:14px;
      font-weight:600;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:8px;
      transition:all 0.3s;
    }
    .theme-btn:hover{
      background:var(--surface-hover);
      border-color:var(--accent);
      color:var(--text);
    }
    .theme-dropdown{
      position:absolute;
      top:calc(100% + 12px);
      right:0;
      background:rgba(255,255,255,0.05);
      backdrop-filter:blur(20px);
      border:1px solid var(--border);
      border-radius:16px;
      padding:12px;
      display:none;
      min-width:200px;
      max-height:400px;
      overflow-y:auto;
      box-shadow:0 20px 60px rgba(0,0,0,0.3);
      z-index:100;
    }
    .theme-dropdown.active{display:block}
    .theme-dropdown::-webkit-scrollbar{width:6px}
    .theme-dropdown::-webkit-scrollbar-track{background:transparent}
    .theme-dropdown::-webkit-scrollbar-thumb{background:var(--accent);border-radius:10px}
    .theme-option{
      display:flex;
      align-items:center;
      gap:12px;
      padding:12px;
      border-radius:10px;
      cursor:pointer;
      transition:all 0.3s;
      font-size:14px;
      font-weight:500;
    }
    .theme-option:hover{background:var(--surface-hover)}
    .theme-color{
      width:28px;
      height:28px;
      border-radius:8px;
      border:2px solid rgba(255,255,255,0.2);
      transition:all 0.3s;
    }
    .theme-option:hover .theme-color{transform:scale(1.1)}
    .theme-color.green{background:linear-gradient(135deg,#10b981,#34d399)}
    .theme-color.cyan{background:linear-gradient(135deg,#06b6d4,#22d3ee)}
    .theme-color.purple{background:linear-gradient(135deg,#8b5cf6,#a78bfa)}
    .theme-color.orange{background:linear-gradient(135deg,#f97316,#fb923c)}
    .theme-color.blue{background:linear-gradient(135deg,#3b82f6,#60a5fa)}
    .theme-color.red{background:linear-gradient(135deg,#ef4444,#f87171)}
    .theme-color.pink{background:linear-gradient(135deg,#ec4899,#f472b6)}
    .theme-color.teal{background:linear-gradient(135deg,#14b8a6,#2dd4bf)}
    .theme-color.indigo{background:linear-gradient(135deg,#6366f1,#818cf8)}
    .theme-color.yellow{background:linear-gradient(135deg,#eab308,#facc15)}
    .theme-color.magenta{background:linear-gradient(135deg,#d946ef,#e879f9)}
    .theme-color.emerald{background:linear-gradient(135deg,#059669,#10b981)}
    .theme-color.amber{background:linear-gradient(135deg,#d97706,#f59e0b)}
    .theme-color.lime{background:linear-gradient(135deg,#84cc16,#a3e635)}
    .theme-color.violet{background:linear-gradient(135deg,#7c3aed,#a78bfa)}

    .btn-home{
      padding:10px 20px;
      background:linear-gradient(135deg,var(--accent),var(--accent-bright));
      border:none;
      border-radius:12px;
      color:#000;
      font-size:14px;
      font-weight:700;
      text-decoration:none;
      transition:all 0.3s;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow:0 4px 16px var(--accent-glow);
    }
    .btn-home:hover{
      transform:translateY(-2px);
      box-shadow:0 8px 24px var(--accent-glow);
    }

    .container{max-width:1800px;margin:0 auto;padding:0 24px}
    
    .card{
      background:var(--glass);
      backdrop-filter:blur(10px);
      padding:28px;
      border-radius:18px;
      border:1px solid var(--border);
      margin-bottom:20px;
      transition:all 0.3s;
    }
    .card:hover{border-color:var(--accent);box-shadow:0 8px 24px rgba(0,0,0,0.2)}
    .card h3{font-size:18px;font-weight:700;margin:0 0 16px 0;letter-spacing:-0.3px}

    .upload-zone{
      border:2px dashed var(--border);
      border-radius:16px;
      padding:40px 24px;
      text-align:center;
      cursor:pointer;
      transition:all 0.3s;
      background:var(--glass);
      backdrop-filter:blur(10px);
    }
    .upload-zone:hover{
      border-color:var(--accent);
      background:var(--surface-hover);
      transform:translateY(-2px);
    }

    .btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:12px 24px;
      background:linear-gradient(135deg,var(--accent),var(--accent-bright));
      color:#000;
      border:none;
      border-radius:12px;
      font-size:14px;
      font-weight:700;
      cursor:pointer;
      transition:all 0.3s;
      box-shadow:0 4px 16px var(--accent-glow);
    }
    .btn:hover{
      transform:translateY(-2px);
      box-shadow:0 8px 24px var(--accent-glow);
    }
    .btn:disabled{opacity:0.5;cursor:not-allowed}
    .btn.secondary{
      background:var(--surface);
      border:1px solid var(--border);
      color:var(--text);
      box-shadow:none;
    }
    .btn.secondary:hover{
      background:var(--surface-hover);
      border-color:var(--accent);
    }

    .actions{display:flex;gap:12px;margin-top:12px;flex-wrap:wrap}

    .stats-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      gap:20px;
      margin-bottom:28px;
    }
    .stat-card{
      background:var(--glass);
      backdrop-filter:blur(10px);
      border:1px solid var(--border);
      border-radius:14px;
      padding:28px;
      transition:all 0.3s;
      position:relative;
      overflow:hidden;
    }
    .stat-card::before{
      content:'';
      position:absolute;
      top:0;
      right:0;
      width:80px;
      height:80px;
      background:var(--accent-dim);
      border-radius:0 0 0 100%;
      opacity:0.3;
    }
    .stat-card:hover{
      transform:translateY(-6px);
      border-color:var(--accent);
      box-shadow:0 12px 32px rgba(0,0,0,0.3);
    }
    .stat-label{
      font-size:13px;
      color:var(--text-dim);
      font-weight:600;
      text-transform:uppercase;
      margin-bottom:10px;
      letter-spacing:0.5px;
    }
    .stat-value{
      font-size:42px;
      font-weight:900;
      color:var(--accent);
      margin-bottom:6px;
      letter-spacing:-2px;
    }
    .stat-sublabel{
      font-size:13px;
      color:var(--text-dim);
      font-weight:300;
    }

    .system-card{
      background:rgba(0,0,0,0.3);
      backdrop-filter:blur(10px);
      border:1px solid var(--border);
      border-radius:14px;
      padding:24px;
      margin-bottom:16px;
      transition:all 0.3s;
    }
    .system-card:hover{
      background:rgba(0,0,0,0.5);
      border-color:var(--accent);
      transform:translateX(4px);
    }
    .system-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:16px;
    }
    .system-name{
      font-size:17px;
      font-weight:700;
      color:var(--text);
      letter-spacing:-0.3px;
    }
    .status-badge{
      padding:8px 20px;
      border-radius:999px;
      font-size:11px;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:0.5px;
    }
    .status-validated{background:rgba(52,211,153,0.2);color:#34d399;border:2px solid #34d399}
    .status-inprogress{background:rgba(250,204,21,0.2);color:#facc15;border:2px solid #facc15}
    .status-overdue{background:rgba(239,68,68,0.2);color:#f87171;border:2px solid #ef4444}
    .status-planned{background:rgba(100,116,139,0.2);color:#94a3b8;border:2px solid #64748b}

    .progress-bar{
      width:100%;
      height:10px;
      background:rgba(255,255,255,0.1);
      border-radius:999px;
      overflow:hidden;
      margin-top:12px;
    }
    .progress-fill{
      height:100%;
      background:linear-gradient(90deg,var(--accent),var(--accent-bright));
      border-radius:999px;
      transition:width 0.5s ease;
      box-shadow:0 0 10px var(--accent-glow);
    }
    .system-details{
      font-size:14px;
      color:var(--text-dim);
      line-height:1.9;
      font-weight:300;
    }

    .chart-container{
      background:rgba(0,0,0,0.3);
      backdrop-filter:blur(10px);
      border:1px solid var(--border);
      border-radius:14px;
      padding:32px;
      height:320px;
      display:flex;
      align-items:flex-end;
      gap:12px;
    }
    .chart-bar{
      flex:1;
      background:linear-gradient(180deg,var(--accent),var(--accent-bright));
      border-radius:10px 10px 0 0;
      transition:all 0.3s;
      position:relative;
      cursor:pointer;
      box-shadow:0 4px 16px var(--accent-glow);
    }
    .chart-bar:hover{
      background:linear-gradient(180deg,var(--accent-bright),var(--accent));
      transform:scaleY(1.05);
      box-shadow:0 8px 24px var(--accent-glow);
    }
    .chart-label{
      position:absolute;
      bottom:-28px;
      left:50%;
      transform:translateX(-50%);
      font-size:12px;
      color:var(--text-dim);
      white-space:nowrap;
      font-weight:600;
    }

    @media(max-width:968px){
      header{top:8px;padding:0 16px}
      .header-glass{padding:12px 20px;border-radius:16px}
      .brand-text h1{font-size:16px}
      .brand-text .subtitle{font-size:11px}
      .logo-mark{width:40px;height:40px}
      .header-controls{gap:8px}
      .bg-btn,.theme-btn{padding:10px;font-size:0}
      .bg-btn span:last-child,.theme-btn span:last-child{display:none}
      .btn-home span:first-child{display:none}
    }

    ::-webkit-scrollbar{width:10px;height:10px}
    ::-webkit-scrollbar-track{background:transparent;border-radius:10px}
    ::-webkit-scrollbar-thumb{background:var(--accent);border-radius:10px}
  </style>
</head>
<body>

  <!-- GLASSMORPHISM HEADER -->
  <header>
    <div class="header-glass">
      <div class="header-container">
        <a href="index.html" class="logo">
          <div class="logo-mark"><img src="favicon.jpg" alt="ValQMS"></div>
          <div class="brand-text">
            <h1>ValQMS Tools</h1>
            <div class="subtitle">Validation Status Dashboard</div>
          </div>
        </a>

        <div class="header-controls">
          <!-- Background Selector -->
          <div class="bg-selector">
            <button class="bg-btn" id="bgBtn"><span>🎨</span><span>Background</span></button>
            <div class="bg-dropdown" id="bgDropdown">
              <div class="bg-option" data-bg="mesh"><div class="bg-preview mesh"></div><span>Mesh Gradient</span></div>
              <div class="bg-option" data-bg="gradient"><div class="bg-preview gradient"></div><span>Purple Gradient</span></div>
              <div class="bg-option" data-bg="dots"><div class="bg-preview dots"></div><span>Dot Pattern</span></div>
              <div class="bg-option" data-bg="waves"><div class="bg-preview waves"></div><span>Wave Motion</span></div>
              <div class="bg-option" data-bg="dark"><div class="bg-preview dark"></div><span>Dark Mode</span></div>
            </div>
          </div>

          <!-- Theme Selector -->
          <div class="theme-selector">
            <button class="theme-btn" id="themeBtn"><span>🎨</span><span>Theme</span></button>
            <div class="theme-dropdown" id="themeDropdown">
              <div class="theme-option" data-theme="green"><div class="theme-color green"></div><span>Green</span></div>
              <div class="theme-option" data-theme="cyan"><div class="theme-color cyan"></div><span>Cyan</span></div>
              <div class="theme-option" data-theme="purple"><div class="theme-color purple"></div><span>Purple</span></div>
              <div class="theme-option" data-theme="orange"><div class="theme-color orange"></div><span>Orange</span></div>
              <div class="theme-option" data-theme="blue"><div class="theme-color blue"></div><span>Blue</span></div>
              <div class="theme-option" data-theme="red"><div class="theme-color red"></div><span>Red</span></div>
              <div class="theme-option" data-theme="pink"><div class="theme-color pink"></div><span>Pink</span></div>
              <div class="theme-option" data-theme="teal"><div class="theme-color teal"></div><span>Teal</span></div>
              <div class="theme-option" data-theme="indigo"><div class="theme-color indigo"></div><span>Indigo</span></div>
              <div class="theme-option" data-theme="yellow"><div class="theme-color yellow"></div><span>Yellow</span></div>
              <div class="theme-option" data-theme="magenta"><div class="theme-color magenta"></div><span>Magenta</span></div>
              <div class="theme-option" data-theme="emerald"><div class="theme-color emerald"></div><span>Emerald</span></div>
              <div class="theme-option" data-theme="amber"><div class="theme-color amber"></div><span>Amber</span></div>
              <div class="theme-option" data-theme="lime"><div class="theme-color lime"></div><span>Lime</span></div>
              <div class="theme-option" data-theme="violet"><div class="theme-color violet"></div><span>Violet</span></div>
            </div>
          </div>

          <a href="index.html" class="btn-home"><span>←</span><span>Home</span></a>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="card">
      <h3>📊 Upload System Inventory</h3>
      <div class="upload-zone" id="uploadZone">
        <div style="font-size:56px;margin-bottom:16px">📁</div>
        <div style="font-weight:700;margin-bottom:10px;font-size:16px">Drop System Inventory Excel</div>
        <div style="font-size:13px;color:var(--text-dim);font-weight:300">Columns: System_Name, Status, IQ_Date, OQ_Date, PQ_Date, Next_Revalidation, Owner</div>
        <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" style="display:none">
      </div>
      <div id="uploadStatus" style="margin-top:16px;font-size:14px;color:var(--text-dim);font-weight:500"></div>
    </div>

    <div class="stats-grid" id="statsGrid" style="display:none">
      <div class="stat-card">
        <div class="stat-label">Total Systems</div>
        <div class="stat-value" id="statTotal">0</div>
        <div class="stat-sublabel">Under validation</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Validated</div>
        <div class="stat-value" id="statValidated" style="color:#34d399">0</div>
        <div class="stat-sublabel">Fully qualified</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">In Progress</div>
        <div class="stat-value" id="statInProgress" style="color:#facc15">0</div>
        <div class="stat-sublabel">Active validation</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Overdue</div>
        <div class="stat-value" id="statOverdue" style="color:#ef4444">0</div>
        <div class="stat-sublabel">Requires attention</div>
      </div>
    </div>

    <div class="card" id="chartCard" style="display:none">
      <h3>📈 Validation Progress Overview</h3>
      <div class="chart-container" id="chartContainer"></div>
    </div>

    <div class="card" id="systemsCard" style="display:none">
      <h3>🖥️ System Validation Status</h3>
      <div id="systemsList"></div>
    </div>

    <div class="card" id="actionsCard" style="display:none">
      <div class="actions">
        <button id="exportDashboard" class="btn">
          <span>📥</span><span>Export Dashboard Report</span>
        </button>
        <button id="filterOverdue" class="btn secondary">
          <span>⚠️</span><span>Show Only Overdue</span>
        </button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    // Theme & Background System
    const themeBtn=document.getElementById('themeBtn');
    const themeDropdown=document.getElementById('themeDropdown');
    const themeOptions=document.querySelectorAll('.theme-option');
    const bgBtn=document.getElementById('bgBtn');
    const bgDropdown=document.getElementById('bgDropdown');
    const bgOptions=document.querySelectorAll('.bg-option');

    themeBtn.addEventListener('click',e=>{e.stopPropagation();themeDropdown.classList.toggle('active');bgDropdown.classList.remove('active')});
    bgBtn.addEventListener('click',e=>{e.stopPropagation();bgDropdown.classList.toggle('active');themeDropdown.classList.remove('active')});
    document.addEventListener('click',()=>{themeDropdown.classList.remove('active');bgDropdown.classList.remove('active')});
    themeDropdown.addEventListener('click',e=>e.stopPropagation());
    bgDropdown.addEventListener('click',e=>e.stopPropagation());

    themeOptions.forEach(opt=>{
      opt.addEventListener('click',()=>{
        const theme=opt.dataset.theme;
        document.documentElement.setAttribute('data-theme',theme);
        localStorage.setItem('valqmsTheme',theme);
        themeDropdown.classList.remove('active');
      });
    });

    bgOptions.forEach(opt=>{
      opt.addEventListener('click',()=>{
        const bg=opt.dataset.bg;
        document.documentElement.setAttribute('data-bg',bg);
        localStorage.setItem('valqmsBg',bg);
        bgDropdown.classList.remove('active');
      });
    });

    function initTheme(){
      const savedTheme=localStorage.getItem('valqmsTheme')||'green';
      const savedBg=localStorage.getItem('valqmsBg')||'mesh';
      document.documentElement.setAttribute('data-theme',savedTheme);
      document.documentElement.setAttribute('data-bg',savedBg);
    }
    initTheme();

    // Dashboard Logic
    let systems=[];
    const uploadZone=document.getElementById('uploadZone');
    const fileInput=document.getElementById('fileInput');
    uploadZone.addEventListener('click',()=>fileInput.click());
    fileInput.addEventListener('change',e=>handleFileUpload(e.target.files[0]));
    
    function handleFileUpload(file){
      if(!file)return;
      const reader=new FileReader();
      reader.onload=e=>{
        try{
          const data=new Uint8Array(e.target.result);
          const workbook=XLSX.read(data,{type:'array'});
          const sheet=workbook.Sheets[workbook.SheetNames[0]];
          systems=XLSX.utils.sheet_to_json(sheet);
          document.getElementById('uploadStatus').innerHTML=`✅ Loaded ${systems.length} systems`;
          document.getElementById('uploadStatus').style.color='var(--accent)';
          processData();
        }catch(err){alert('Error: '+err.message)}
      };
      reader.readAsArrayBuffer(file);
    }
    
    function processData(){
      let validated=0,inProgress=0,overdue=0;
      const today=new Date();
      
      systems.forEach(sys=>{
        const status=(sys.Status||'').toLowerCase();
        const revalDate=sys.Next_Revalidation?new Date(sys.Next_Revalidation):null;
        
        if(status.includes('validated')||status.includes('complete'))validated++;
        else if(status.includes('progress')||status.includes('active'))inProgress++;
        
        if(revalDate&&revalDate<today)overdue++;
      });
      
      document.getElementById('statTotal').textContent=systems.length;
      document.getElementById('statValidated').textContent=validated;
      document.getElementById('statInProgress').textContent=inProgress;
      document.getElementById('statOverdue').textContent=overdue;
      
      document.getElementById('statsGrid').style.display='grid';
      renderChart();
      renderSystems();
      document.getElementById('actionsCard').style.display='block';
    }
    
    function renderChart(){
      const container=document.getElementById('chartContainer');
      container.innerHTML='';
      const statuses={Validated:0,InProgress:0,Planned:0,Overdue:0};
      
      systems.forEach(s=>{
        const st=(s.Status||'').toLowerCase();
        if(st.includes('validated')||st.includes('complete'))statuses.Validated++;
        else if(st.includes('progress'))statuses.InProgress++;
        else if(st.includes('planned'))statuses.Planned++;
        else if(st.includes('overdue'))statuses.Overdue++;
      });
      
      const max=Math.max(...Object.values(statuses));
      Object.entries(statuses).forEach(([name,count])=>{
        const bar=document.createElement('div');
        bar.className='chart-bar';
        bar.style.height=(count/max*100)+'%';
        bar.innerHTML=`<div class="chart-label">${name}<br>${count}</div>`;
        bar.title=`${name}: ${count} systems`;
        container.appendChild(bar);
      });
      
      document.getElementById('chartCard').style.display='block';
    }
    
    function renderSystems(){
      const list=document.getElementById('systemsList');
      list.innerHTML='';
      
      systems.forEach(sys=>{
        const status=(sys.Status||'Planned').toLowerCase();
        let statusClass='status-planned';
        if(status.includes('validated')||status.includes('complete'))statusClass='status-validated';
        else if(status.includes('progress'))statusClass='status-inprogress';
        else if(status.includes('overdue'))statusClass='status-overdue';
        
        const iqProg=sys.IQ_Date?100:0;
        const oqProg=sys.OQ_Date?100:0;
        const pqProg=sys.PQ_Date?100:0;
        const totalProg=Math.round((iqProg+oqProg+pqProg)/3);
        
        const card=document.createElement('div');
        card.className='system-card';
        card.innerHTML=`
          <div class="system-header">
            <div class="system-name">${sys.System_Name||'Unknown System'}</div>
            <span class="status-badge ${statusClass}">${sys.Status||'Planned'}</span>
          </div>
          <div class="system-details">
            <div>Owner: ${sys.Owner||'Not assigned'}</div>
            <div>IQ: ${sys.IQ_Date||'Pending'} | OQ: ${sys.OQ_Date||'Pending'} | PQ: ${sys.PQ_Date||'Pending'}</div>
            <div>Next Revalidation: ${sys.Next_Revalidation||'Not scheduled'}</div>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:${totalProg}%"></div>
          </div>
        `;
        list.appendChild(card);
      });
      
      document.getElementById('systemsCard').style.display='block';
    }
    
    document.getElementById('exportDashboard').addEventListener('click',()=>{
      const report=`VALIDATION STATUS DASHBOARD REPORT\nGenerated: ${new Date().toLocaleString()}\n\n`+
        `SUMMARY\nTotal Systems: ${systems.length}\nValidated: ${document.getElementById('statValidated').textContent}\n`+
        `In Progress: ${document.getElementById('statInProgress').textContent}\nOverdue: ${document.getElementById('statOverdue').textContent}\n\n`+
        `SYSTEM DETAILS\n\n`+systems.map(s=>`${s.System_Name} - ${s.Status}\nOwner: ${s.Owner}\nIQ: ${s.IQ_Date||'N/A'}, OQ: ${s.OQ_Date||'N/A'}, PQ: ${s.PQ_Date||'N/A'}\n`).join('\n');
      const blob=new Blob([report],{type:'text/plain'});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a');
      a.href=url;
      a.download='Validation_Dashboard_'+new Date().toISOString().split('T')[0]+'.txt';
      a.click();
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
